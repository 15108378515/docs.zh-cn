---
title: "LINQ 和 ADO.NET"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
caps.latest.revision: "8"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: b020b3df627fcb220f4227d76fdf8eb3d60e80e4
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/19/2018
---
# <a name="linq-and-adonet"></a><span data-ttu-id="b8fe3-102">LINQ 和 ADO.NET</span><span class="sxs-lookup"><span data-stu-id="b8fe3-102">LINQ and ADO.NET</span></span>
<span data-ttu-id="b8fe3-103">今天，很多业务开发人员必须使用两种或更多种编程语言：对于业务逻辑和表示层使用高级语言（如 [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)] 或 [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]），而使用查询语言与数据库交互（如 [!INCLUDE[tsql](../../../../includes/tsql-md.md)]）。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-103">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)] or [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]), and a query language to interact with the database (such as [!INCLUDE[tsql](../../../../includes/tsql-md.md)]).</span></span> <span data-ttu-id="b8fe3-104">这要求开发人员精通多种语言才能奏效，同时也导致在开发环境中语言不匹配。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-104">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="b8fe3-105">例如，使用数据访问 API 对数据库执行查询的应用程序会将查询指定为用引号括起的字符串。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-105">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="b8fe3-106">编译器不能读取此查询字符串，因此不会检查是否有错误，如语法无效或引用的列或行是否实际存在。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-106">This query string is un-readable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="b8fe3-107">不会检查查询参数的类型，也不支持 `IntelliSense`。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-107">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]<span data-ttu-id="b8fe3-108"> 使开发人员能够在应用程序代码中形成基于集合的查询，而不必使用单独的查询语言。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-108"> enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="b8fe3-109">您可以编写针对各种可枚举数据源（即实现 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 接口的数据源）的 <xref:System.Collections.IEnumerable> 查询，可枚举数据源包括驻留在内存中的数据结构、XML 文档、SQL 数据库和 <xref:System.Data.DataSet> 对象等。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-109">You can write [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="b8fe3-110">虽然这些可枚举数据源以多种方式实现，但它们都公开相同的语法和语言构造。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-110">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="b8fe3-111">由于可以使用编程语言本身形成查询，因此您不必使用编译器无法理解或验证的以字符串形式嵌入的其他查询语言。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-111">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="b8fe3-112">通过提供编译时类型和语法检查以及 [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)]，将查询集成到编程语言也使 `IntelliSense` 程序员的工作更有效。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-112">Integrating queries into the programming language also enables [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="b8fe3-113">这些功能降低了对查询调试和错误修复的需求。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-113">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="b8fe3-114">将数据从 SQL 表传输到内存中的对象通常单调乏味并容易出错。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-114">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="b8fe3-115">由 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 和 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] 实现的 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] 提供程序可以将源数据转换为基于 <xref:System.Collections.IEnumerable> 的对象集合。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-115">The [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] provider implemented by [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="b8fe3-116">在您查询数据和更新数据时，程序员始终会以 <xref:System.Collections.IEnumerable> 集合的形式查看这些数据。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-116">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="b8fe3-117">为编写针对这些集合的查询提供完全的 `IntelliSense` 支持。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-117">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="b8fe3-118">有三种独立的 ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] 技术：[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] 和 [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-118">There are three separate ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] technologies: [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]<span data-ttu-id="b8fe3-119"> 提供针对 <xref:System.Data.DataSet> 的形式多样的优化查询，[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] 使您可以直接查询 [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)] 数据库架构，而 [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] 允许您查询 [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-119"> provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)] database schemas, and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] allows you to query an [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)].</span></span>  
  
 <span data-ttu-id="b8fe3-120">下面的关系图概述了 ADO.NET LINQ 技术如何关联到高级编程语言和启用 LINQ 的数据源。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-120">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="b8fe3-121">![LINQ to ADO.NET 概述](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="b8fe3-121">![LINQ to ADO.NET overview](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="b8fe3-122">有关 LINQ 语言功能的常规信息，请参阅[LINQ 简介](http://msdn.microsoft.com/library/24dddf19-12a0-4707-a4bc-eba4fa7f219e)。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-122">For general information on the LINQ language features, see [Introduction to LINQ](http://msdn.microsoft.com/library/24dddf19-12a0-4707-a4bc-eba4fa7f219e).</span></span> <span data-ttu-id="b8fe3-123">有关在你的应用程序中使用 LINQ 的信息，请参阅[不在生成中： LINQ 常规编程指南](http://msdn.microsoft.com/library/609c7a6b-cbdd-429d-99f3-78d13d3bc049)，其中包含有关如何使用 LINQ 技术详情。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-123">For information about using LINQ in your applications, see the [NOT IN BUILD: LINQ General Programming Guide](http://msdn.microsoft.com/library/609c7a6b-cbdd-429d-99f3-78d13d3bc049), which contains detailed information about how to use LINQ technologies.</span></span>  
  
 <span data-ttu-id="b8fe3-124">下面各节提供有关 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] 和 [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] 的更多信息。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-124">The following sections provide more information about [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="b8fe3-125">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="b8fe3-125">LINQ to DataSet</span></span>  
 <span data-ttu-id="b8fe3-126"><xref:System.Data.DataSet> 是赖以生成 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 的断开连接式编程模型的关键元素，使用非常广泛。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-126">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] is built on, and is widely used.</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]<span data-ttu-id="b8fe3-127"> 使开发人员能够通过使用许多其他数据源可用的同样的查询表述机制在 <xref:System.Data.DataSet> 中内置更丰富的查询功能。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-127"> enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="b8fe3-128">有关详细信息，请参阅 [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-128">For more information, see [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="b8fe3-129">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="b8fe3-129">LINQ to SQL</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="b8fe3-130"> 是适合不需要映射到概念模型的开发人员使用的有用工具。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-130"> is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="b8fe3-131">通过使用 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]，您可以直接在现有数据库架构上直接使用 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 编程模型。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-131">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming model directly over existing database schema.</span></span> [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="b8fe3-132"> 使开发人员能够生成表示数据的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 类。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-132"> enables developers to generate [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] classes that represent data.</span></span> <span data-ttu-id="b8fe3-133">这些生成的类直接映射到数据库表、视图、存储过程和用户定义的函数，而不映射到概念数据模型。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-133">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="b8fe3-134">使用 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] 时，除了其他数据源（如 XML）外，开发人员还可以使用与内存集合和 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 相同的 <xref:System.Data.DataSet> 编程模式直接编写针对存储架构的代码。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-134">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="b8fe3-135">有关详细信息，请参阅 [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-135">For more information, see [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="b8fe3-136">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="b8fe3-136">LINQ to Entities</span></span>  
 <span data-ttu-id="b8fe3-137">大多数应用程序目前是在关系数据库之上编写的。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-137">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="b8fe3-138">有时这些应用程序将需要与以关系形式表示的数据进行交互。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-138">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="b8fe3-139">数据库架构并不总是构建应用程序的理想选择，并且应用程序的概念模型与数据库的逻辑模型不同。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-139">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="b8fe3-140">[!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] 是可用于对特定域的数据进行建模的概念数据模型，以便应用程序可作为对象与数据进行交互。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-140">The [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="b8fe3-141">请参阅[ADO.NET 实体框架](../../../../docs/framework/data/adonet/ef/index.md)有关详细信息。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-141">See [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md) for more information.</span></span>  
  
 <span data-ttu-id="b8fe3-142">通过 [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)]，在 .NET 环境中将关系数据作为对象公开。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-142">Through the [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)], relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="b8fe3-143">这使得对象层成为实现 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] 支持的理想目标，开发人员可以采用生成业务逻辑所用的语言来构建数据库查询。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-143">This makes the object layer an ideal target for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="b8fe3-144">此功能称为 [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-144">This capability is known as [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> <span data-ttu-id="b8fe3-145">有关详细信息，请参阅 [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)。</span><span class="sxs-lookup"><span data-stu-id="b8fe3-145">See [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md) for more information.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b8fe3-146">请参阅</span><span class="sxs-lookup"><span data-stu-id="b8fe3-146">See Also</span></span>  
 [<span data-ttu-id="b8fe3-147">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="b8fe3-147">LINQ to DataSet</span></span>](../../../../docs/framework/data/adonet/linq-to-dataset.md)  
 [<span data-ttu-id="b8fe3-148">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="b8fe3-148">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)  
 [<span data-ttu-id="b8fe3-149">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="b8fe3-149">LINQ to Entities</span></span>](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)  
 [<span data-ttu-id="b8fe3-150">LINQ（语言集成查询）</span><span class="sxs-lookup"><span data-stu-id="b8fe3-150">LINQ (Language-Integrated Query)</span></span>](http://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d)  
 [<span data-ttu-id="b8fe3-151">ADO.NET 托管提供程序和数据集开发人员中心</span><span class="sxs-lookup"><span data-stu-id="b8fe3-151">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
