---
title: "使用.NET Framework 的传输层安全 (TLS) 最佳做法"
description: "介绍使用.NET Framework 使用传输层安全 (TLS) 的最佳做法"
ms.date: 03/15/2018
ms.prod: .net-framework
ms.topic: article
helpviewer_keywords:
- sending data, Internet security
- protocols, Internet security
- Network security
- network resources, Internet security
- receiving data, Internet security
- authentication [.NET Framework], Internet security
- Internet, security
- security [.NET Framework], Internet
- permissions [.NET Framework], Internet
author: blowdart
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 64829eee5b21a44acb18cbec9b901d77d49cab90
ms.sourcegitcommit: 3eea47bff3201ae5d3395b0c7947806c2faca255
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/16/2018
---
# <a name="transport-layer-security-tls-best-practices-with-the-net-framework"></a><span data-ttu-id="cff0a-103">使用.NET Framework 的传输层安全 (TLS) 最佳做法</span><span class="sxs-lookup"><span data-stu-id="cff0a-103">Transport Layer Security (TLS) best practices with the .NET Framework</span></span>

<span data-ttu-id="cff0a-104">传输层安全 (TLS) 协议是信息的行业标准旨在帮助保护通过 Internet 进行通信的私密性。</span><span class="sxs-lookup"><span data-stu-id="cff0a-104">The Transport Layer Security (TLS) protocol is an industry standard designed to help protect the privacy of information communicated over the Internet.</span></span> <span data-ttu-id="cff0a-105">[TLS 1.2](https://tools.ietf.org/html/rfc5246)是最新的发布的标准和以前版本的基础提供安全改进。</span><span class="sxs-lookup"><span data-stu-id="cff0a-105">[TLS 1.2](https://tools.ietf.org/html/rfc5246) is the newest released standard and provides security improvements over previous versions.</span></span> <span data-ttu-id="cff0a-106">TLS 1.2 最终将被[TLS 1.3](https://tools.ietf.org/html/draft-ietf-tls-tls13-22)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-106">TLS 1.2 will eventually be replaced by [TLS 1.3](https://tools.ietf.org/html/draft-ietf-tls-tls13-22).</span></span> <span data-ttu-id="cff0a-107">本文提供了建议保护使用 TLS 协议的.NET Framework 应用程序。</span><span class="sxs-lookup"><span data-stu-id="cff0a-107">This article presents recommendations to secure .NET Framework applications that use the TLS protocol.</span></span>

<span data-ttu-id="cff0a-108">若要确保.NET Framework 应用程序保持安全，TLS 版本应**不**进行硬编码。</span><span class="sxs-lookup"><span data-stu-id="cff0a-108">To ensure .NET Framework applications remain secure, the TLS version should **not** be hardcoded.</span></span> <span data-ttu-id="cff0a-109">.NET framework 应用程序应使用操作系统 (OS) 支持 TLS 版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-109">.NET Framework applications should use the TLS version the operating system (OS) supports.</span></span>

<span data-ttu-id="cff0a-110">本文档面向开发人员：</span><span class="sxs-lookup"><span data-stu-id="cff0a-110">This document targets developers who are:</span></span>

- <span data-ttu-id="cff0a-111">直接使用<xref:System.Net>Api (例如，<xref:System.Net.Http.HttpClient?displayProperty=nameWithType>和<xref:System.Net.Security.SslStream?displayProperty=nameWithType>)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-111">Directly using the <xref:System.Net> APIs (for example, <xref:System.Net.Http.HttpClient?displayProperty=nameWithType> and <xref:System.Net.Security.SslStream?displayProperty=nameWithType>).</span></span>
- <span data-ttu-id="cff0a-112">直接使用 WCF 客户端和服务使用<xref:System.ServiceModel?displayProperty=nameWithType>命名空间。</span><span class="sxs-lookup"><span data-stu-id="cff0a-112">Directly using WCF clients and services using the <xref:System.ServiceModel?displayProperty=nameWithType> namespace.</span></span>
- <span data-ttu-id="cff0a-113">使用[Azure 云服务](https://azure.microsoft.com/services/cloud-services/)承载和运行你的应用程序的 Web 和辅助角色。</span><span class="sxs-lookup"><span data-stu-id="cff0a-113">Using [Azure Cloud Services](https://azure.microsoft.com/services/cloud-services/) Web and Worker roles to host and run your application.</span></span> <span data-ttu-id="cff0a-114">请参阅[Azure 云服务](#azure-cloud-services)部分。</span><span class="sxs-lookup"><span data-stu-id="cff0a-114">See the [Azure Cloud Services](#azure-cloud-services) section.</span></span>

<span data-ttu-id="cff0a-115">我们建议您：</span><span class="sxs-lookup"><span data-stu-id="cff0a-115">We recommend that you:</span></span>

- <span data-ttu-id="cff0a-116">面向.NET Framework 4.7 或更高版本上你的应用。</span><span class="sxs-lookup"><span data-stu-id="cff0a-116">Target .NET Framework 4.7 or later versions on your apps.</span></span> <span data-ttu-id="cff0a-117">面向.NET Framework 4.7.1 或对 WCF 应用程序的更高版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-117">Target .NET Framework 4.7.1 or later versions on your WCF apps.</span></span>
- <span data-ttu-id="cff0a-118">未指定 TLS 版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-118">Do not specify the TLS version.</span></span> <span data-ttu-id="cff0a-119">配置你的代码，以便决定使用 TLS 版本的操作系统。</span><span class="sxs-lookup"><span data-stu-id="cff0a-119">Configure your code to let the OS decide on the TLS version.</span></span>
- <span data-ttu-id="cff0a-120">执行全面的代码审核，以验证你在不指定的 TLS 或 SSL 版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-120">Perform a thorough code audit to verify you're not specifying a TLS or SSL version.</span></span>

<span data-ttu-id="cff0a-121">当你的应用程序允许选择 TLS 版本的操作系统：</span><span class="sxs-lookup"><span data-stu-id="cff0a-121">When your app lets the OS choose the TLS version:</span></span>

- <span data-ttu-id="cff0a-122">它会自动执行新协议添加在将来，如 TLS 1.3 优点。</span><span class="sxs-lookup"><span data-stu-id="cff0a-122">It automatically takes advantage of new protocols added in the future, such as TLS 1.3.</span></span>
- <span data-ttu-id="cff0a-123">OS 阻止发现不是安全的协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-123">The OS blocks protocols that are discovered not to be secure.</span></span>

<span data-ttu-id="cff0a-124">部分[审核你的代码和进行代码更改](#audit-your-code-and-make-code-changes)介绍了审核和更新你的代码。</span><span class="sxs-lookup"><span data-stu-id="cff0a-124">The section [Audit your code and make code changes](#audit-your-code-and-make-code-changes) covers auditing and updating your code.</span></span>

<span data-ttu-id="cff0a-125">此文章介绍了如何启用适用于你的应用程序面向的且在上运行的.NET framework 版本的最高安全性。</span><span class="sxs-lookup"><span data-stu-id="cff0a-125">This article explains how to enable the strongest security available for the version of the .NET Framework that your app targets and runs on.</span></span> <span data-ttu-id="cff0a-126">当应用程序显式设置安全协议和版本时，它将 opts 超出任何其他的替代项，并 opts 退出.NET Framework 和操作系统的默认行为。</span><span class="sxs-lookup"><span data-stu-id="cff0a-126">When an app explicitly sets a security protocol and version, it opts out of any other alternative, and opts out of .NET Framework and OS default behavior.</span></span> <span data-ttu-id="cff0a-127">如果你希望应用才能进行协商的 TLS 1.2 连接，则将显式设置为较低的 TLS 版本将阻止 TLS 1.2 连接。</span><span class="sxs-lookup"><span data-stu-id="cff0a-127">If you want your app to be able to negotiate a TLS 1.2 connection, explicitly setting to a lower TLS version prevents a TLS 1.2 connection.</span></span>

<span data-ttu-id="cff0a-128">如果无法避免硬编码的协议版本，我们强烈建议您指定 TLS 1.2。</span><span class="sxs-lookup"><span data-stu-id="cff0a-128">If you can't avoid hardcoding a protocol version, we strongly recommend that you specify TLS 1.2.</span></span> <span data-ttu-id="cff0a-129">有关标识并删除 TLS 1.0 依赖项的指南，下载[解决 TLS 1.0 问题](https://www.microsoft.com/download/details.aspx?id=55266)白皮书。</span><span class="sxs-lookup"><span data-stu-id="cff0a-129">For guidance on identifying and removing TLS 1.0 dependencies, download the [Solving the TLS 1.0 Problem](https://www.microsoft.com/download/details.aspx?id=55266) whitepaper.</span></span>

<span data-ttu-id="cff0a-130">WCF 支持 TLS1.0，1.1 和 1.2 作为.NET Framework 4.7 中的默认值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-130">WCF Supports TLS1.0, 1.1 and 1.2 as the default in .NET Framework 4.7.</span></span> <span data-ttu-id="cff0a-131">从.NET Framework 4.7.1 开始，WCF 默认为操作系统配置版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-131">Starting with .NET Framework 4.7.1, WCF defaults to the operating system configured version.</span></span> <span data-ttu-id="cff0a-132">如果应用程序显式配置与`SslProtocols.None`，当使用 NetTcp 传输时，WCF 会使用操作系统的默认设置。</span><span class="sxs-lookup"><span data-stu-id="cff0a-132">If an application is explicitly configured with `SslProtocols.None`, WCF uses the operating system default setting when using the NetTcp transport.</span></span>

<span data-ttu-id="cff0a-133">你可以提问有关本文档中 GitHub 问题[传输层安全 (TLS) 的最佳做法与.NET Framework](https://github.com/dotnet/docs/issues/4675)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-133">You can ask questions about this document in the GitHub issue [Transport Layer Security (TLS) best practices with the .NET Framework](https://github.com/dotnet/docs/issues/4675).</span></span>

## <a name="audit-your-code-and-make-code-changes"></a><span data-ttu-id="cff0a-134">审核你的代码和进行代码更改</span><span class="sxs-lookup"><span data-stu-id="cff0a-134">Audit your code and make code changes</span></span>

<span data-ttu-id="cff0a-135">对于 ASP.NET 应用程序中，检查`<system.web><httpRuntime targetFramework>`元素_web.config_以验证你在使用.NET Framework 目标的版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-135">For ASP.NET applications, inspect the `<system.web><httpRuntime targetFramework>` element of _web.config_ to verify you're using the intended version of the .NET Framework.</span></span>

<span data-ttu-id="cff0a-136">Windows 窗体和其他应用程序，请参阅[如何： 面向.NET Framework 版本](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-136">For Windows Forms and other applications, see [How to: Target a Version of the .NET Framework](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework).</span></span>

<span data-ttu-id="cff0a-137">使用下列部分来验证你在不使用特定的 TLS 或 SSL 版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-137">Use the following sections to verify you're not using a specific TLS or SSL version.</span></span>

## <a name="if-your-app-targets-net-framework-47-or-later-versions"></a><span data-ttu-id="cff0a-138">如果你的应用面向.NET Framework 4.7 或更高版本</span><span class="sxs-lookup"><span data-stu-id="cff0a-138">If your app targets .NET Framework 4.7 or later versions</span></span>

<span data-ttu-id="cff0a-139">以下部分说明如何验证你在不使用特定的 TLS 或 SSL 版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-139">The following sections show how to verify you're not using a specific TLS or SSL version.</span></span>

### <a name="for-http-networking"></a><span data-ttu-id="cff0a-140">HTTP 网络</span><span class="sxs-lookup"><span data-stu-id="cff0a-140">For HTTP networking</span></span>

<span data-ttu-id="cff0a-141"><xref:System.Net.ServicePointManager>使用.NET Framework 4.7 和更高版本，默认为选择的最佳安全协议和版本的操作系统。</span><span class="sxs-lookup"><span data-stu-id="cff0a-141"><xref:System.Net.ServicePointManager>, using .NET Framework 4.7 and later versions, defaults to the OS choosing the best security protocol and version.</span></span> <span data-ttu-id="cff0a-142">若要获取的默认 OS 最佳选择，如果可能，未设置的值<xref:System.Net.ServicePointManager.SecurityProtocol>属性。</span><span class="sxs-lookup"><span data-stu-id="cff0a-142">To get the default OS best choice, if possible, don't set a value for the <xref:System.Net.ServicePointManager.SecurityProtocol> property.</span></span> <span data-ttu-id="cff0a-143">否则，将其设置为 <xref:System.Net.SecurityProtocolType.SystemDefault>。</span><span class="sxs-lookup"><span data-stu-id="cff0a-143">Otherwise, set it to <xref:System.Net.SecurityProtocolType.SystemDefault>.</span></span>

<span data-ttu-id="cff0a-144">面向.NET Framework 4.7 或更高版本的 HTTP 网络时，此文章的剩余部分不相关。</span><span class="sxs-lookup"><span data-stu-id="cff0a-144">The remainder of this article is not relevant when targeting .NET Framework 4.7 or later versions for HTTP networking.</span></span>

### <a name="for-tcp-sockets-networking"></a><span data-ttu-id="cff0a-145">有关网络的 TCP 套接字</span><span class="sxs-lookup"><span data-stu-id="cff0a-145">For TCP sockets networking</span></span>

<span data-ttu-id="cff0a-146"><xref:System.Net.Security.SslStream>使用.NET Framework 4.7 和更高版本，默认为选择的最佳安全协议和版本的操作系统。</span><span class="sxs-lookup"><span data-stu-id="cff0a-146"><xref:System.Net.Security.SslStream>, using .NET Framework 4.7 and later versions, defaults to the OS choosing the best security protocol and version.</span></span> <span data-ttu-id="cff0a-147">若要获取的默认 OS 最佳选择，如果可能，不使用的方法重载<xref:System.Net.Security.SslStream>它们采用显式<xref:System.Security.Authentication.SslProtocols>参数。</span><span class="sxs-lookup"><span data-stu-id="cff0a-147">To get the default OS best choice, if possible, don't use the method overloads of <xref:System.Net.Security.SslStream> that take an explicit <xref:System.Security.Authentication.SslProtocols> parameter.</span></span> <span data-ttu-id="cff0a-148">否则，将传递<xref:System.Security.Authentication.SslProtocols.None?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="cff0a-148">Otherwise, pass <xref:System.Security.Authentication.SslProtocols.None?displayProperty=nameWithType>.</span></span> <span data-ttu-id="cff0a-149">我们建议你不要使用<xref:System.Security.Authentication.SslProtocols.Default>; 设置`SslProtocols.Default`强制使用 SSL 3.0 /TLS 1.0 并防止 TLS 1.2。</span><span class="sxs-lookup"><span data-stu-id="cff0a-149">We recommend that you don't use <xref:System.Security.Authentication.SslProtocols.Default>; setting `SslProtocols.Default` forces the use of SSL 3.0 /TLS 1.0 and prevent TLS 1.2.</span></span>

<span data-ttu-id="cff0a-150">未设置的值<xref:System.Net.ServicePointManager.SecurityProtocol>属性 （对于 HTTP 网络）。</span><span class="sxs-lookup"><span data-stu-id="cff0a-150">Don't set a value for the <xref:System.Net.ServicePointManager.SecurityProtocol> property (for HTTP networking).</span></span>

<span data-ttu-id="cff0a-151">不使用的方法重载<xref:System.Net.Security.SslStream>它们采用显式<xref:System.Security.Authentication.SslProtocols>参数 （对于 TCP 套接字网络）。</span><span class="sxs-lookup"><span data-stu-id="cff0a-151">Don't use the method overloads of <xref:System.Net.Security.SslStream> that take an explicit <xref:System.Security.Authentication.SslProtocols> parameter (for TCP sockets networking).</span></span> <span data-ttu-id="cff0a-152">当你将重定向到.NET Framework 4.7 或更高版本应用程序时，你将以下最佳实践建议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-152">When you retarget your app to .NET Framework 4.7 or later versions, you'll be following the best practices recommendation.</span></span>

<span data-ttu-id="cff0a-153">在面向.NET Framework 4.7 或更高版本 TCP 套接字的网络时，此主题的其余部分不相关。</span><span class="sxs-lookup"><span data-stu-id="cff0a-153">The remainder of this topic is not relevant when targeting .NET Framework 4.7 or later versions for TCP sockets networking.</span></span>

<a name="wcf-tcp-cert"></a>

### <a name="for-wcf-tcp-transport-using-transport-security-with-certificate-credentials"></a><span data-ttu-id="cff0a-154">对于 WCF TCP 传输使用证书凭据的传输安全性</span><span class="sxs-lookup"><span data-stu-id="cff0a-154">For WCF TCP transport using transport security with certificate credentials</span></span>

<span data-ttu-id="cff0a-155">WCF 使用.NET Framework 的其余部分所在的相同网络堆栈。</span><span class="sxs-lookup"><span data-stu-id="cff0a-155">WCF uses the same networking stack as the rest of the .NET Framework.</span></span>

<span data-ttu-id="cff0a-156">如果你正面向 4.7.1，WCF 被配置为允许的 OS，默认情况下选择最佳的安全协议，除非显式配置：</span><span class="sxs-lookup"><span data-stu-id="cff0a-156">If you are targeting 4.7.1, WCF is configured to allow the OS to choose the best security protocol by default unless explicitly configured:</span></span>

- <span data-ttu-id="cff0a-157">在应用程序配置文件。</span><span class="sxs-lookup"><span data-stu-id="cff0a-157">In your application configuration file.</span></span>
- <span data-ttu-id="cff0a-158">**或**，应用程序中的源代码。</span><span class="sxs-lookup"><span data-stu-id="cff0a-158">**Or**, in your application in the source code.</span></span>

<span data-ttu-id="cff0a-159">默认情况下，.NET Framework 4.7 及更高版本配置为使用 TLS 1.2，并允许使用 TLS 1.1 或 TLS 1.0 的连接。</span><span class="sxs-lookup"><span data-stu-id="cff0a-159">By default, .NET Framework 4.7 and later versions is configured to use TLS 1.2 and allows connections using TLS 1.1 or TLS 1.0.</span></span> <span data-ttu-id="cff0a-160">配置 WCF 以允许通过配置绑定以使用选择最佳的安全协议的 OS <xref:System.Security.Authentication.SslProtocols.None?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="cff0a-160">Configure WCF to allow the OS to choose the best security protocol by configuring your binding to use <xref:System.Security.Authentication.SslProtocols.None?displayProperty=nameWithType>.</span></span> <span data-ttu-id="cff0a-161">这可以对设置<xref:System.ServiceModel.TcpTransportSecurity.SslProtocols>。</span><span class="sxs-lookup"><span data-stu-id="cff0a-161">This can be set on <xref:System.ServiceModel.TcpTransportSecurity.SslProtocols>.</span></span> <span data-ttu-id="cff0a-162">`SslProtocols.None` 可以从访问<xref:System.ServiceModel.NetTcpSecurity.Transport>。</span><span class="sxs-lookup"><span data-stu-id="cff0a-162">`SslProtocols.None` can be accessed from <xref:System.ServiceModel.NetTcpSecurity.Transport>.</span></span> <span data-ttu-id="cff0a-163">`NetTcpSecurity.Transport` 可以从访问<xref:System.ServiceModel.NetTcpBinding.Security>。</span><span class="sxs-lookup"><span data-stu-id="cff0a-163">`NetTcpSecurity.Transport` can be accessed from <xref:System.ServiceModel.NetTcpBinding.Security>.</span></span>

<span data-ttu-id="cff0a-164">如果你使用自定义绑定：</span><span class="sxs-lookup"><span data-stu-id="cff0a-164">If you're using a custom binding:</span></span>

- <span data-ttu-id="cff0a-165">配置 WCF 允许 OS，以通过设置选择最佳的安全协议<xref:System.ServiceModel.Channels.SslStreamSecurityBindingElement.SslProtocols>使用<xref:System.Security.Authentication.SslProtocols.None?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="cff0a-165">Configure WCF to allow the OS to choose the best security protocol by setting <xref:System.ServiceModel.Channels.SslStreamSecurityBindingElement.SslProtocols> to use <xref:System.Security.Authentication.SslProtocols.None?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="cff0a-166">**或者**配置用于配置路径的协议`system.serviceModel/bindings/customBinding/binding/sslStreamSecurity:sslProtocols`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-166">**Or** configure the protocol used with the configuration path `system.serviceModel/bindings/customBinding/binding/sslStreamSecurity:sslProtocols`.</span></span>

<span data-ttu-id="cff0a-167">如果你是**不**使用自定义绑定**和**正在设置 WCF 绑定使用配置，请将设置用于配置路径的协议`system.serviceModel/bindings/netTcpBinding/binding/security/transport:sslProtocols`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-167">If you're **not** using a custom binding **and** you're setting your WCF binding using configuration, set the protocol used with the configuration path `system.serviceModel/bindings/netTcpBinding/binding/security/transport:sslProtocols`.</span></span>

### <a name="for-wcf-message-security-with-certificate-credentials"></a><span data-ttu-id="cff0a-168">使用证书凭据的 WCF 消息安全性</span><span class="sxs-lookup"><span data-stu-id="cff0a-168">For WCF Message Security with certificate credentials</span></span>

<span data-ttu-id="cff0a-169">.NET framework 4.7 和更高版本，默认情况下的使用协议中指定<xref:System.Net.ServicePointManager.SecurityProtocol>属性。</span><span class="sxs-lookup"><span data-stu-id="cff0a-169">.NET Framework 4.7 and later versions by default uses the protocol specified in the <xref:System.Net.ServicePointManager.SecurityProtocol> property.</span></span> <span data-ttu-id="cff0a-170">当[AppContextSwitch](../configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) `Switch.System.ServiceModel.DisableUsingServicePointManagerSecurityProtocols`设置为`true`，WCF 选择最佳的协议，最多 TLS 1.0。</span><span class="sxs-lookup"><span data-stu-id="cff0a-170">When the [AppContextSwitch](../configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) `Switch.System.ServiceModel.DisableUsingServicePointManagerSecurityProtocols` is set to `true`, WCF chooses the best protocol, up to TLS 1.0.</span></span>

## <a name="if-your-app-targets-a-net-framework-version-earlier-than-47"></a><span data-ttu-id="cff0a-171">如果你的应用面向.NET Framework 版本早于 4.7</span><span class="sxs-lookup"><span data-stu-id="cff0a-171">If your app targets a .NET Framework version earlier than 4.7</span></span>

<span data-ttu-id="cff0a-172">审核你的代码以验证未设置特定的 TLS 或 SSL 版本，将使用以下各节：</span><span class="sxs-lookup"><span data-stu-id="cff0a-172">Audit your code to verify you're not setting a specific TLS or SSL version using the following sections:</span></span>

### <a name="for-net-framework-46---462-and-not-wfc"></a><span data-ttu-id="cff0a-173">用于.NET Framework 4.6-4.6.2 和 WFC 不</span><span class="sxs-lookup"><span data-stu-id="cff0a-173">For .NET Framework 4.6 - 4.6.2 and not WFC</span></span>

<span data-ttu-id="cff0a-174">设置`DontEnableSystemDefaultTlsVersions``AppContext`切换到`false`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-174">Set the `DontEnableSystemDefaultTlsVersions` `AppContext` switch to `false`.</span></span> <span data-ttu-id="cff0a-175">请参阅[配置安全性通过 AppContext 交换机](#configuring-security-via-appcontext-switches)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-175">See [Configuring security via AppContext switches](#configuring-security-via-appcontext-switches).</span></span>

### <a name="for-wcf-using-net-framework-46---462-using-tcp-transport-security-with-certificate-credentials"></a><span data-ttu-id="cff0a-176">使用.NET Framework 4.6-4.6.2 使用证书凭据使用 TCP 传输安全的 WCF</span><span class="sxs-lookup"><span data-stu-id="cff0a-176">For WCF using .NET Framework 4.6 - 4.6.2 using TCP transport security with Certificate Credentials</span></span>

<span data-ttu-id="cff0a-177">你必须安装最新的操作系统修补程序。</span><span class="sxs-lookup"><span data-stu-id="cff0a-177">You must install the latest OS patches.</span></span> <span data-ttu-id="cff0a-178">请参阅[安全更新](#security-updates)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-178">See [Security updates](#security-updates).</span></span>

<span data-ttu-id="cff0a-179">WCF 框架会自动选择可用直到 TLS 1.2 达到的最高协议，除非您显式配置的协议版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-179">The WCF framework automatically chooses the highest protocol available up to TLS 1.2 unless you explicitly configure a protocol version.</span></span> <span data-ttu-id="cff0a-180">有关详细信息，请参阅上一部分中[为 WCF TCP 传输使用证书凭据的传输安全性](#wcf-tcp-cert)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-180">For more information, see the preceding section [For WCF TCP transport using transport security with certificate credentials](#wcf-tcp-cert).</span></span>

### <a name="for-net-framework-35---451-and-not-wcf"></a><span data-ttu-id="cff0a-181">用于.NET Framework 3.5-4.5.1 和不 WCF</span><span class="sxs-lookup"><span data-stu-id="cff0a-181">For .NET Framework 3.5 - 4.5.1 and not WCF</span></span>

<span data-ttu-id="cff0a-182">我们建议将你的应用程序升级到.NET Framework 4.7 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-182">We recommend you upgrade your app to .NET Framework 4.7 or later versions.</span></span> <span data-ttu-id="cff0a-183">如果你不能升级，请执行以下步骤。</span><span class="sxs-lookup"><span data-stu-id="cff0a-183">If you cannot upgrade, take the following steps.</span></span> <span data-ttu-id="cff0a-184">将来，通过在某个时间点你的应用程序可能会失败之前升级到.NET Framework 4.7 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-184">At some point in the future, your application may fail until you upgrade to .NET Framework 4.7 or later versions.</span></span>

<span data-ttu-id="cff0a-185">设置[SchUseStrongCrypto](#schusestrongcrypto)和[SystemDefaultTlsVersions](#systemdefaulttlsversions)为 1 的注册表项。</span><span class="sxs-lookup"><span data-stu-id="cff0a-185">Set the [SchUseStrongCrypto](#schusestrongcrypto) and [SystemDefaultTlsVersions](#systemdefaulttlsversions) registry keys to 1.</span></span> <span data-ttu-id="cff0a-186">请参阅[配置通过 Windows 注册表安全性](#configuring-security-via-the-windows-registry)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-186">See [Configuring security via the Windows Registry](#configuring-security-via-the-windows-registry).</span></span> <span data-ttu-id="cff0a-187">.NET Framework 版本 3.5 支持`SchUseStrongCrypto`标志仅当显式 TLS 值传递。</span><span class="sxs-lookup"><span data-stu-id="cff0a-187">The .NET Framework version 3.5 supports the `SchUseStrongCrypto` flag only when an explicit TLS value is passed.</span></span>

<span data-ttu-id="cff0a-188">如果你在.NET Framework 3.5 上运行，你需要安装热修补程序，以便 TLS 1.2 可以指定由你的程序：</span><span class="sxs-lookup"><span data-stu-id="cff0a-188">If you are running on .NET Framework 3.5, you need to install a hot patch so that TLS 1.2 can be specified by your program:</span></span>

| [<span data-ttu-id="cff0a-189">KB3154518</span><span class="sxs-lookup"><span data-stu-id="cff0a-189">KB3154518</span></span>](https://support.microsoft.com/kb/3154518) | <span data-ttu-id="cff0a-190">.NET Framework 3.5.1 在 Windows 7 SP1 和 Server 2008 R2 SP1 中包括了可靠性汇总 HR-1605-对 TLS 系统默认版本支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-190">Reliability Rollup HR-1605 - Support for TLS System Default Versions included in the .NET Framework 3.5.1 on Windows 7 SP1 and Server 2008 R2 SP1</span></span> |
| --- | --- |
| [<span data-ttu-id="cff0a-191">KB3154519</span><span class="sxs-lookup"><span data-stu-id="cff0a-191">KB3154519</span></span>](https://support.microsoft.com/kb/3154519) | <span data-ttu-id="cff0a-192">可靠性汇总 HR-1605-TLS 系统默认版本包括在 Windows Server 2012 上的.NET Framework 3.5 的支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-192">Reliability Rollup HR-1605 - Support for TLS System Default Versions included in the .NET Framework 3.5 on Windows Server 2012</span></span> |
| [<span data-ttu-id="cff0a-193">KB3154520</span><span class="sxs-lookup"><span data-stu-id="cff0a-193">KB3154520</span></span>](https://support.microsoft.com/kb/3154520) | <span data-ttu-id="cff0a-194">可靠性汇总 HR 1605-Windows 8.1 和 Windows Server 2012 R2 上的.NET Framework 3.5 中包含的 TLS 系统默认版本的支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-194">Reliability Rollup HR-1605 -Support for TLS System Default Versions included in the .NET Framework 3.5 on Windows 8.1 and Windows Server 2012 R2</span></span> |
| [<span data-ttu-id="cff0a-195">KB3156421</span><span class="sxs-lookup"><span data-stu-id="cff0a-195">KB3156421</span></span>](https://support.microsoft.com/kb/3156421) | <span data-ttu-id="cff0a-196">.NET Framework 4.5.2 和 Windows 上的 4.5.1 1605年修补程序汇总 3154521</span><span class="sxs-lookup"><span data-stu-id="cff0a-196">1605 Hotfix rollup 3154521 for the .NET Framework 4.5.2 and 4.5.1 on Windows</span></span> |

### <a name="for-wcf-using-net-framework-35---452-using-tcp-transport-security-with-certificate-credentials"></a><span data-ttu-id="cff0a-197">使用.NET Framework 3.5-4.5.2 使用证书凭据使用 TCP 传输安全的 WCF</span><span class="sxs-lookup"><span data-stu-id="cff0a-197">For WCF using .NET Framework 3.5 - 4.5.2 using TCP transport security with Certificate Credentials</span></span>

<span data-ttu-id="cff0a-198">WCF framework 的这些版本进行了硬编码为使用 SSL 3.0 和 TLS 1.0 的值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-198">These versions of the WCF framework are hardcoded to use values SSL 3.0 and TLS 1.0.</span></span> <span data-ttu-id="cff0a-199">无法更改这些值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-199">These values cannot be changed.</span></span> <span data-ttu-id="cff0a-200">你必须首先更新和重定目标到要使用 TLS 1.1 和 1.2 的 NET Framework 4.6 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-200">You must update and retarget to NET Framework 4.6 or later versions to use TLS 1.1 and 1.2.</span></span>

## <a name="if-your-app-targets-net-framework-35"></a><span data-ttu-id="cff0a-201">如果你的应用面向.NET Framework 3.5</span><span class="sxs-lookup"><span data-stu-id="cff0a-201">If your app targets .NET Framework 3.5</span></span>

<span data-ttu-id="cff0a-202">如果您必须显式设置而不是由.NET framework 或 OS 选取一种安全协议的安全协议，将添加`SecurityProtocolTypeExtensions`和`SslProtocolsExtension`到你的代码的枚举。</span><span class="sxs-lookup"><span data-stu-id="cff0a-202">If you must explicitly set a security protocol instead of letting the .NET framework or the OS pick the security protocol, add `SecurityProtocolTypeExtensions` and `SslProtocolsExtension` enumerations to your code.</span></span> <span data-ttu-id="cff0a-203">`SecurityProtocolTypeExtensions` 和`SslProtocolsExtension`包括值`Tls12`， `Tls11`，和`SystemDefault`值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-203">`SecurityProtocolTypeExtensions` and `SslProtocolsExtension` include values for `Tls12`, `Tls11`, and the `SystemDefault` value.</span></span> <span data-ttu-id="cff0a-204">请参阅[的 TLS 系统默认版本包括在 Windows 8.1 和 Windows Server 2012 R2 上的.NET Framework 3.5 的支持](https://support.microsoft.com/help/3154520/support-for-tls-system-default-versions-included-in-the--net-framework)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-204">See [Support for TLS System Default Versions included in .NET Framework 3.5 on Windows 8.1 and Windows Server 2012 R2](https://support.microsoft.com/help/3154520/support-for-tls-system-default-versions-included-in-the--net-framework).</span></span>

<a name="configuring-security-via-appcontext-switches"></a>

## <a name="configuring-security-via-appcontext-switches-for-net-framework-46-or-later-versions"></a><span data-ttu-id="cff0a-205">配置安全性通过 AppContext 切换 （用于.NET Framework 4.6 或更高版本）</span><span class="sxs-lookup"><span data-stu-id="cff0a-205">Configuring security via AppContext switches (for .NET Framework 4.6 or later versions)</span></span>

<span data-ttu-id="cff0a-206">[AppContext](../configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)本节中所述的开关是相关如果你的应用面向或.NET Framework 4.6 或更高版本上的运行。</span><span class="sxs-lookup"><span data-stu-id="cff0a-206">The [AppContext](../configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) switches described in this section are relevant if your app targets, or runs on, .NET Framework 4.6 or later versions.</span></span> <span data-ttu-id="cff0a-207">默认情况下，或通过将其显式设置，是否应为交换机`false`如有可能。</span><span class="sxs-lookup"><span data-stu-id="cff0a-207">Whether by default, or by setting them explicitly, the switches should be `false` if possible.</span></span> <span data-ttu-id="cff0a-208">如果你想要配置安全性通过一个或两个开关，则不指定安全协议值在你的代码;因此，这样做将替代交换机。</span><span class="sxs-lookup"><span data-stu-id="cff0a-208">If you want to configure security via one or both switches, then don't specify a security protocol value in your code; doing so would override the switch(es).</span></span>

<span data-ttu-id="cff0a-209">交换机都有相同的效果所做的 HTTP 网络是否 (<xref:System.Net.ServicePointManager>) 或 TCP 套接字网络 (<xref:System.Net.Security.SslStream>)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-209">The switches have the same effect whether you're doing HTTP networking (<xref:System.Net.ServicePointManager>) or TCP sockets networking (<xref:System.Net.Security.SslStream>).</span></span>

### <a name="switchsystemnetdontenableschusestrongcrypto"></a><span data-ttu-id="cff0a-210">Switch.System.Net.DontEnableSchUseStrongCrypto</span><span class="sxs-lookup"><span data-stu-id="cff0a-210">Switch.System.Net.DontEnableSchUseStrongCrypto</span></span>

<span data-ttu-id="cff0a-211">值为`false`为`Switch.System.Net.DontEnableSchUseStrongCrypto`会导致你的应用程序以使用强加密。</span><span class="sxs-lookup"><span data-stu-id="cff0a-211">A value of `false` for `Switch.System.Net.DontEnableSchUseStrongCrypto` causes your app to use strong cryptography.</span></span> <span data-ttu-id="cff0a-212">值为`false`为`DontEnableSchUseStrongCrypto`使用更安全的网络协议 （TLS 1.2、 TLS 1.1 和 TLS 1.0），并阻止不安全的协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-212">A value of `false` for `DontEnableSchUseStrongCrypto` uses more secure network protocols (TLS 1.2, TLS 1.1, and TLS 1.0) and blocks protocols that are not secure.</span></span> <span data-ttu-id="cff0a-213">有关详细信息，请参阅[SCH_USE_STRONG_CRYPTO 标志](#the-schusestrongcrypto-flag)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-213">For more info, see [The SCH_USE_STRONG_CRYPTO flag](#the-schusestrongcrypto-flag).</span></span> <span data-ttu-id="cff0a-214">值为`true`禁用您的应用程序的强加密。</span><span class="sxs-lookup"><span data-stu-id="cff0a-214">A value of `true` disables strong cryptography for your app.</span></span>

<span data-ttu-id="cff0a-215">如果你的应用面向.NET Framework 4.6 或更高版本，此开关将默认为`false`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-215">If your app targets .NET Framework 4.6 or later versions, this switch defaults to `false`.</span></span> <span data-ttu-id="cff0a-216">这是安全默认情况下，我们建议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-216">That's a secure default, which we recommend.</span></span> <span data-ttu-id="cff0a-217">如果你的应用程序在.NET Framework 4.6 上运行但面向早期版本，交换机将默认为`true`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-217">If your app runs on .NET Framework 4.6, but targets an earlier version, the switch defaults to `true`.</span></span> <span data-ttu-id="cff0a-218">在这种情况下，你应显式将其设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-218">In that case, you should explicitly set it to `false`.</span></span>

<span data-ttu-id="cff0a-219">`DontEnableSchUseStrongCrypto` 应仅具有的值`true`如果你需要连接到旧的服务不支持强加密，无法升级。</span><span class="sxs-lookup"><span data-stu-id="cff0a-219">`DontEnableSchUseStrongCrypto` should only have a value of `true` if you need to connect to legacy services that don't support strong cryptography and can't be upgraded.</span></span>

### <a name="switchsystemnetdontenablesystemdefaulttlsversions"></a><span data-ttu-id="cff0a-220">Switch.System.Net.DontEnableSystemDefaultTlsVersions</span><span class="sxs-lookup"><span data-stu-id="cff0a-220">Switch.System.Net.DontEnableSystemDefaultTlsVersions</span></span>

<span data-ttu-id="cff0a-221">值为`false`为`Switch.System.Net.DontEnableSystemDefaultTlsVersions`会导致你的应用以允许操作系统选择的协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-221">A value of `false` for `Switch.System.Net.DontEnableSystemDefaultTlsVersions` causes your app to allow the operating system to choose the protocol.</span></span> <span data-ttu-id="cff0a-222">值为`true`会导致你的应用程序以使用.NET framework 中选取的协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-222">A value of `true` causes your app to use protocols picked by the .NET Framework.</span></span>

<span data-ttu-id="cff0a-223">如果你的应用面向.NET Framework 4.7 或更高版本，此开关将默认为`false`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-223">If your app targets .NET Framework 4.7 or later versions, this switch defaults to `false`.</span></span> <span data-ttu-id="cff0a-224">这是建议的安全默认值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-224">That's a secure default that we recommend.</span></span> <span data-ttu-id="cff0a-225">如果你的应用在.NET Framework 4.7 或更高版本上运行但面向早期版本，交换机将默认为`true`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-225">If your app runs on .NET Framework 4.7 or later versions, but targets an earlier version, the switch defaults to `true`.</span></span> <span data-ttu-id="cff0a-226">在这种情况下，你应显式将其设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-226">In that case, you should explicitly set it to `false`.</span></span>

### <a name="switchsystemservicemodeldisableusingservicepointmanagersecurityprotocols"></a><span data-ttu-id="cff0a-227">Switch.System.ServiceModel.DisableUsingServicePointManagerSecurityProtocols</span><span class="sxs-lookup"><span data-stu-id="cff0a-227">Switch.System.ServiceModel.DisableUsingServicePointManagerSecurityProtocols</span></span>

<span data-ttu-id="cff0a-228">值为`false`为`Switch.System.ServiceModel.DisableUsingServicePointManagerSecurityProtocols`使你应用程序使用中定义的值`ServicePointManager.SecurityProtocols`来提供消息安全性使用证书凭据。</span><span class="sxs-lookup"><span data-stu-id="cff0a-228">A value of `false` for `Switch.System.ServiceModel.DisableUsingServicePointManagerSecurityProtocols` causes your application to use the value defined in `ServicePointManager.SecurityProtocols` for message security using certificate credentials.</span></span> <span data-ttu-id="cff0a-229">值为`true`使用可用，直到 TLS1.0 达到最高的协议</span><span class="sxs-lookup"><span data-stu-id="cff0a-229">A value of `true` uses the highest protocol available, up to TLS1.0</span></span>

<span data-ttu-id="cff0a-230">面向.NET Framework 4.7 及更高版本的应用程序，此值默认为`false`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-230">For applications targeting .NET Framework 4.7 and later versions, this value defaults to `false`.</span></span> <span data-ttu-id="cff0a-231">面向.NET Framework 4.6.2 应用程序和更早版本，此值默认为`true`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-231">For applications targeting .NET Framework 4.6.2 and earlier, this value defaults to `true`.</span></span>

### <a name="switchsystemservicemodeldontenablesystemdefaulttlsversions"></a><span data-ttu-id="cff0a-232">Switch.System.ServiceModel.DontEnableSystemDefaultTlsVersions</span><span class="sxs-lookup"><span data-stu-id="cff0a-232">Switch.System.ServiceModel.DontEnableSystemDefaultTlsVersions</span></span>

<span data-ttu-id="cff0a-233">值为`false`为`Switch.System.ServiceModel.DontEnableSystemDefaultTlsVersions`设置默认配置以允许操作系统选择的协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-233">A value of `false` for `Switch.System.ServiceModel.DontEnableSystemDefaultTlsVersions` sets the default configuration to allow the operating system to choose the protocol.</span></span> <span data-ttu-id="cff0a-234">值为`true`将默认值设置为可用，直到 TLS1.2 达到的最高协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-234">A value of `true` sets the default to the highest protocol available, up to TLS1.2.</span></span>

<span data-ttu-id="cff0a-235">面向.NET Framework 4.7.1 和更高版本的应用程序，此值默认为`false`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-235">For applications targeting .NET Framework 4.7.1 and later versions, this value defaults to `false`.</span></span> <span data-ttu-id="cff0a-236">面向.NET Framework 4.7 及更早版本的应用程序，此值默认为`true`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-236">For applications targeting .NET Framework 4.7 and earlier, this value defaults to `true`.</span></span>

<span data-ttu-id="cff0a-237">有关 TLS 协议的详细信息，请参阅[缓解： TLS 协议](../migration-guide/mitigation-tls-protocols.md)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-237">For more information about TLS protocols, see [Mitigation: TLS Protocols](../migration-guide/mitigation-tls-protocols.md).</span></span> <span data-ttu-id="cff0a-238">有关详细信息`AppContext`交换机，请参阅[ `<AppContextSwitchOverrides> Element` ](../configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-238">For more information about `AppContext` switches, see [`<AppContextSwitchOverrides> Element`](../configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md).</span></span>

## <a name="configuring-security-via-the-windows-registry"></a><span data-ttu-id="cff0a-239">通过 Windows 注册表配置安全性</span><span class="sxs-lookup"><span data-stu-id="cff0a-239">Configuring security via the Windows Registry</span></span>

<span data-ttu-id="cff0a-240">如果设置一个或两个`AppContext`交换机不是一个选项，您可以控制你的应用程序使用本节中所述的 Windows 注册表项具有的安全协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-240">If setting one or both `AppContext` switches are not an option, you can control the security protocols that your app uses with the Windows Registry keys described in this section.</span></span> <span data-ttu-id="cff0a-241">你可能不能使用一个或两`AppContext`切换如果你的应用面向.NET Framework 版本早于 4.6，或者你不能编辑配置文件。</span><span class="sxs-lookup"><span data-stu-id="cff0a-241">You might not be able to use one or both the `AppContext` switches if your app targets a .NET Framework version earlier than 4.6, or you can't edit the configuration file.</span></span> <span data-ttu-id="cff0a-242">如果你想要使用注册表中配置安全性，则不指定安全协议值在你的代码;这样做因此，将重写注册表。</span><span class="sxs-lookup"><span data-stu-id="cff0a-242">If you want to configure security with the registry, then don't specify a security protocol value in your code; doing so would override the registry.</span></span>

<span data-ttu-id="cff0a-243">注册表项的名称是类似于相应的名称`AppContext`但没有切换`DontEnable`预置的名称。</span><span class="sxs-lookup"><span data-stu-id="cff0a-243">The names of the registry keys are similar to the names of the corresponding `AppContext` switches but without a `DontEnable` prepended to the name.</span></span> <span data-ttu-id="cff0a-244">例如，`AppContext`切换`DontEnableSchUseStrongCrypto`称为注册表项[SchUseStrongCrypto](#schusestrongcrypto)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-244">For example, the `AppContext` switch `DontEnableSchUseStrongCrypto` is the registry key called [SchUseStrongCrypto](#schusestrongcrypto).</span></span>

<span data-ttu-id="cff0a-245">这些密钥是在没有最新的安全修补程序的所有.NET Framework 版本中可用。</span><span class="sxs-lookup"><span data-stu-id="cff0a-245">These keys are available in all .NET Framework versions for which there's a recent security patch.</span></span> <span data-ttu-id="cff0a-246">请参阅[安全更新](#security-updates)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-246">See [Security updates](#security-updates).</span></span>

<span data-ttu-id="cff0a-247">所有如下所述的注册表项所做的 HTTP 网络是否具有相同的效果 (<xref:System.Net.ServicePointManager>) 或 TCP 套接字网络 (<xref:System.Net.Security.SslStream>)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-247">All of the registry keys described below have the same effect whether you're doing HTTP networking (<xref:System.Net.ServicePointManager>) or TCP sockets networking (<xref:System.Net.Security.SslStream>).</span></span>

### <a name="schusestrongcrypto"></a><span data-ttu-id="cff0a-248">SchUseStrongCrypto</span><span class="sxs-lookup"><span data-stu-id="cff0a-248">SchUseStrongCrypto</span></span>

<span data-ttu-id="cff0a-249">`HKEY_LOCAL_MACHINE\SOFTWARE\[Wow6432Node\]Microsoft\.NETFramework\<VERSION>: SchUseStrongCrypto`注册表项具有类型为 DWORD 值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-249">The `HKEY_LOCAL_MACHINE\SOFTWARE\[Wow6432Node\]Microsoft\.NETFramework\<VERSION>: SchUseStrongCrypto` registry key has a value of type DWORD.</span></span> <span data-ttu-id="cff0a-250">值为 1 会导致你的应用程序以使用强加密。</span><span class="sxs-lookup"><span data-stu-id="cff0a-250">A value of 1 causes your app to use strong cryptography.</span></span> <span data-ttu-id="cff0a-251">强加密使用更安全的网络协议 （TLS 1.2、 TLS 1.1 和 TLS 1.0），并阻止不安全的协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-251">The strong cryptography uses more secure network protocols (TLS 1.2, TLS 1.1, and TLS 1.0) and blocks protocols that are not secure.</span></span> <span data-ttu-id="cff0a-252">值为 0 禁用强加密。</span><span class="sxs-lookup"><span data-stu-id="cff0a-252">A value of 0 disables strong cryptography.</span></span> <span data-ttu-id="cff0a-253">有关详细信息，请参阅[SCH_USE_STRONG_CRYPTO 标志](#the-schusestrongcrypto-flag)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-253">For more information, see [The SCH_USE_STRONG_CRYPTO flag](#the-schusestrongcrypto-flag).</span></span>

<span data-ttu-id="cff0a-254">如果你的应用面向.NET Framework 4.6 或更高版本，此密钥默认值为 1。</span><span class="sxs-lookup"><span data-stu-id="cff0a-254">If your app targets .NET Framework 4.6 or later versions, this key defaults to a value of 1.</span></span> <span data-ttu-id="cff0a-255">这是建议的安全默认值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-255">That's a secure default that we recommend.</span></span> <span data-ttu-id="cff0a-256">如果你的应用程序在.NET Framework 4.6 上运行但面向早期版本，该密钥将默认为 0。</span><span class="sxs-lookup"><span data-stu-id="cff0a-256">If your app runs on .NET Framework 4.6, but targets an earlier version, then the key defaults to 0.</span></span> <span data-ttu-id="cff0a-257">在这种情况下，应显式将其值设置为 1。</span><span class="sxs-lookup"><span data-stu-id="cff0a-257">In that case, you should explicitly set its value to 1.</span></span>

<span data-ttu-id="cff0a-258">如果您需要连接到旧的服务不支持强加密，无法升级，此密钥应仅具有值为 0。</span><span class="sxs-lookup"><span data-stu-id="cff0a-258">This key should only have a value of 0 if you need to connect to legacy services that don't support strong cryptography and can't be upgraded.</span></span>

### <a name="systemdefaulttlsversions"></a><span data-ttu-id="cff0a-259">SystemDefaultTlsVersions</span><span class="sxs-lookup"><span data-stu-id="cff0a-259">SystemDefaultTlsVersions</span></span>

<span data-ttu-id="cff0a-260">`HKEY_LOCAL_MACHINE\SOFTWARE\[Wow6432Node\]Microsoft\.NETFramework\<VERSION>: SystemDefaultTlsVersions`注册表项具有类型为 DWORD 值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-260">The `HKEY_LOCAL_MACHINE\SOFTWARE\[Wow6432Node\]Microsoft\.NETFramework\<VERSION>: SystemDefaultTlsVersions` registry key has a value of type DWORD.</span></span> <span data-ttu-id="cff0a-261">值为 1 会导致你的应用以允许操作系统选择的协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-261">A value of 1 causes your app to allow the operating system to choose the protocol.</span></span> <span data-ttu-id="cff0a-262">值为 0 会导致你的应用程序以使用.NET framework 中选取的协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-262">A value of 0 causes your app to use protocols picked by the .NET Framework.</span></span>

<span data-ttu-id="cff0a-263">`<VERSION>` 必须 v4.0.30319 （.NET Framework 4 及更高版本） 或 v2.0.50727 （适用于.NET Framework 3.5)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-263">`<VERSION>` must be v4.0.30319 (for .NET Framework 4 and above) or v2.0.50727 (for .NET Framework 3.5).</span></span>

<span data-ttu-id="cff0a-264">如果你的应用面向.NET Framework 4.7 或更高版本，此密钥默认值为 1。</span><span class="sxs-lookup"><span data-stu-id="cff0a-264">If your app targets .NET Framework 4.7 or later versions, this key defaults to a value of 1.</span></span> <span data-ttu-id="cff0a-265">这是建议的安全默认值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-265">That's a secure default that we recommend.</span></span> <span data-ttu-id="cff0a-266">如果你的应用程序在.NET Framework 4.7 或更高版本上运行但面向早期版本，该密钥将默认为 0。</span><span class="sxs-lookup"><span data-stu-id="cff0a-266">If your app runs on .NET Framework 4.7 or later versions, but targets an earlier version, the key defaults to 0.</span></span> <span data-ttu-id="cff0a-267">在这种情况下，应显式将其值设置为 1。</span><span class="sxs-lookup"><span data-stu-id="cff0a-267">In that case, you should explicitly set its value to 1.</span></span>

<span data-ttu-id="cff0a-268">有关详细信息，请参阅[更新 Windows 10 版本 1511 的累积和 Windows Server 2016 Technical Preview 4: 2016 年 5 月 10，](https://support.microsoft.com/help/3156421/cumulative-update-for-windows-10-version-1511-and-windows-server-2016)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-268">For more info, see [Cumulative Update for Windows 10 Version 1511 and Windows Server 2016 Technical Preview 4: May 10, 2016](https://support.microsoft.com/help/3156421/cumulative-update-for-windows-10-version-1511-and-windows-server-2016).</span></span>

<span data-ttu-id="cff0a-269">使用.NET framework 3.5.1 的详细信息，请参阅[支持 TLS 系统默认版本包括在 Windows 7 SP1 和 Server 2008 R2 SP1 上的.NET Framework 3.5.1](https://support.microsoft.com/help/3154518/support-for-tls-system-default-versions-included-in-the--net-framework)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-269">For more information with .NET framework 3.5.1, see [Support for TLS System Default Versions included in .NET Framework 3.5.1 on Windows 7 SP1 and Server 2008 R2 SP1](https://support.microsoft.com/help/3154518/support-for-tls-system-default-versions-included-in-the--net-framework).</span></span>

<span data-ttu-id="cff0a-270">以下_。REG_文件的注册表项和它们的变量设置为其最安全的值：</span><span class="sxs-lookup"><span data-stu-id="cff0a-270">The following _.REG_ file sets the registry keys and their variants to their most safe values:</span></span>

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\.NETFramework\v2.0.50727]
"SystemDefaultTlsVersions"=dword:00000001
"SchUseStrongCrypto"=dword:00000001

[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\.NETFramework\v4.0.30319]
"SystemDefaultTlsVersions"=dword:00000001
"SchUseStrongCrypto"=dword:00000001

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\v2.0.50727]
"SystemDefaultTlsVersions"=dword:00000001
"SchUseStrongCrypto"=dword:00000001

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\v4.0.30319]
"SystemDefaultTlsVersions"=dword:00000001
"SchUseStrongCrypto"=dword:00000001
```

## <a name="configuring-schannel-protocols-in-the-windows-registry"></a><span data-ttu-id="cff0a-271">在 Windows 注册表中配置 Schannel 协议</span><span class="sxs-lookup"><span data-stu-id="cff0a-271">Configuring Schannel protocols in the Windows Registry</span></span>

<span data-ttu-id="cff0a-272">注册表可用于对客户端和/或服务器应用程序进行协商的协议细化的控制。</span><span class="sxs-lookup"><span data-stu-id="cff0a-272">You can use the registry for fine-grained control over the protocols that your client and/or server app negotiates.</span></span> <span data-ttu-id="cff0a-273">你的应用的网络将经历 Schannel (这是另一个名称[安全通道](https://msdn.microsoft.com/library/windows/desktop/aa380123)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-273">Your app's networking goes through Schannel (which is another name for [Secure Channel](https://msdn.microsoft.com/library/windows/desktop/aa380123).</span></span> <span data-ttu-id="cff0a-274">通过配置`Schannel`，你可以配置你的应用的行为。</span><span class="sxs-lookup"><span data-stu-id="cff0a-274">By configuring `Schannel`, you can configure your app's behavior.</span></span>

<span data-ttu-id="cff0a-275">开头`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols`注册表项。</span><span class="sxs-lookup"><span data-stu-id="cff0a-275">Start with the `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols` registry key.</span></span> <span data-ttu-id="cff0a-276">在该注册表项下中，你可以创建的任何子项集中`SSL 2.0`， `SSL 3.0`， `TLS 1.0`， `TLS 1.1`，和`TLS 1.2`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-276">Under that key you can create any subkeys in the set `SSL 2.0`, `SSL 3.0`, `TLS 1.0`, `TLS 1.1`, and `TLS 1.2`.</span></span> <span data-ttu-id="cff0a-277">在每个这些子项中，你可以创建子项`Client`和/或`Server`。</span><span class="sxs-lookup"><span data-stu-id="cff0a-277">Under each of those subkeys, you can create subkeys `Client` and/or `Server`.</span></span> <span data-ttu-id="cff0a-278">下`Client`和`Server`，你可以创建 DWORD 值`DisabledByDefault`（0 或 1） 和`Enabled`（0 或 0xFFFFFFFF）。</span><span class="sxs-lookup"><span data-stu-id="cff0a-278">Under `Client` and `Server`, you can create DWORD values `DisabledByDefault` (0 or 1) and `Enabled` (0 or 0xFFFFFFFF).</span></span>

## <a name="the-schusestrongcrypto-flag"></a><span data-ttu-id="cff0a-279">SCH_USE_STRONG_CRYPTO 标志</span><span class="sxs-lookup"><span data-stu-id="cff0a-279">The SCH_USE_STRONG_CRYPTO flag</span></span>

<span data-ttu-id="cff0a-280">启用后 (默认情况下，通过`AppContext`切换，或通过 Windows 注册表)，.NET Framework 使用`SCH_USE_STRONG_CRYPTO`标志时你的应用程序请求 TLS 安全协议。</span><span class="sxs-lookup"><span data-stu-id="cff0a-280">When it's enabled (by default, by an `AppContext` switch, or by the Windows Registry), the .NET Framework uses the `SCH_USE_STRONG_CRYPTO` flag when your app requests a TLS security protocol.</span></span> <span data-ttu-id="cff0a-281">`SCH_USE_STRONG_CRYPTO`标志可以使用默认情况下，启用`AppContext`切换，或注册表。</span><span class="sxs-lookup"><span data-stu-id="cff0a-281">The `SCH_USE_STRONG_CRYPTO` flag can be enabled by default, with the `AppContext` switch, or with the Registry.</span></span> <span data-ttu-id="cff0a-282">操作系统将传递到标志`Schannel`以指示它禁用已知弱加密算法，密码套件和可能的更好的互操作性否则启用的 TLS/SSL 协议版本。</span><span class="sxs-lookup"><span data-stu-id="cff0a-282">The OS passes the flag to `Schannel`to instruct it to disable known weak cryptographic algorithms, cipher suites, and TLS/SSL protocol versions that may be otherwise enabled for better interoperability.</span></span> <span data-ttu-id="cff0a-283">有关详细信息，请参见:</span><span class="sxs-lookup"><span data-stu-id="cff0a-283">For more information, see:</span></span>

- [<span data-ttu-id="cff0a-284">安全通道</span><span class="sxs-lookup"><span data-stu-id="cff0a-284">Secure Channel</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa380123)
- [<span data-ttu-id="cff0a-285">SCHANNEL_CRED 结构</span><span class="sxs-lookup"><span data-stu-id="cff0a-285">SCHANNEL_CRED structure</span></span>](https://msdn.microsoft.com/library/windows/desktop/aa379810)

<span data-ttu-id="cff0a-286">`SCH_USE_STRONG_CRYPTO`标志还传递给`Schannel`当显式使用`Tls`(TLS 1.0) `Tls11`，或`Tls12`枚举的值<xref:System.Net.SecurityProtocolType>或<xref:System.Security.Authentication.SslProtocols>。</span><span class="sxs-lookup"><span data-stu-id="cff0a-286">The `SCH_USE_STRONG_CRYPTO` flag is also passed to `Schannel` when you explicitly use the `Tls` (TLS 1.0), `Tls11`, or `Tls12` enumerated values of <xref:System.Net.SecurityProtocolType> or <xref:System.Security.Authentication.SslProtocols>.</span></span>

## <a name="security-updates"></a><span data-ttu-id="cff0a-287">安全更新</span><span class="sxs-lookup"><span data-stu-id="cff0a-287">Security updates</span></span>

<span data-ttu-id="cff0a-288">这篇文章中的最佳实践取决于正在安装新的安全更新。</span><span class="sxs-lookup"><span data-stu-id="cff0a-288">The best practices in this article depend on recent security updates being installed.</span></span> <span data-ttu-id="cff0a-289">这些更新包括能够使用高级的.NET Framework 4.7 和更高版本的功能。</span><span class="sxs-lookup"><span data-stu-id="cff0a-289">These updates include the ability to use advanced .NET Framework 4.7 and later features.</span></span> <span data-ttu-id="cff0a-290">新的安全更新是如果 （即使它面向早期版本），在.NET Framework 4.7 和更高版本上运行你的应用程序很重要。</span><span class="sxs-lookup"><span data-stu-id="cff0a-290">Recent security updates are important if your app runs on .NET Framework 4.7 and later versions (even if it targets an earlier version).</span></span>

<span data-ttu-id="cff0a-291">若要更新.NET 框架，以允许操作系统选择 TLS，才能使用的最佳版本，你必须安装至少：</span><span class="sxs-lookup"><span data-stu-id="cff0a-291">To update the .NET Framework to allow the operating system to choose the best version of TLS to use, you must install at least:</span></span>

- <span data-ttu-id="cff0a-292">[质量汇总的.NET Framework 自 2017 年 8 月预览版](https://blogs.msdn.microsoft.com/dotnet/2017/08/16/net-framework-august-2017-preview-of-quality-rollup)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-292">The [.NET Framework August 2017 Preview of Quality Rollup](https://blogs.msdn.microsoft.com/dotnet/2017/08/16/net-framework-august-2017-preview-of-quality-rollup).</span></span>
- <span data-ttu-id="cff0a-293">**或者** [.NET Framework 自 2017 年 9 月安全性和质量汇总](https://blogs.msdn.microsoft.com/dotnet/2017/09/12/net-framework-september-2017-security-and-quality-rollup)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-293">**Or** the [.NET Framework September 2017 Security and Quality Rollup](https://blogs.msdn.microsoft.com/dotnet/2017/09/12/net-framework-september-2017-security-and-quality-rollup).</span></span>

<span data-ttu-id="cff0a-294">另请参阅：</span><span class="sxs-lookup"><span data-stu-id="cff0a-294">See also:</span></span>

- [<span data-ttu-id="cff0a-295">.NET framework 版本和依赖关系</span><span class="sxs-lookup"><span data-stu-id="cff0a-295">.NET Framework Versions and Dependencies</span></span>](../migration-guide/versions-and-dependencies.md)
- <span data-ttu-id="cff0a-296">[如何： 确定安装了哪些.NET Framework 版本](../migration-guide/how-to-determine-which-versions-are-installed.md)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-296">[How to: Determine Which .NET Framework Versions Are Installed](../migration-guide/how-to-determine-which-versions-are-installed.md).</span></span>

## <a name="support-for-tls-12"></a><span data-ttu-id="cff0a-297">对 TLS 1.2 的支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-297">Support for TLS 1.2</span></span>

<span data-ttu-id="cff0a-298">协商 TLS 1.2、 操作系统和.NET Framework 版本应用程序均需支持 TLS 1.2。</span><span class="sxs-lookup"><span data-stu-id="cff0a-298">For your app to negotiate TLS 1.2, the OS and the .NET Framework version both need to support TLS 1.2.</span></span>

<span data-ttu-id="cff0a-299">**为支持 TLS 1.2 的操作系统要求**</span><span class="sxs-lookup"><span data-stu-id="cff0a-299">**Operating system requirements to support TLS 1.2**</span></span>

<span data-ttu-id="cff0a-300">若要启用或重新启用 TLS 1.2 和/或 TLS 1.1 支持它们的系统上，请参阅[传输层安全 (TLS) 注册表设置](/windows-server/security/tls/tls-registry-settings)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-300">To enable or re-enable TLS 1.2 and/or TLS 1.1 on a system that supports them, see [Transport Layer Security (TLS) registry settings](/windows-server/security/tls/tls-registry-settings).</span></span>

| <span data-ttu-id="cff0a-301">**OS**</span><span class="sxs-lookup"><span data-stu-id="cff0a-301">**OS**</span></span> | <span data-ttu-id="cff0a-302">**TLS 1.2 支持**</span><span class="sxs-lookup"><span data-stu-id="cff0a-302">**TLS 1.2 support**</span></span> |
| --- | --- |
| <span data-ttu-id="cff0a-303">Windows 10</span><span class="sxs-lookup"><span data-stu-id="cff0a-303">Windows 10</span></span></br><span data-ttu-id="cff0a-304">Windows 2016 Server</span><span class="sxs-lookup"><span data-stu-id="cff0a-304">Windows Server 2016</span></span> | <span data-ttu-id="cff0a-305">受支持，并且默认情况下启用。</span><span class="sxs-lookup"><span data-stu-id="cff0a-305">Supported, and enabled by default.</span></span> |
| <span data-ttu-id="cff0a-306">Windows 8.1</span><span class="sxs-lookup"><span data-stu-id="cff0a-306">Windows 8.1</span></span></br><span data-ttu-id="cff0a-307">Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="cff0a-307">Windows Server 2012 R2</span></span> | <span data-ttu-id="cff0a-308">受支持，并且默认情况下启用。</span><span class="sxs-lookup"><span data-stu-id="cff0a-308">Supported, and enabled by default.</span></span> |
| <span data-ttu-id="cff0a-309">Windows 8.0</span><span class="sxs-lookup"><span data-stu-id="cff0a-309">Windows 8.0</span></span></br><span data-ttu-id="cff0a-310">Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="cff0a-310">Windows Server 2012</span></span> | <span data-ttu-id="cff0a-311">受支持，并且默认情况下启用。</span><span class="sxs-lookup"><span data-stu-id="cff0a-311">Supported, and enabled by default.</span></span> |
| <span data-ttu-id="cff0a-312">Windows 7 SP1</span><span class="sxs-lookup"><span data-stu-id="cff0a-312">Windows 7 SP1</span></span></br><span data-ttu-id="cff0a-313">Windows Server 2008 R2 SP1</span><span class="sxs-lookup"><span data-stu-id="cff0a-313">Windows Server 2008 R2 SP1</span></span> | <span data-ttu-id="cff0a-314">支持，但默认情况下未启用。</span><span class="sxs-lookup"><span data-stu-id="cff0a-314">Supported, but not enabled by default.</span></span> <span data-ttu-id="cff0a-315">请参阅[传输层安全 (TLS) 注册表设置](/windows-server/security/tls/tls-registry-settings)有关如何启用 TLS 1.2 的详细信息的网页。</span><span class="sxs-lookup"><span data-stu-id="cff0a-315">See the [Transport Layer Security (TLS) registry settings](/windows-server/security/tls/tls-registry-settings) web page for details on how to enable TLS 1.2.</span></span> |
| <span data-ttu-id="cff0a-316">Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="cff0a-316">Windows Server 2008</span></span> | <span data-ttu-id="cff0a-317">支持 TLS 1.2 和 TLS 1.1 需要更新。</span><span class="sxs-lookup"><span data-stu-id="cff0a-317">Support for TLS 1.2 and TLS 1.1 requires an update.</span></span> <span data-ttu-id="cff0a-318">请参阅[更新，以在 Windows Server 2008 SP2 添加对 TLS 1.1 和 TLS 1.2 支持](https://support.microsoft.com/help/4019276/update-to-add-support-for-tls-1-1-and-tls-1-2-in-windows-server-2008-s)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-318">See [Update to add support for TLS 1.1 and TLS 1.2 in Windows Server 2008 SP2](https://support.microsoft.com/help/4019276/update-to-add-support-for-tls-1-1-and-tls-1-2-in-windows-server-2008-s).</span></span> |
| <span data-ttu-id="cff0a-319">Windows Vista</span><span class="sxs-lookup"><span data-stu-id="cff0a-319">Windows Vista</span></span> | <span data-ttu-id="cff0a-320">不支持。</span><span class="sxs-lookup"><span data-stu-id="cff0a-320">Not supported.</span></span> |

<span data-ttu-id="cff0a-321">有关哪些 TLS/SSL 协议启用默认情况下，每个版本的 Windows 上的信息，请参阅[中 TLS/SSL (Schannel SSP) 的协议](https://msdn.microsoft.com/library/windows/desktop/mt808159)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-321">For information about which TLS/SSL protocols are enabled by default on each version of Windows, see [Protocols in TLS/SSL (Schannel SSP)](https://msdn.microsoft.com/library/windows/desktop/mt808159).</span></span>

<span data-ttu-id="cff0a-322">**使用.NET Framework 3.5 的支持 TLS 1.2 的要求**</span><span class="sxs-lookup"><span data-stu-id="cff0a-322">**Requirements to support TLS 1.2 with .NET Framework 3.5**</span></span>

<span data-ttu-id="cff0a-323">下表显示 OS 更新，你将需要支持使用.NET Framework 3.5 的 TLS 1.2。</span><span class="sxs-lookup"><span data-stu-id="cff0a-323">This table shows the OS update you'll need to support TLS 1.2 with .NET Framework 3.5.</span></span> <span data-ttu-id="cff0a-324">我们建议你将所有操作系统更新都应用。</span><span class="sxs-lookup"><span data-stu-id="cff0a-324">We recommend you apply all OS updates.</span></span>

| <span data-ttu-id="cff0a-325">**OS**</span><span class="sxs-lookup"><span data-stu-id="cff0a-325">**OS**</span></span> | <span data-ttu-id="cff0a-326">**支持使用.NET Framework 3.5 的 TLS 1.2 所需的最低更新**</span><span class="sxs-lookup"><span data-stu-id="cff0a-326">**Minimum update needed to support TLS 1.2 with .NET Framework 3.5**</span></span> |
| --- | --- |
| <span data-ttu-id="cff0a-327">Windows 10</span><span class="sxs-lookup"><span data-stu-id="cff0a-327">Windows 10</span></span></br><span data-ttu-id="cff0a-328">Windows 2016 Server</span><span class="sxs-lookup"><span data-stu-id="cff0a-328">Windows Server 2016</span></span> | [<span data-ttu-id="cff0a-329">为 Windows 10 版本 1511年的累积更新和 Windows Server 2016 Technical Preview 4: 2016 年 5 月 10，</span><span class="sxs-lookup"><span data-stu-id="cff0a-329">Cumulative Update for Windows 10 Version 1511 and Windows Server 2016 Technical Preview 4: May 10, 2016</span></span>](https://support.microsoft.com/help/3156421/cumulative-update-for-windows-10-version-1511-and-windows-server-2016) |
| <span data-ttu-id="cff0a-330">Windows 8.1</span><span class="sxs-lookup"><span data-stu-id="cff0a-330">Windows 8.1</span></span></br><span data-ttu-id="cff0a-331">Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="cff0a-331">Windows Server 2012 R2</span></span> | [<span data-ttu-id="cff0a-332">对 TLS 系统默认版本包括在 Windows 8.1 和 Windows Server 2012 R2 上的.NET Framework 3.5 的支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-332">Support for TLS System Default Versions included in the .NET Framework 3.5 on Windows 8.1 and Windows Server 2012 R2</span></span>](https://support.microsoft.com/help/3154520/support-for-tls-system-default-versions-included-in-the--net-framework) |
| <span data-ttu-id="cff0a-333">Windows 8.0</span><span class="sxs-lookup"><span data-stu-id="cff0a-333">Windows 8.0</span></span></br><span data-ttu-id="cff0a-334">Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="cff0a-334">Windows Server 2012</span></span> | [<span data-ttu-id="cff0a-335">对 TLS 系统默认版本包括在 Windows Server 2012 上的.NET Framework 3.5 的支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-335">Support for TLS System Default Versions included in the .NET Framework 3.5 on Windows Server 2012</span></span>](https://support.microsoft.com/help/3154519/support-for-tls-system-default-versions-included-in-the--net-framework) |
| <span data-ttu-id="cff0a-336">Windows 7 SP1</span><span class="sxs-lookup"><span data-stu-id="cff0a-336">Windows 7 SP1</span></span></br><span data-ttu-id="cff0a-337">Windows Server 2008 R2 SP1</span><span class="sxs-lookup"><span data-stu-id="cff0a-337">Windows Server 2008 R2 SP1</span></span> | [<span data-ttu-id="cff0a-338">对 TLS 系统默认版本包含在.NET Framework 3.5.1 在 Windows 7 SP1 和 Server 2008 R2 SP1 的支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-338">Support for TLS System Default Versions included in the .NET Framework 3.5.1 on Windows 7 SP1 and Server 2008 R2 SP1</span></span>](https://support.microsoft.com/help/3154518/support-for-tls-system-default-versions-included-in-the--net-framework) |
| <span data-ttu-id="cff0a-339">Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="cff0a-339">Windows Server 2008</span></span> | [<span data-ttu-id="cff0a-340">对 TLS 系统默认版本包含在.NET Framework 2.0 SP2 在 Windows Vista SP2 和 Server 2008 SP2 上的支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-340">Support for TLS System Default Versions included in the .NET Framework 2.0 SP2 on Windows Vista SP2 and Server 2008 SP2</span></span>](https://support.microsoft.com/help/3154517/support-for-tls-system-default-versions-included-in-the--net-framework) |
| <span data-ttu-id="cff0a-341">Windows Vista</span><span class="sxs-lookup"><span data-stu-id="cff0a-341">Windows Vista</span></span> | <span data-ttu-id="cff0a-342">不支持</span><span class="sxs-lookup"><span data-stu-id="cff0a-342">Not supported</span></span> |

## <a name="azure-cloud-services"></a><span data-ttu-id="cff0a-343">Azure 云服务</span><span class="sxs-lookup"><span data-stu-id="cff0a-343">Azure Cloud Services</span></span>

<span data-ttu-id="cff0a-344">如果你使用[Azure 云服务](https://azure.microsoft.com/services/cloud-services/)Web 和辅助角色承载和运行你的应用程序，有一些注意事项需要考虑到支持 TLS 1.2。</span><span class="sxs-lookup"><span data-stu-id="cff0a-344">If you are using [Azure Cloud Services](https://azure.microsoft.com/services/cloud-services/) Web and Worker roles to host and run your application, there are some considerations that you need to take into account to support TLS 1.2.</span></span>

### <a name="net-framework-47-is-not-installed-on-azure-guest-os-by-default"></a><span data-ttu-id="cff0a-345">.NET framework 4.7 默认情况下未安装在 Azure 来宾 OS</span><span class="sxs-lookup"><span data-stu-id="cff0a-345">.NET Framework 4.7 is not installed on Azure Guest OS by default</span></span>

<span data-ttu-id="cff0a-346">安装最新的 Azure 来宾 OS 系列 5 版本 (Windows Server 2016) 中的最新版本是 4.6.2。</span><span class="sxs-lookup"><span data-stu-id="cff0a-346">The latest version installed in the latest Azure Guest OS Family 5 release (Windows Server 2016) is 4.6.2.</span></span> <span data-ttu-id="cff0a-347">若要查看每个 Azure 来宾操作系统上安装的.NET Framework 的版本，请参阅[Azure 来宾 OS 版本和 SDK 兼容性矩阵](https://docs.microsoft.com/azure/cloud-services/cloud-services-guestos-update-matrix)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-347">To see which versions of .NET Framework are installed on each Azure Guest OS, see the [Azure Guest OS releases and SDK compatibility matrix](https://docs.microsoft.com/azure/cloud-services/cloud-services-guestos-update-matrix).</span></span>

<span data-ttu-id="cff0a-348">如果你的应用面向在 Azure 来宾操作系统版本不可用的.NET Framework 版本，然后你需要自行安装。</span><span class="sxs-lookup"><span data-stu-id="cff0a-348">If your app targets a .NET Framework version that is not available on the Azure Guest OS version, then you need to install it yourself.</span></span> <span data-ttu-id="cff0a-349">请参阅[在 Azure 云服务角色上安装.NET](https://docs.microsoft.com/azure/cloud-services/cloud-services-dotnet-install-dotnet)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-349">See [Install .NET on Azure Cloud Service Roles](https://docs.microsoft.com/azure/cloud-services/cloud-services-dotnet-install-dotnet).</span></span> <span data-ttu-id="cff0a-350">如果 framework 安装需要重新启动，则服务角色可能也在进入就绪状态之前重新启动。</span><span class="sxs-lookup"><span data-stu-id="cff0a-350">If the framework installation requires a restart, the service roles might also restart before entering the Ready state.</span></span>

### <a name="azure-guest-os-registry-settings"></a><span data-ttu-id="cff0a-351">Azure 来宾 OS 注册表设置</span><span class="sxs-lookup"><span data-stu-id="cff0a-351">Azure Guest OS registry settings</span></span>

<span data-ttu-id="cff0a-352">Azure 来宾操作系统映像以便[Azure 云服务](https://azure.microsoft.com/services/cloud-services/)已`SchUseStrongCrypto`注册表项设置为 1 的值。</span><span class="sxs-lookup"><span data-stu-id="cff0a-352">The Azure Guest OS image for [Azure Cloud Services](https://azure.microsoft.com/services/cloud-services/) already has the `SchUseStrongCrypto` registry key set to a value of 1.</span></span> <span data-ttu-id="cff0a-353">有关详细信息，请参阅[SchUseStrongCrypto](#schusestrongcrypto)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-353">For more information, see [SchUseStrongCrypto](#schusestrongcrypto).</span></span>

<span data-ttu-id="cff0a-354">设置[SystemDefaultTlsVersions](#systemdefaulttlsversions)注册表项设置为 1。</span><span class="sxs-lookup"><span data-stu-id="cff0a-354">Set the [SystemDefaultTlsVersions](#systemdefaulttlsversions) registry key to 1.</span></span> <span data-ttu-id="cff0a-355">请参阅[配置通过 Windows 注册表安全性](#configuring-security-via-the-windows-registry)。</span><span class="sxs-lookup"><span data-stu-id="cff0a-355">See [Configuring security via the Windows Registry](#configuring-security-via-the-windows-registry).</span></span>
