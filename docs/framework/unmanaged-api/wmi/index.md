---
title: WMI 和性能计数器 （非托管 API 参考）
description: 总结了.NET Framework WMI 和性能计数器信息的非托管 API。
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.date: 11/06/2017
ms.topic: reference
ms.prod: .net-framework
ms.devlang: cpp
ms.workload:
- dotnet
ms.openlocfilehash: c7959d6b6b7bafd728db5a579ff1376e686c5b74
ms.sourcegitcommit: d2da0142247ef42a219a5d2907f153e62dc6ea0d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/01/2018
---
# <a name="windows-management-instrumentation-wmi-and-performance-counters-unmanaged-api-reference"></a><span data-ttu-id="00319-103">Windows Management Instrumentation (WMI) 和性能计数器 （非托管 API 参考）</span><span class="sxs-lookup"><span data-stu-id="00319-103">Windows Management Instrumentation (WMI) and Performance Counters (Unmanaged API Reference)</span></span>

<span data-ttu-id="00319-104">.NET Framework WMI 和性能计数器的非托管的 API 包含一组包装对的调用的函数[本机 Windows Management Instrumentation API](https://msdn.microsoft.com/library/aa389276(v=vs.85).aspx)。</span><span class="sxs-lookup"><span data-stu-id="00319-104">The .NET Framework WMI and Performance Counters unmanaged API consists of a set of functions that wrap calls to the [native Windows Management Instrumentation API](https://msdn.microsoft.com/library/aa389276(v=vs.85).aspx).</span></span> <span data-ttu-id="00319-105">它允许你开发工具和库的管理和监视远程计算机系统。</span><span class="sxs-lookup"><span data-stu-id="00319-105">It allows you to develop tools and libraries that manage and monitor remote computer systems.</span></span>

[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]
  
<span data-ttu-id="00319-106">该 API 包括以下功能：</span><span class="sxs-lookup"><span data-stu-id="00319-106">The API includes the following functions:</span></span>

| <span data-ttu-id="00319-107">函数</span><span class="sxs-lookup"><span data-stu-id="00319-107">Function</span></span> | <span data-ttu-id="00319-108">描述</span><span class="sxs-lookup"><span data-stu-id="00319-108">Description</span></span> |
|---------|---------|
| [<span data-ttu-id="00319-109">BeginEnumeration 函数</span><span class="sxs-lookup"><span data-stu-id="00319-109">BeginEnumeration function</span></span>](beginenumeration.md) | <span data-ttu-id="00319-110">将枚举数重置到开头的 WMI 对象属性的枚举。</span><span class="sxs-lookup"><span data-stu-id="00319-110">Resets the enumerator to the beginning of an enumeration of WMI object properties.</span></span> |
| [<span data-ttu-id="00319-111">BeginMethodEnumeration 函数</span><span class="sxs-lookup"><span data-stu-id="00319-111">BeginMethodEnumeration function</span></span>](beginmethodenumeration.md) |  <span data-ttu-id="00319-112">开始为对象提供的方法的枚举。</span><span class="sxs-lookup"><span data-stu-id="00319-112">Begins an enumeration of the methods available for an object.</span></span> |
| [<span data-ttu-id="00319-113">BlessIWbemServices 函数</span><span class="sxs-lookup"><span data-stu-id="00319-113">BlessIWbemServices function</span></span>](blessiwbemservices.md) | <span data-ttu-id="00319-114">指示用户凭据是否允许访问指定的 IWbemServices 类。</span><span class="sxs-lookup"><span data-stu-id="00319-114">Indicates whether the user credentials permit access to a specified IWbemServices class.</span></span> |
| [<span data-ttu-id="00319-115">BlessIWbemServicesObject 函数</span><span class="sxs-lookup"><span data-stu-id="00319-115">BlessIWbemServicesObject function</span></span>](blessiwbemservicesobject.md) | <span data-ttu-id="00319-116">指示用户凭据是否允许与指定的 IWbem 服务对象的访问。</span><span class="sxs-lookup"><span data-stu-id="00319-116">Indicates whether the user credentials permit access to a specified IWbem service object.</span></span> |
| [<span data-ttu-id="00319-117">Clone 函数</span><span class="sxs-lookup"><span data-stu-id="00319-117">Clone function</span></span>](clone.md) | <span data-ttu-id="00319-118">返回是当前对象的完整克隆一个新对象。</span><span class="sxs-lookup"><span data-stu-id="00319-118">Returns a new object that is a complete clone of the current object.</span></span> |
| [<span data-ttu-id="00319-119">CloneEnumWbemClassObject 函数</span><span class="sxs-lookup"><span data-stu-id="00319-119">CloneEnumWbemClassObject function</span></span>](cloneenumwbemclassobject.md) | <span data-ttu-id="00319-120">生成的枚举，保留当前位置枚举中的逻辑副本。</span><span class="sxs-lookup"><span data-stu-id="00319-120">Makes a logical copy of an enumerator, retaining its current position in an enumeration.</span></span> |
| [<span data-ttu-id="00319-121">CompareTo 函数</span><span class="sxs-lookup"><span data-stu-id="00319-121">CompareTo function</span></span>](compareto.md) | <span data-ttu-id="00319-122">比较对象和另一个 Windows 管理对象。</span><span class="sxs-lookup"><span data-stu-id="00319-122">Compares an object to another Windows management object.</span></span> |
| [<span data-ttu-id="00319-123">ConnectServerWmi 函数</span><span class="sxs-lookup"><span data-stu-id="00319-123">ConnectServerWmi function</span></span>](connectserverwmi.md) | <span data-ttu-id="00319-124">指定计算机上创建的 WMI 命名空间通过 DCOM 的连接。</span><span class="sxs-lookup"><span data-stu-id="00319-124">Creates a connection through DCOM to a WMI namespace on a specified computer.</span></span> |
| [<span data-ttu-id="00319-125">CreateClassEnumWmi 函数</span><span class="sxs-lookup"><span data-stu-id="00319-125">CreateClassEnumWmi function</span></span>](createclassenumwmi.md) | <span data-ttu-id="00319-126">返回满足指定的选择条件的所有类的枚举数。</span><span class="sxs-lookup"><span data-stu-id="00319-126">Returns an enumerator for all classes that satisfy the specified selection criteria.</span></span> |
| [<span data-ttu-id="00319-127">CreateInstanceEnumWmi 函数</span><span class="sxs-lookup"><span data-stu-id="00319-127">CreateInstanceEnumWmi function</span></span>](createinstanceenumwmi.md) | <span data-ttu-id="00319-128">返回一个枚举器返回满足指定的选择条件指定类的实例。</span><span class="sxs-lookup"><span data-stu-id="00319-128">Returns an enumerator that returns the intances of a specified class that meet specified selection criteria.</span></span> |
| [<span data-ttu-id="00319-129">Delete 函数</span><span class="sxs-lookup"><span data-stu-id="00319-129">Delete function</span></span>](delete.md) | <span data-ttu-id="00319-130">从类定义和所有其限定符中删除指定的属性。</span><span class="sxs-lookup"><span data-stu-id="00319-130">Deletes a specified property from a class definition and all of its qualifiers.</span></span> |
| [<span data-ttu-id="00319-131">DeleteMethod 函数</span><span class="sxs-lookup"><span data-stu-id="00319-131">DeleteMethod function</span></span>](deletemethod.md) | <span data-ttu-id="00319-132">从 CIM 类定义中删除指定的方法。</span><span class="sxs-lookup"><span data-stu-id="00319-132">Deletes a specified method from a CIM class definition.</span></span> |
| [<span data-ttu-id="00319-133">EndEnumeration 函数</span><span class="sxs-lookup"><span data-stu-id="00319-133">EndEnumeration function</span></span>](endenumeration.md) | <span data-ttu-id="00319-134">终止枚举序列。</span><span class="sxs-lookup"><span data-stu-id="00319-134">Terminates an enumeration sequence.</span></span> | 
| [<span data-ttu-id="00319-135">EndMethodEnumeration 函数</span><span class="sxs-lookup"><span data-stu-id="00319-135">EndMethodEnumeration function</span></span>](endmethodenumeration.md) | <span data-ttu-id="00319-136">终止通过调用启动枚举序列[BeginMethodEnumeration 函数](beginmethodenumeration.md)。</span><span class="sxs-lookup"><span data-stu-id="00319-136">Terminates an enumeration sequence started by calling the  [BeginMethodEnumeration function](beginmethodenumeration.md).</span></span> |
| [<span data-ttu-id="00319-137">ExecNotificationQueryWmi 函数</span><span class="sxs-lookup"><span data-stu-id="00319-137">ExecNotificationQueryWmi function</span></span>](execnotificationquerywmi.md) | <span data-ttu-id="00319-138">执行查询以接收事件。</span><span class="sxs-lookup"><span data-stu-id="00319-138">Executes a query to receive events.</span></span> |
| [<span data-ttu-id="00319-139">ExecQueryWmi 函数</span><span class="sxs-lookup"><span data-stu-id="00319-139">ExecQueryWmi function</span></span>](execquerywmi.md) | <span data-ttu-id="00319-140">执行查询以检索对象。</span><span class="sxs-lookup"><span data-stu-id="00319-140">Executes a query to retrieve objects.</span></span> |
| [<span data-ttu-id="00319-141">FormatFromRawValue 函数</span><span class="sxs-lookup"><span data-stu-id="00319-141">FormatFromRawValue function</span></span>](formatfromrawvalue.md) | <span data-ttu-id="00319-142">基于时间的格式转换是否将转换为指定的格式中，一个原始性能数据值或两个原始性能数据值。</span><span class="sxs-lookup"><span data-stu-id="00319-142">Converts one raw performance data value to the specified format, or two raw performance data values if the format conversion is time-based.</span></span> | 
| [<span data-ttu-id="00319-143">Get 函数</span><span class="sxs-lookup"><span data-stu-id="00319-143">Get function</span></span>](get.md) | <span data-ttu-id="00319-144">如果它存在，请检索指定的属性值。</span><span class="sxs-lookup"><span data-stu-id="00319-144">Retrieves a specified property value if it exists.</span></span> |
| [<span data-ttu-id="00319-145">GetCurrentApartmentType function</span><span class="sxs-lookup"><span data-stu-id="00319-145">GetCurrentApartmentType function</span></span>](getcurrentapartmenttype.md) | <span data-ttu-id="00319-146">检索在其中执行调用方的单元的类型。</span><span class="sxs-lookup"><span data-stu-id="00319-146">Retrieves the type of apartment in which the caller is executing.</span></span> |
| [<span data-ttu-id="00319-147">GetDemultiplexedStub 函数</span><span class="sxs-lookup"><span data-stu-id="00319-147">GetDemultiplexedStub function</span></span>](getdemultiplexedstub.md) | <span data-ttu-id="00319-148">创建的对象转发器接收器，以帮助客户端在从 Windows 管理接收异步调用。</span><span class="sxs-lookup"><span data-stu-id="00319-148">Creates an object forwarder sink to assist a client in receiving asynchronous calls from Windows Management.</span></span> |
| [<span data-ttu-id="00319-149">GetErrorInfo 函数</span><span class="sxs-lookup"><span data-stu-id="00319-149">GetErrorInfo function</span></span>](geterrorinfo.md) | <span data-ttu-id="00319-150">从以前的函数调用中检索错误信息。</span><span class="sxs-lookup"><span data-stu-id="00319-150">Retrieves error information from the previous function call.</span></span> | 
| [<span data-ttu-id="00319-151">GetMethod 函数</span><span class="sxs-lookup"><span data-stu-id="00319-151">GetMethod function</span></span>](getmethod.md) | <span data-ttu-id="00319-152">检索有关指定方法的信息。</span><span class="sxs-lookup"><span data-stu-id="00319-152">Retrieves information about the specified method.</span></span> | 
| [<span data-ttu-id="00319-153">GetMethodOrigin 函数</span><span class="sxs-lookup"><span data-stu-id="00319-153">GetMethodOrigin function</span></span>](getmethodorigin.md) | <span data-ttu-id="00319-154">确定在其中声明了方法的类。</span><span class="sxs-lookup"><span data-stu-id="00319-154">Determines the class in which a method is declared.</span></span> |
| [<span data-ttu-id="00319-155">GetMethodQualifierSet 函数</span><span class="sxs-lookup"><span data-stu-id="00319-155">GetMethodQualifierSet function</span></span>](getmethodqualifierset.md) | <span data-ttu-id="00319-156">检索为特定方法设置的限定符。</span><span class="sxs-lookup"><span data-stu-id="00319-156">Retrieves the qualifier set for a particular method.</span></span> |
| [<span data-ttu-id="00319-157">GetNames 函数</span><span class="sxs-lookup"><span data-stu-id="00319-157">GetNames function</span></span>](getnames.md) | <span data-ttu-id="00319-158">检索的子集或所有对象的属性的名称。</span><span class="sxs-lookup"><span data-stu-id="00319-158">Retrieves either a subset or all of the names of the properties of an object.</span></span> |
| [<span data-ttu-id="00319-159">GetObjectText 函数</span><span class="sxs-lookup"><span data-stu-id="00319-159">GetObjectText function</span></span>](getobjecttext.md) | <span data-ttu-id="00319-160">用 MOF 语法返回对象的文本呈现。</span><span class="sxs-lookup"><span data-stu-id="00319-160">Returns a textual rendering of an object in the MOF syntax.</span></span> | 
| [<span data-ttu-id="00319-161">GetPropertyHandle 函数</span><span class="sxs-lookup"><span data-stu-id="00319-161">GetPropertyHandle function</span></span>](getpropertyhandle.md) | <span data-ttu-id="00319-162">返回一个唯一的句柄，标识属性。</span><span class="sxs-lookup"><span data-stu-id="00319-162">Returns a unique handle that identifies a property.</span></span> |
| [<span data-ttu-id="00319-163">GetPropertyOrigin 函数</span><span class="sxs-lookup"><span data-stu-id="00319-163">GetPropertyOrigin function</span></span>](getpropertyorigin.md) | <span data-ttu-id="00319-164">确定所声明的属性的类。</span><span class="sxs-lookup"><span data-stu-id="00319-164">Determines the class in which a property is declared.</span></span> |
| [<span data-ttu-id="00319-165">GetPropertyQualifierSet function</span><span class="sxs-lookup"><span data-stu-id="00319-165">GetPropertyQualifierSet function</span></span>](getpropertyqualifierset.md) | <span data-ttu-id="00319-166">检索为特定的属性设置的限定符。</span><span class="sxs-lookup"><span data-stu-id="00319-166">Retrieves the qualifier set for a particular property.</span></span>  |
| [<span data-ttu-id="00319-167">GetQualifierSet 函数</span><span class="sxs-lookup"><span data-stu-id="00319-167">GetQualifierSet function</span></span>](getqualifierset.md) | <span data-ttu-id="00319-168">检索为的类实例或类定义设置的限定符。</span><span class="sxs-lookup"><span data-stu-id="00319-168">Retrieves the qualifier set for a class instance or a class definition.</span></span> |
| [<span data-ttu-id="00319-169">InheritsFrom 函数</span><span class="sxs-lookup"><span data-stu-id="00319-169">InheritsFrom function</span></span>](inheritsfrom.md) | <span data-ttu-id="00319-170">确定当前类或实例派生自指定的父类别。</span><span class="sxs-lookup"><span data-stu-id="00319-170">Determines whether the current class or instance derives from a specified parent class.</span></span> |
| [<span data-ttu-id="00319-171">Initialize 函数</span><span class="sxs-lookup"><span data-stu-id="00319-171">Initialize function</span></span>](initialize.md) | <span data-ttu-id="00319-172">执行 WMI 初始化。</span><span class="sxs-lookup"><span data-stu-id="00319-172">Performs WMI initialization.</span></span> |
| [<span data-ttu-id="00319-173">下一步函数</span><span class="sxs-lookup"><span data-stu-id="00319-173">Next function</span></span>](next.md) | <span data-ttu-id="00319-174">检索一个枚举中的下一步属性。</span><span class="sxs-lookup"><span data-stu-id="00319-174">Retrieves the next property in an enumeration.</span></span> | 
| [<span data-ttu-id="00319-175">NextMethod 函数</span><span class="sxs-lookup"><span data-stu-id="00319-175">NextMethod function</span></span>](nextmethod.md) | <span data-ttu-id="00319-176">检索枚举中的下一步方法。</span><span class="sxs-lookup"><span data-stu-id="00319-176">Retrieves the next method in an enumeration.</span></span> |
| [<span data-ttu-id="00319-177">Put 的函数</span><span class="sxs-lookup"><span data-stu-id="00319-177">Put function</span></span>](put.md) | <span data-ttu-id="00319-178">将指定的属性设置为新值。</span><span class="sxs-lookup"><span data-stu-id="00319-178">Sets a named property to a new value.</span></span> |
| [<span data-ttu-id="00319-179">PutClassWmi 函数</span><span class="sxs-lookup"><span data-stu-id="00319-179">PutClassWmi function</span></span>](putclasswmi.md) | <span data-ttu-id="00319-180">创建新的类或更新现有。</span><span class="sxs-lookup"><span data-stu-id="00319-180">Creates a new class or updates an existing one.</span></span> |
| [<span data-ttu-id="00319-181">PutInstanceWmi 函数</span><span class="sxs-lookup"><span data-stu-id="00319-181">PutInstanceWmi function</span></span>](putinstancewmi.md) | <span data-ttu-id="00319-182">创建或更新现有类的实例。</span><span class="sxs-lookup"><span data-stu-id="00319-182">Creates or updates an instance of an existing class.</span></span> <span data-ttu-id="00319-183">实例将写入 WMI 存储库。</span><span class="sxs-lookup"><span data-stu-id="00319-183">The instance is written to the WMI repository.</span></span> |
| [<span data-ttu-id="00319-184">PutMethod 函数</span><span class="sxs-lookup"><span data-stu-id="00319-184">PutMethod function</span></span>](putmethod.md) | <span data-ttu-id="00319-185">创建一个方法。</span><span class="sxs-lookup"><span data-stu-id="00319-185">Creates a method.</span></span> |
| [<span data-ttu-id="00319-186">QualifierSet_BeginEnumeration function</span><span class="sxs-lookup"><span data-stu-id="00319-186">QualifierSet_BeginEnumeration function</span></span>](qualifierset-beginenumeration.md) | <span data-ttu-id="00319-187">将枚举数对象的限定符重置为枚举的开头。</span><span class="sxs-lookup"><span data-stu-id="00319-187">Resets an enumerator of the qualifiers of an object to the beginning of the enumeration.</span></span> |
| [<span data-ttu-id="00319-188">QualifierSet_Delete 函数</span><span class="sxs-lookup"><span data-stu-id="00319-188">QualifierSet_Delete function</span></span>](qualifierset-delete.md) | <span data-ttu-id="00319-189">按名称删除指定的限定符。</span><span class="sxs-lookup"><span data-stu-id="00319-189">Deletes a specified qualifier by name.</span></span>  |
| [<span data-ttu-id="00319-190">QualifierSet_EndEnumeration function</span><span class="sxs-lookup"><span data-stu-id="00319-190">QualifierSet_EndEnumeration function</span></span>](qualifierset-endenumeration.md) | <span data-ttu-id="00319-191">终止通过调用开始枚举`QualifierSet_BeginEnumeration`函数。</span><span class="sxs-lookup"><span data-stu-id="00319-191">Terminates the enumeration begun with a call to the `QualifierSet_BeginEnumeration` function.</span></span> |
| [<span data-ttu-id="00319-192">QualifierSet_Get 函数</span><span class="sxs-lookup"><span data-stu-id="00319-192">QualifierSet_Get function</span></span>](qualifierset-get.md) | <span data-ttu-id="00319-193">获取指定的命名的限定符。</span><span class="sxs-lookup"><span data-stu-id="00319-193">Gets the specified named qualifier.</span></span>  |
| [<span data-ttu-id="00319-194">QualifierSet_GetNames function</span><span class="sxs-lookup"><span data-stu-id="00319-194">QualifierSet_GetNames function</span></span>](qualifierset-getnames.md) | <span data-ttu-id="00319-195">检索所有的限定符或指定限定符可从当前对象或属性的名称。</span><span class="sxs-lookup"><span data-stu-id="00319-195">Retrieves the names of all qualifiers or of specified qualifiers that are available from the current object or property.</span></span> |
| [<span data-ttu-id="00319-196">QualifierSet_Next function</span><span class="sxs-lookup"><span data-stu-id="00319-196">QualifierSet_Next function</span></span>](qualifierset-next.md) | <span data-ttu-id="00319-197">检索一个枚举，通过调用启动中的下一步限定符[QualifierSet_BeginEnumeration](qualifierset-beginenumeration.md)函数。</span><span class="sxs-lookup"><span data-stu-id="00319-197">Retrieves the next qualifier in an enumeration that started with a call to the [QualifierSet_BeginEnumeration](qualifierset-beginenumeration.md) function.</span></span> |
| [<span data-ttu-id="00319-198">QualifierSet_Put function</span><span class="sxs-lookup"><span data-stu-id="00319-198">QualifierSet_Put function</span></span>](qualifierset-put.md) | <span data-ttu-id="00319-199">写入命名的限定符和值。</span><span class="sxs-lookup"><span data-stu-id="00319-199">Writes the named qualifier and value.</span></span> |
| [<span data-ttu-id="00319-200">ResetSecurity 函数</span><span class="sxs-lookup"><span data-stu-id="00319-200">ResetSecurity function</span></span>](resetsecurity.md) | <span data-ttu-id="00319-201">将提供的模拟令牌分配给当前线程。</span><span class="sxs-lookup"><span data-stu-id="00319-201">Assigns the supplied impersonation token to the current thread.</span></span> |
| [<span data-ttu-id="00319-202">SetSecurity 函数</span><span class="sxs-lookup"><span data-stu-id="00319-202">SetSecurity function</span></span>](setsecurity.md) | <span data-ttu-id="00319-203">检索与当前线程关联的模拟令牌。</span><span class="sxs-lookup"><span data-stu-id="00319-203">Retrieves the impersonation token associated with the current thread.</span></span> |
| [<span data-ttu-id="00319-204">SpawnDerivedClass 函数</span><span class="sxs-lookup"><span data-stu-id="00319-204">SpawnDerivedClass function</span></span>](spawnderivedclass.md) | <span data-ttu-id="00319-205">从指定的对象创建新派生的类对象。</span><span class="sxs-lookup"><span data-stu-id="00319-205">Creates a newly derived class object from a specified object.</span></span> | 
| [<span data-ttu-id="00319-206">SpawnInstance 函数</span><span class="sxs-lookup"><span data-stu-id="00319-206">SpawnInstance function</span></span>](spawninstance.md) | <span data-ttu-id="00319-207">创建一个类的新实例。</span><span class="sxs-lookup"><span data-stu-id="00319-207">Creates a new instance of a class.</span></span> |   
| [<span data-ttu-id="00319-208">VerifyClient 函数</span><span class="sxs-lookup"><span data-stu-id="00319-208">VerifyClient function</span></span>](verifyclientkey.md) | <span data-ttu-id="00319-209">确保客户端密钥具有正确的安全性。</span><span class="sxs-lookup"><span data-stu-id="00319-209">Ensures that the client key has the correct security.</span></span> |
| [<span data-ttu-id="00319-210">WritePropertyValue 函数</span><span class="sxs-lookup"><span data-stu-id="00319-210">WritePropertyValue function</span></span>](writepropertyvalue.md) | <span data-ttu-id="00319-211">将指定的数目的字节写入由属性句柄识别的属性。</span><span class="sxs-lookup"><span data-stu-id="00319-211">Writes a specified number of bytes to a property identified by a property handle.</span></span> |

 ## <a name="see-also"></a><span data-ttu-id="00319-212">请参阅</span><span class="sxs-lookup"><span data-stu-id="00319-212">See also</span></span>
[<span data-ttu-id="00319-213">非托管的 API 参考</span><span class="sxs-lookup"><span data-stu-id="00319-213">Unmanaged API reference</span></span>](../index.md) 
