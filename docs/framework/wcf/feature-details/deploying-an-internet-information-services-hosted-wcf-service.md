---
title: "部署承载于 Internet 信息服务中的 WCF 服务"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 04ebd329-3fbd-44c3-b3ab-1de3517e27d7
caps.latest.revision: "30"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 42c30c5f83f8245531a357c2d0b179deb87a2845
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/21/2017
---
# <a name="deploying-an-internet-information-services-hosted-wcf-service"></a><span data-ttu-id="d3321-102">部署承载于 Internet 信息服务中的 WCF 服务</span><span class="sxs-lookup"><span data-stu-id="d3321-102">Deploying an Internet Information Services-Hosted WCF Service</span></span>
<span data-ttu-id="d3321-103">开发和部署承载于 Internet 信息服务 (IIS) 中的 [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] 服务包括以下任务：</span><span class="sxs-lookup"><span data-stu-id="d3321-103">Developing and deploying a [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] service that is hosted in Internet Information Services (IIS) consists of the following tasks:</span></span>  
  
-   <span data-ttu-id="d3321-104">请确保正确安装和注册 IIS、ASP.NET、 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]和 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 激活组件。</span><span class="sxs-lookup"><span data-stu-id="d3321-104">Ensure that IIS, ASP.NET, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], and the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] activation component are correctly installed and registered.</span></span>  
  
-   <span data-ttu-id="d3321-105">创建新的 IIS 应用程序，或重新使用现有的 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 应用程序。</span><span class="sxs-lookup"><span data-stu-id="d3321-105">Create a new IIS application, or reuse an existing [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] application.</span></span>  
  
-   <span data-ttu-id="d3321-106">为 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务创建 .svc 文件。</span><span class="sxs-lookup"><span data-stu-id="d3321-106">Create a .svc file for the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service.</span></span>  
  
-   <span data-ttu-id="d3321-107">将服务实现部署到 IIS 应用程序。</span><span class="sxs-lookup"><span data-stu-id="d3321-107">Deploy the service implementation to the IIS application.</span></span>  
  
-   <span data-ttu-id="d3321-108">配置 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务。</span><span class="sxs-lookup"><span data-stu-id="d3321-108">Configure the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service.</span></span>  
  
 <span data-ttu-id="d3321-109">有关创建承载于 IIS 中的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务的详细演练，请参见 [How to: Host a WCF Service in IIS](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-iis.md)。</span><span class="sxs-lookup"><span data-stu-id="d3321-109">For a detailed walkthrough of creating an IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service, see [How to: Host a WCF Service in IIS](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-iis.md).</span></span>  
  
## <a name="ensure-that-iis-aspnet-and-wcf-are-correctly-installed-and-registered"></a><span data-ttu-id="d3321-110">确保已正确安装和注册 IIS、ASP.NET 和 WCF</span><span class="sxs-lookup"><span data-stu-id="d3321-110">Ensure That IIS, ASP.NET and WCF Are Correctly Installed and Registered</span></span>  
 <span data-ttu-id="d3321-111">必须同时安装[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]、IIS 和 ASP.NET，承载于 IIS 中的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务才能正常工作。</span><span class="sxs-lookup"><span data-stu-id="d3321-111">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], IIS, and ASP.NET must be installed for IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services to function correctly.</span></span> <span data-ttu-id="d3321-112">安装 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] （作为 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]的一部分）、ASP.NET 和 IIS 的过程因所使用的操作系统版本不同而不同。</span><span class="sxs-lookup"><span data-stu-id="d3321-112">The procedures for installing [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] (as part of the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]), ASP.NET and IIS vary depending on the operating system version being used.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d3321-113"> 安装 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 和 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]，请参见 [Microsoft .NET Framework 4.0 Web 安装程序](http://go.microsoft.com/fwlink/?LinkId=201185)。</span><span class="sxs-lookup"><span data-stu-id="d3321-113"> installing [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] and the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)], see [Microsoft .NET Framework 4 Web Installer](http://go.microsoft.com/fwlink/?LinkId=201185).</span></span> <span data-ttu-id="d3321-114">有关安装 IIS 的说明可以在 [安装 IIS](http://go.microsoft.com/fwlink/?LinkId=201188)（可能为英文网页）上找到。</span><span class="sxs-lookup"><span data-stu-id="d3321-114">Instructions for installing IIS can be found at [Installing IIS](http://go.microsoft.com/fwlink/?LinkId=201188).</span></span>  
  
 <span data-ttu-id="d3321-115">如果计算机上已存在 IIS，则在安装 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)] 的过程中自动向 IIS 注册 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="d3321-115">The installation process for the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)] automatically registers [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] with IIS if IIS is already present on the machine.</span></span> <span data-ttu-id="d3321-116">如果在安装 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]后安装 IIS，则需要执行其他步骤向 IIS 和 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 注册 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d3321-116">If IIS is installed after the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)], an additional step is required to register [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] with IIS and [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span></span> <span data-ttu-id="d3321-117">根据您的操作系统，可以按如下所述执行此操作：</span><span class="sxs-lookup"><span data-stu-id="d3321-117">You can do this as follows, depending on your operating system:</span></span>  
  
-   [!INCLUDE[wxpsp2](../../../../includes/wxpsp2-md.md)]<span data-ttu-id="d3321-118">Windows 7 和[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]： 使用[ServiceModel 注册工具 (ServiceModelReg.exe)](../../../../docs/framework/wcf/servicemodelreg-exe.md)工具注册[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]与 IIS： 若要使用此工具，键入**ServiceModelReg.exe /i /x**中Visual Studio 命令提示符。</span><span class="sxs-lookup"><span data-stu-id="d3321-118">, Windows 7, and [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]: Use the [ServiceModel Registration Tool (ServiceModelReg.exe)](../../../../docs/framework/wcf/servicemodelreg-exe.md) tool to register [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] with IIS: To use this tool, type **ServiceModelReg.exe /i /x** in the Visual Studio command prompt.</span></span> <span data-ttu-id="d3321-119">打开此命令提示符，方法是单击“开始”按钮、选择 **“所有程序”**, **“Microsoft Visual Studio 2012”**, **“Visual Studio 工具”**和 **“Visual Studio 命令提示符”**。</span><span class="sxs-lookup"><span data-stu-id="d3321-119">You can open this command prompt by clicking the start button, selecting **All Programs**, **Microsoft Visual Studio 2012**, **Visual Studio Tools**, and **Visual Studio Command Prompt**</span></span>  
  
-   [!INCLUDE[wv](../../../../includes/wv-md.md)]<span data-ttu-id="d3321-120">：安装 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]的 Windows Communication Foundation Activation Components 子组件。</span><span class="sxs-lookup"><span data-stu-id="d3321-120">: Install the Windows Communication Foundation Activation Components subcomponent of the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)].</span></span> <span data-ttu-id="d3321-121">为此，请在控制面板中，单击**添加或删除程序**然后**添加\/删除 Windows 组件**。</span><span class="sxs-lookup"><span data-stu-id="d3321-121">To do this, in Control Panel, click **Add or Remove Programs** and then **Add\/Remove Windows Components**.</span></span> <span data-ttu-id="d3321-122">这将激活 **“Windows 组件向导”**。</span><span class="sxs-lookup"><span data-stu-id="d3321-122">This activates the **Windows Component Wizard**.</span></span>  
  
-   <span data-ttu-id="d3321-123">Windows 7：</span><span class="sxs-lookup"><span data-stu-id="d3321-123">Windows 7:</span></span>  
  
 <span data-ttu-id="d3321-124">最后，必须确认已将 ASP.NET 配置为使用 .NET Framework 版本 4。</span><span class="sxs-lookup"><span data-stu-id="d3321-124">Finally you must verify that ASP.NET is configured to use the .NET Framework version 4.</span></span> <span data-ttu-id="d3321-125">通过运行带 –i 选项的 ASPNET_Regiis 工具执行此操作。</span><span class="sxs-lookup"><span data-stu-id="d3321-125">You do this by running the ASPNET_Regiis tool with the –i option.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="d3321-126">[ASP.NET IIS 注册工具](http://go.microsoft.com/fwlink/?LinkId=201186)</span><span class="sxs-lookup"><span data-stu-id="d3321-126"> [ASP.NET IIS Registration Tool](http://go.microsoft.com/fwlink/?LinkId=201186)</span></span>  
  
## <a name="create-a-new-iis-application-or-reuse-an-existing-aspnet-application"></a><span data-ttu-id="d3321-127">创建新的 IIS 应用程序或重新使用现有的 ASP.NET 应用程序</span><span class="sxs-lookup"><span data-stu-id="d3321-127">Create a New IIS Application or Reuse an Existing ASP.NET Application</span></span>  
 <span data-ttu-id="d3321-128">承载于 IIS 中的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务必须驻留在 IIS 应用程序内。</span><span class="sxs-lookup"><span data-stu-id="d3321-128">IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services must reside inside of an IIS application.</span></span> <span data-ttu-id="d3321-129">可以创建一个新的 IIS 应用程序专门承载 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务。</span><span class="sxs-lookup"><span data-stu-id="d3321-129">You can create a new IIS application to host [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services exclusively.</span></span> <span data-ttu-id="d3321-130">或者，也可以将 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务部署到现有应用程序，该应用程序已经承载 [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)] 内容（如 .aspx 页和 ASP.NET Web 服务 [ASMX]）。</span><span class="sxs-lookup"><span data-stu-id="d3321-130">Alternatively, you can deploy an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service into an existing application that is already hosting [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)] content (such as .aspx pages and ASP.NET Web services [ASMX]).</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d3321-131"> 这些选项，请参见 [WCF Services and ASP.NET](../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md)。</span><span class="sxs-lookup"><span data-stu-id="d3321-131"> these options, see the "Hosting WCF Side-by-Side with ASP.NET" and "Hosting WCF Services in ASP.NET Compatibility Mode" sections in [WCF Services and ASP.NET](../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md).</span></span>  
  
 <span data-ttu-id="d3321-132">请注意， [!INCLUDE[iis601](../../../../includes/iis601-md.md)] 和更高版本定期重新启动独立的面向对象编程应用程序。</span><span class="sxs-lookup"><span data-stu-id="d3321-132">Note that [!INCLUDE[iis601](../../../../includes/iis601-md.md)] and later versions periodically restart an isolated object-oriented programming application.</span></span> <span data-ttu-id="d3321-133">默认值为 1740 分钟。</span><span class="sxs-lookup"><span data-stu-id="d3321-133">The default value is 1740 minutes.</span></span> <span data-ttu-id="d3321-134">支持的最大值为 71,582 分钟。</span><span class="sxs-lookup"><span data-stu-id="d3321-134">The maximum value supported is 71,582 minutes.</span></span> <span data-ttu-id="d3321-135">可以禁用此重新启动。</span><span class="sxs-lookup"><span data-stu-id="d3321-135">This restart can be disabled.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d3321-136"> 此属性，请参见 [PeriodicRestartTime](http://go.microsoft.com/fwlink/?LinkId=109968)。</span><span class="sxs-lookup"><span data-stu-id="d3321-136"> this property, see the [PeriodicRestartTime](http://go.microsoft.com/fwlink/?LinkId=109968).</span></span>  
  
## <a name="create-an-svc-file-for-the-wcf-service"></a><span data-ttu-id="d3321-137">为 WCF 服务创建 .svc 文件</span><span class="sxs-lookup"><span data-stu-id="d3321-137">Create an .svc File for the WCF Service</span></span>  
 <span data-ttu-id="d3321-138">承载于 IIS 中的[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务在 IIS 应用程序内表示为特殊内容文件（.svc 文件）。</span><span class="sxs-lookup"><span data-stu-id="d3321-138">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted in IIS are represented as special content files (.svc files) inside the IIS application.</span></span> <span data-ttu-id="d3321-139">此模型与在 IIS 应用程序内将 ASMX 页表示为 .asmx 文件的方式类似。</span><span class="sxs-lookup"><span data-stu-id="d3321-139">This model is similar to the way ASMX pages are represented inside of an IIS application as .asmx files.</span></span> <span data-ttu-id="d3321-140">.svc 文件包含 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]特定的处理指令 ([@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md))，该指令允许 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 承载基础结构激活所承载的服务以响应传入消息。</span><span class="sxs-lookup"><span data-stu-id="d3321-140">A .svc file contains a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-specific processing directive ([@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md)) that allows the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] hosting infrastructure to activate hosted services in response to incoming messages.</span></span> <span data-ttu-id="d3321-141">.svc 文件的最常见语法如以下语句所示。</span><span class="sxs-lookup"><span data-stu-id="d3321-141">The most common syntax for a .svc file is in the following statement.</span></span>  
  
```  
<% @ServiceHost Service="MyNamespace.MyServiceImplementationTypeName" %>  
```  
  
 <span data-ttu-id="d3321-142">它由 [@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md) 指令和单个属性 `Service`组成。</span><span class="sxs-lookup"><span data-stu-id="d3321-142">It consists of the [@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md) directive and a single attribute, `Service`.</span></span> <span data-ttu-id="d3321-143">`Service` 属性的值是服务实现的公共语言运行库 (CLR) 类型名称。</span><span class="sxs-lookup"><span data-stu-id="d3321-143">The value of the `Service` attribute is the common language runtime (CLR) type name of the service implementation.</span></span> <span data-ttu-id="d3321-144">使用此指令与使用以下代码创建服务主机基本等效。</span><span class="sxs-lookup"><span data-stu-id="d3321-144">Using this directive is basically equivalent to creating a service host using the following code.</span></span>  
  
```  
new ServiceHost( typeof( MyNamespace.MyServiceImplementationTypeName ) );  
```  
  
 <span data-ttu-id="d3321-145">也可以执行其他承载配置，如创建服务的基址列表。</span><span class="sxs-lookup"><span data-stu-id="d3321-145">Additional hosting configuration, such as creating a list of base addresses for the service can also be done.</span></span> <span data-ttu-id="d3321-146">也可以使用自定义 <xref:System.ServiceModel.Activation.ServiceHostFactory> 扩展指令以用于自定义承载解决方案。</span><span class="sxs-lookup"><span data-stu-id="d3321-146">You can also use a custom <xref:System.ServiceModel.Activation.ServiceHostFactory> to extend the directive for use with custom hosting solutions.</span></span> <span data-ttu-id="d3321-147">承载 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务的 IIS 应用程序不负责管理 <xref:System.ServiceModel.ServiceHost> 实例的创建和生存期。</span><span class="sxs-lookup"><span data-stu-id="d3321-147">The IIS applications that host [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services are not responsible for managing the creation and lifetime of <xref:System.ServiceModel.ServiceHost> instances.</span></span> <span data-ttu-id="d3321-148">收到 .svc 文件的第一个请求时，托管 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 承载基础结构动态创建必需的 <xref:System.ServiceModel.ServiceHost> 实例。</span><span class="sxs-lookup"><span data-stu-id="d3321-148">The managed [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] hosting infrastructure creates the necessary <xref:System.ServiceModel.ServiceHost> instance dynamically when the first request is received for the .svc file.</span></span> <span data-ttu-id="d3321-149">在代码显式关闭该实例之前或回收应用程序时，不释放该实例。</span><span class="sxs-lookup"><span data-stu-id="d3321-149">The instance is not released until either it is closed explicitly by code or when the application is recycled.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d3321-150"> .svc 文件语法的更多信息，请参见 [@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md)。</span><span class="sxs-lookup"><span data-stu-id="d3321-150"> the syntax for .svc files, see [@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md).</span></span>  
  
## <a name="deploy-the-service-implementation-to-the-iis-application"></a><span data-ttu-id="d3321-151">将服务实现部署到 IIS 应用程序</span><span class="sxs-lookup"><span data-stu-id="d3321-151">Deploy the Service Implementation to the IIS Application</span></span>  
 <span data-ttu-id="d3321-152">承载于 IIS 中的[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务与 [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)]使用相同的动态编译模型。</span><span class="sxs-lookup"><span data-stu-id="d3321-152">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted in IIS use the same dynamic compilation model as [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)].</span></span> <span data-ttu-id="d3321-153">就像在 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]中那样，可以在各种位置通过几种方式部署承载于 IIS 中的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务的实现代码，如下所示：</span><span class="sxs-lookup"><span data-stu-id="d3321-153">Just as with [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], you can deploy the implementation code for IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services in several ways at various locations, as follows:</span></span>  
  
-   <span data-ttu-id="d3321-154">作为全局程序集缓存 (GAC) 或应用程序的 \bin 目录中的预编译 .dll 文件。</span><span class="sxs-lookup"><span data-stu-id="d3321-154">As a precompiled .dll file located in the global assembly cache (GAC) or in the application’s \bin directory.</span></span> <span data-ttu-id="d3321-155">在部署类库的新版本后，才更新预编译的二进制文件。</span><span class="sxs-lookup"><span data-stu-id="d3321-155">Precompiled binaries are not updated until a new version of the class library is deployed.</span></span>  
  
-   <span data-ttu-id="d3321-156">作为位于应用程序的 \App_Code 目录中的未编译源文件。</span><span class="sxs-lookup"><span data-stu-id="d3321-156">As un-compiled source files located in the application’s \App_Code directory.</span></span> <span data-ttu-id="d3321-157">处理应用程序的第一个请求时，动态需要位于此目录中的源文件。</span><span class="sxs-lookup"><span data-stu-id="d3321-157">Source files located in this directory are dynamically required when processing the application’s first request.</span></span> <span data-ttu-id="d3321-158">对 \App_Code 目录中文件进行的任何更改都导致在收到下一个请求时回收和重新编译整个应用程序。</span><span class="sxs-lookup"><span data-stu-id="d3321-158">Any changes to files in the \App_Code directory cause the entire application to be recycled and recompiled when the next request is received.</span></span>  
  
-   <span data-ttu-id="d3321-159">作为直接放置在 .svc 文件中的未编译代码。</span><span class="sxs-lookup"><span data-stu-id="d3321-159">As un-compiled code placed directly in the .svc file.</span></span> <span data-ttu-id="d3321-160">实现代码也可以按内联方式位于的服务的.svc 文件之后,@ServiceHost指令。</span><span class="sxs-lookup"><span data-stu-id="d3321-160">Implementation code can also be located inline in the service’s .svc file, after the @ServiceHost directive.</span></span> <span data-ttu-id="d3321-161">对内联代码进行的任何更改导致在收到下一个请求时回收和重新编译应用程序。</span><span class="sxs-lookup"><span data-stu-id="d3321-161">Any changes to inline code cause the application to be recycled and recompiled when the next request is received.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d3321-162"> [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)] 编译模型的更多信息，请参见 [ASP.NET 编译概述](http://go.microsoft.com/fwlink/?LinkId=94773)（可能为英文网页）。</span><span class="sxs-lookup"><span data-stu-id="d3321-162"> the [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)] compilation model, see [ASP.NET Compilation Overview](http://go.microsoft.com/fwlink/?LinkId=94773).</span></span>  
  
## <a name="configure-the-wcf-service"></a><span data-ttu-id="d3321-163">配置 WCF 服务</span><span class="sxs-lookup"><span data-stu-id="d3321-163">Configure the WCF Service</span></span>  
 <span data-ttu-id="d3321-164">承载于 IIS 中的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务将其配置存储在应用程序 Web.config 文件中。</span><span class="sxs-lookup"><span data-stu-id="d3321-164">IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services store their configuration in the applications Web.config file.</span></span> <span data-ttu-id="d3321-165">承载于 IIS 中的服务使用与承载于 IIS 外部的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务相同的配置元素和语法。</span><span class="sxs-lookup"><span data-stu-id="d3321-165">IIS-hosted services use the same configuration elements and syntax as [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted outside of IIS.</span></span> <span data-ttu-id="d3321-166">但是，下面的约束对 IIS 承载环境是唯一的：</span><span class="sxs-lookup"><span data-stu-id="d3321-166">However, the following constraints are unique to the IIS hosting environment:</span></span>  
  
-   <span data-ttu-id="d3321-167">承载于 IIS 中的服务的基址。</span><span class="sxs-lookup"><span data-stu-id="d3321-167">Base addresses for IIS-hosted services.</span></span>  
  
-   <span data-ttu-id="d3321-168">应用程序承载[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]在 IIS 外部的服务可以控制通过将一组基址 Uri 对传递这些服务的基址<xref:System.ServiceModel.ServiceHost>构造函数或通过提供[\<主机 >](../../../../docs/framework/configure-apps/file-schema/wcf/host.md)中服务的配置元素。</span><span class="sxs-lookup"><span data-stu-id="d3321-168">Applications hosting [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services outside of IIS can control the base address of the services they host by passing a set of base address URIs to the <xref:System.ServiceModel.ServiceHost> constructor or by providing a [\<host>](../../../../docs/framework/configure-apps/file-schema/wcf/host.md) element in the service’s configuration.</span></span> <span data-ttu-id="d3321-169">承载于 IIS 中的服务无法控制其基址；承载于 IIS 中的服务的基址是其 .svc 文件的地址。</span><span class="sxs-lookup"><span data-stu-id="d3321-169">Services hosted in IIS do not have the ability to control their base address; the base address of an IIS-hosted service is the address of its .svc file.</span></span>  
  
### <a name="endpoint-addresses-for-iis-hosted-services"></a><span data-ttu-id="d3321-170">承载于 IIS 中的服务的终结点地址</span><span class="sxs-lookup"><span data-stu-id="d3321-170">Endpoint Addresses for IIS-Hosted Services</span></span>  
 <span data-ttu-id="d3321-171">承载于 IIS 中时，任何终结点地址始终被认为相对于表示服务的 .svc 文件的地址。</span><span class="sxs-lookup"><span data-stu-id="d3321-171">When hosted in IIS, endpoint addresses are always considered to be relative to the address of the .svc file that represents the service.</span></span> <span data-ttu-id="d3321-172">例如，如果 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务的基址是包含以下终结点配置的 http://localhost/Application1/MyService.svc。</span><span class="sxs-lookup"><span data-stu-id="d3321-172">For example, if the base address of a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service is http://localhost/Application1/MyService.svc with the following endpoint configuration.</span></span>  
  
```xml  
<endpoint address="anotherEndpoint" .../>  
```  
  
 <span data-ttu-id="d3321-173">这提供了一个可以在“http://localhost/Application1/MyService.svc/anotherEndpoint”上访问的终结点。</span><span class="sxs-lookup"><span data-stu-id="d3321-173">This provides an endpoint that can be reached at "http://localhost/Application1/MyService.svc/anotherEndpoint".</span></span>  
  
 <span data-ttu-id="d3321-174">同样，将空字符串用作相对地址的终结点配置元素提供了一个可以在 http://localhost/Application1/MyService.svc（它是基址）上访问的终结点。</span><span class="sxs-lookup"><span data-stu-id="d3321-174">Similarly, the endpoint configuration element that uses an empty string as the relative address provides an endpoint reachable at http://localhost/Application1/MyService.svc, which is the base address.</span></span>  
  
```xml  
<endpoint address="" ... />  
```  
  
 <span data-ttu-id="d3321-175">对于承载于 IIS 中的服务的终结点，必须始终使用相对终结点地址。</span><span class="sxs-lookup"><span data-stu-id="d3321-175">You must always use relative endpoint addresses for IIS-hosted service endpoints.</span></span> <span data-ttu-id="d3321-176">如果终结点地址未指向承载公开终结点的服务的 IIS 应用程序，则提供完全限定的终结点地址（例如，http://localhost/MyService.svc）可能导致在部署服务时出错。</span><span class="sxs-lookup"><span data-stu-id="d3321-176">Supplying a fully-qualified endpoint address (for example, http://localhost/MyService.svc) can lead to errors in the deployment of the service if the endpoint address does not point to the IIS-application that hosts the service exposing the endpoint.</span></span> <span data-ttu-id="d3321-177">对所承载的服务使用相对终结点地址避免了这些潜在冲突。</span><span class="sxs-lookup"><span data-stu-id="d3321-177">Using relative endpoint addresses for hosted services avoids these potential conflicts.</span></span>  
  
### <a name="available-transports"></a><span data-ttu-id="d3321-178">可用传输</span><span class="sxs-lookup"><span data-stu-id="d3321-178">Available Transports</span></span>  
 <span data-ttu-id="d3321-179">承载于 IIS 5.1 和[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 中的 [!INCLUDE[iis601](../../../../includes/iis601-md.md)] 服务被限制为使用基于 HTTP 的通信。</span><span class="sxs-lookup"><span data-stu-id="d3321-179">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted in IIS 5.1 and [!INCLUDE[iis601](../../../../includes/iis601-md.md)] are restricted to using HTTP-based communication.</span></span> <span data-ttu-id="d3321-180">在这些 IIS 平台上，将所承载的服务配置为使用非 HTTP 绑定会导致服务激活期间出错。</span><span class="sxs-lookup"><span data-stu-id="d3321-180">On these IIS platforms, configuring a hosted service to use a non-HTTP binding results in an error during service activation.</span></span> <span data-ttu-id="d3321-181">对于 [!INCLUDE[iisver](../../../../includes/iisver-md.md)]，支持的传输包括 HTTP、Net.TCP、Net.Pipe、Net.MSMQ 以及用于与现有 MSMQ 应用程序向后兼容的 msmq.formatname。</span><span class="sxs-lookup"><span data-stu-id="d3321-181">For [!INCLUDE[iisver](../../../../includes/iisver-md.md)], the supported transports include HTTP, Net.TCP, Net.Pipe, Net.MSMQ, and msmq.formatname for backwards compatibility with existing MSMQ applications.</span></span>  
  
### <a name="http-transport-security"></a><span data-ttu-id="d3321-182">HTTP 传输安全</span><span class="sxs-lookup"><span data-stu-id="d3321-182">HTTP Transport Security</span></span>  
 <span data-ttu-id="d3321-183">承载于 IIS 中的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服务可以使用 HTTP 传输安全（例如 HTTPS 和 HTTP 身份验证方案，如基本、摘要式和 Windows 集成身份验证），前提是包含该服务的 IIS 虚拟目录支持这些设置。</span><span class="sxs-lookup"><span data-stu-id="d3321-183">IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services can make use of HTTP transport security (for example, HTTPS and HTTP authentication schemes such as Basic, Digest, and Windows Integrated Authentication) as long as the IIS virtual directory that contains the service supports those settings.</span></span> <span data-ttu-id="d3321-184">所承载终结点的绑定上的 HTTP 传输安全设置必须与包含它的 IIS 虚拟目录上的传输安全设置匹配。</span><span class="sxs-lookup"><span data-stu-id="d3321-184">The HTTP Transport Security settings on a hosted endpoint’s binding must match the transport security settings on the IIS virtual directory that contains it.</span></span>  
  
 <span data-ttu-id="d3321-185">例如，配置为使用 HTTP 摘要式身份验证的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 终结点必须驻留在也配置为允许 HTTP 摘要式身份验证的 IIS 虚拟目录中。</span><span class="sxs-lookup"><span data-stu-id="d3321-185">For example, a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoint configured to use HTTP digest authentication must reside in an IIS virtual directory that is also configured to allow HTTP digest authentication.</span></span> <span data-ttu-id="d3321-186">IIS 设置和 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 终结点设置的不匹配组合会导致服务激活期间出错。</span><span class="sxs-lookup"><span data-stu-id="d3321-186">Unmatched combinations of IIS settings and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoint settings result in an error during service activation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d3321-187">另请参阅</span><span class="sxs-lookup"><span data-stu-id="d3321-187">See Also</span></span>  
 [<span data-ttu-id="d3321-188">在 Internet 信息服务中承载</span><span class="sxs-lookup"><span data-stu-id="d3321-188">Hosting in Internet Information Services</span></span>](../../../../docs/framework/wcf/feature-details/hosting-in-internet-information-services.md)  
 [<span data-ttu-id="d3321-189">Internet 信息服务承载最佳实践</span><span class="sxs-lookup"><span data-stu-id="d3321-189">Internet Information Services Hosting Best Practices</span></span>](../../../../docs/framework/wcf/feature-details/internet-information-services-hosting-best-practices.md)  
 [<span data-ttu-id="d3321-190">Windows Server App Fabric 承载功能</span><span class="sxs-lookup"><span data-stu-id="d3321-190">Windows Server App Fabric Hosting Features</span></span>](http://go.microsoft.com/fwlink/?LinkId=201276)
