---
title: 如何：创建 WSFederationHttpBinding
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF, federation
- federation
ms.assetid: e54897d7-aa6c-46ec-a278-b2430c8c2e10
caps.latest.revision: 16
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 8962564bbefc3f43261a2979ae9765369b211f15
ms.sourcegitcommit: 03ee570f6f528a7d23a4221dcb26a9498edbdf8c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2018
---
# <a name="how-to-create-a-wsfederationhttpbinding"></a><span data-ttu-id="6947a-102">如何：创建 WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="6947a-102">How to: Create a WSFederationHttpBinding</span></span>
<span data-ttu-id="6947a-103">在[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]、<xref:System.ServiceModel.WSFederationHttpBinding>类 ([\<wsFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md)配置中) 提供了用于公开联合的服务的机制。</span><span class="sxs-lookup"><span data-stu-id="6947a-103">In [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], the <xref:System.ServiceModel.WSFederationHttpBinding> class ([\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) in configuration) provides a mechanism for exposing a federated service.</span></span> <span data-ttu-id="6947a-104">即，服务要求客户端使用安全令牌服务颁发的安全令牌进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="6947a-104">That is, a service that requires clients to authenticate using a security token issued by a security token service.</span></span> <span data-ttu-id="6947a-105">本主题演示如何通过代码和配置来设置 <xref:System.ServiceModel.WSFederationHttpBinding>。</span><span class="sxs-lookup"><span data-stu-id="6947a-105">This topic shows how to set up a <xref:System.ServiceModel.WSFederationHttpBinding> in both code and configuration.</span></span> <span data-ttu-id="6947a-106">绑定一经创建，您就可以设置一个终结点来使用该绑定。</span><span class="sxs-lookup"><span data-stu-id="6947a-106">Once the binding is created, you can set up an endpoint to use that binding.</span></span>  
  
 <span data-ttu-id="6947a-107">基本步骤概述如下：</span><span class="sxs-lookup"><span data-stu-id="6947a-107">The basic steps are outlined as follows:</span></span>  
  
1.  <span data-ttu-id="6947a-108">选择一种安全模式。</span><span class="sxs-lookup"><span data-stu-id="6947a-108">Select a security mode.</span></span> <span data-ttu-id="6947a-109"><xref:System.ServiceModel.WSFederationHttpBinding> 支持 `Message`，它在消息级提供端对端的安全（即使跨多个跃点也是如此），还支持 `TransportWithMessageCredential`，它在客户端和服务可以通过 HTTPS 直接连接的情况下提供较好的性能。</span><span class="sxs-lookup"><span data-stu-id="6947a-109">The <xref:System.ServiceModel.WSFederationHttpBinding> supports `Message`, which provides end-to-end security at the message level, even across multiple hops, and `TransportWithMessageCredential`, which provides better performance in cases where the client and the service can make a direct connection over HTTPS.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="6947a-110"><xref:System.ServiceModel.WSFederationHttpBinding> 还支持 `None` 作为安全模式。</span><span class="sxs-lookup"><span data-stu-id="6947a-110">The <xref:System.ServiceModel.WSFederationHttpBinding> also supports `None` as a security mode.</span></span> <span data-ttu-id="6947a-111">此模式不安全，仅用于调试目的。</span><span class="sxs-lookup"><span data-stu-id="6947a-111">This mode is not secure and is provided for debugging purposes only.</span></span> <span data-ttu-id="6947a-112">如果使用部署的服务终结点<xref:System.ServiceModel.WSFederationHttpBinding>其安全模式设置为与`None`，生成的客户端绑定 (由生成[ServiceModel 元数据实用工具 (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)) 是 <<!--zz xref:System.ServiceModel.WsHttpBinding --> `xref:System.ServiceModel.WsHttpBinding`> 使用的安全模式`None`。</span><span class="sxs-lookup"><span data-stu-id="6947a-112">If a service endpoint is deployed with a <xref:System.ServiceModel.WSFederationHttpBinding> with its security mode set to `None`, the resulting client binding (generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)) is a <<!--zz xref:System.ServiceModel.WsHttpBinding --> `xref:System.ServiceModel.WsHttpBinding`> with a security mode of `None`.</span></span>  
  
     <span data-ttu-id="6947a-113">与其他系统提供的绑定不同，使用 `WSFederationHttpBinding` 时无需选择客户端凭据类型。</span><span class="sxs-lookup"><span data-stu-id="6947a-113">Unlike other system-provided bindings, it is not necessary to select a client credential type when using the `WSFederationHttpBinding`.</span></span> <span data-ttu-id="6947a-114">这是因为客户端凭据类型始终为已颁发令牌。</span><span class="sxs-lookup"><span data-stu-id="6947a-114">This is because the client credential type is always an issued token.</span></span> [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="6947a-115"> 从指定的颁发者获取一个令牌，并将该令牌提供给服务以对客户端进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="6947a-115"> acquires a token from a specified issuer and presents that token to the service to authenticate the client.</span></span>  
  
2.  <span data-ttu-id="6947a-116">在联合客户端上，将 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> 属性设置为安全令牌服务的 URL。</span><span class="sxs-lookup"><span data-stu-id="6947a-116">On federated clients, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> property to the URL of the security token service.</span></span> <span data-ttu-id="6947a-117">将 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> 设置为要使用的绑定，以便与安全令牌服务进行通信。</span><span class="sxs-lookup"><span data-stu-id="6947a-117">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> to the binding to use to communicate with the security token service.</span></span>  
  
3.  <span data-ttu-id="6947a-118">可选。</span><span class="sxs-lookup"><span data-stu-id="6947a-118">Optional.</span></span> <span data-ttu-id="6947a-119">将 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> 属性设置为令牌类型的统一资源标识符 (URI)。</span><span class="sxs-lookup"><span data-stu-id="6947a-119">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> property to the Uniform Resource Identifier (URI) of a token type.</span></span> <span data-ttu-id="6947a-120">在联合服务上，指定服务期望使用的令牌类型。</span><span class="sxs-lookup"><span data-stu-id="6947a-120">On federated services, specify the token type that the service expects.</span></span> <span data-ttu-id="6947a-121">在联合客户端上，指定客户端向安全令牌服务请求的令牌类型。</span><span class="sxs-lookup"><span data-stu-id="6947a-121">On federated clients, specify the token type the client requests from the security token service.</span></span>  
  
     <span data-ttu-id="6947a-122">如果未指定令牌类型，则默认情况下，客户端将在无令牌类型 URI 的情况下生成 WS-Trust 请求安全令牌 (RST)，而服务希望使用安全断言标记语言 (SAML) 1.1 令牌进行客户端身份验证。</span><span class="sxs-lookup"><span data-stu-id="6947a-122">If no token type is specified, clients generate WS-Trust Request Security Tokens (RSTs) without a token type URI, and services expect client authentication using a Security Assertions Markup Language (SAML) 1.1 token by default.</span></span>  
  
     <span data-ttu-id="6947a-123">SAML 1.1 令牌的 URI 是"http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1"。</span><span class="sxs-lookup"><span data-stu-id="6947a-123">The URI for a SAML 1.1 token is "http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1".</span></span>  
  
4.  <span data-ttu-id="6947a-124">可选。</span><span class="sxs-lookup"><span data-stu-id="6947a-124">Optional.</span></span> <span data-ttu-id="6947a-125">在联合服务上，将 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerMetadataAddress%2A> 属性设置为安全令牌服务的元数据 URL。</span><span class="sxs-lookup"><span data-stu-id="6947a-125">On federated services, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerMetadataAddress%2A> property to the metadata URL of a security token service.</span></span> <span data-ttu-id="6947a-126">使用元数据终结点，服务的客户端可以选择一个适合的绑定/终结点对，前提是将服务配置为发布元数据。</span><span class="sxs-lookup"><span data-stu-id="6947a-126">The metadata endpoint enables clients of the service to select an appropriate binding/endpoint pair, if the service is configured to publish metadata.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="6947a-127"> 发布元数据，请参阅[发布元数据](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)。</span><span class="sxs-lookup"><span data-stu-id="6947a-127"> publishing metadata, see [Publishing Metadata](../../../../docs/framework/wcf/feature-details/publishing-metadata.md).</span></span>  
  
 <span data-ttu-id="6947a-128">你还可以设置其他属性，包括已颁发令牌中用作校验密钥的密钥类型、在客户端和服务之间使用的算法套件、是协商还是显式指定服务凭据、服务期望已颁发令牌中包含的任何特定声明，以及必须添加到由客户端发送到安全令牌服务的请求的其他 XML 元素。</span><span class="sxs-lookup"><span data-stu-id="6947a-128">You can also set other properties, including the type of key used as a proof key in the issued token, the algorithm suite to use between the client and the service, whether to negotiate or explicitly specify the service credential, any specific claims the service expects the issued token to contain, and any additional XML elements that must be added to the request the client sends to the security token service.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6947a-129">仅当 `NegotiateServiceCredential` 设置为 `SecurityMode` 时，`Message` 属性才是相关的。</span><span class="sxs-lookup"><span data-stu-id="6947a-129">The `NegotiateServiceCredential` property is only relevant when the `SecurityMode` is set to `Message`.</span></span> <span data-ttu-id="6947a-130">如果将 `SecurityMode` 设置为 `TransportWithMessageCredential`，则将忽略 `NegotiateServiceCredential` 属性。</span><span class="sxs-lookup"><span data-stu-id="6947a-130">If `SecurityMode` is set to `TransportWithMessageCredential`, then the `NegotiateServiceCredential` property is ignored.</span></span>  
  
### <a name="to-configure-a-wsfederationhttpbinding-in-code"></a><span data-ttu-id="6947a-131">以代码方式配置 WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="6947a-131">To configure a WSFederationHttpBinding in code</span></span>  
  
1.  <span data-ttu-id="6947a-132">创建 <xref:System.ServiceModel.WSFederationHttpBinding> 的一个实例。</span><span class="sxs-lookup"><span data-stu-id="6947a-132">Create an instance of the <xref:System.ServiceModel.WSFederationHttpBinding>.</span></span>  
  
2.  <span data-ttu-id="6947a-133">根据需要将 <xref:System.ServiceModel.WSFederationHttpSecurity.Mode%2A> 属性设置为 <xref:System.ServiceModel.WSFederationHttpSecurityMode> 或 <xref:System.ServiceModel.WSFederationHttpSecurityMode.Message>。</span><span class="sxs-lookup"><span data-stu-id="6947a-133">Set the <xref:System.ServiceModel.WSFederationHttpSecurity.Mode%2A> property to <xref:System.ServiceModel.WSFederationHttpSecurityMode> or <xref:System.ServiceModel.WSFederationHttpSecurityMode.Message> as required.</span></span> <span data-ttu-id="6947a-134">如果以外的其他算法套件<xref:System.ServiceModel.Security.SecurityAlgorithmSuite.Basic256%2A>是必需的设置<xref:System.ServiceModel.FederatedMessageSecurityOverHttp.AlgorithmSuite%2A>属性中获取的值<xref:System.ServiceModel.Security.SecurityAlgorithmSuite>。</span><span class="sxs-lookup"><span data-stu-id="6947a-134">If an algorithm suite other than <xref:System.ServiceModel.Security.SecurityAlgorithmSuite.Basic256%2A> is required, set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.AlgorithmSuite%2A> property to a value taken from <xref:System.ServiceModel.Security.SecurityAlgorithmSuite>.</span></span>  
  
3.  <span data-ttu-id="6947a-135">根据需要设置 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="6947a-135">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> property as appropriate.</span></span>  
  
4.  <span data-ttu-id="6947a-136">设置<xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedKeyType%2A>属性<xref:System.IdentityModel.Tokens.SecurityKeyType>`SymmetricKey`或。`AsymmetricKey`</span><span class="sxs-lookup"><span data-stu-id="6947a-136">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedKeyType%2A> property to <xref:System.IdentityModel.Tokens.SecurityKeyType>`SymmetricKey` or .`AsymmetricKey`</span></span> <span data-ttu-id="6947a-137">所需的方式。</span><span class="sxs-lookup"><span data-stu-id="6947a-137">as required.</span></span>  
  
5.  <span data-ttu-id="6947a-138">将 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> 属性设置为适当的值。</span><span class="sxs-lookup"><span data-stu-id="6947a-138">Set the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuedTokenType%2A> property to the appropriate value.</span></span> <span data-ttu-id="6947a-139">如果未不设置任何值，[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]默认为"http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1"，指示 SAML 1.1 令牌。</span><span class="sxs-lookup"><span data-stu-id="6947a-139">If no value is set, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] defaults to "http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1", which indicates SAML 1.1 tokens.</span></span>  
  
6.  <span data-ttu-id="6947a-140">如果未指定本地颁发者则在客户端上是必需的；在服务上是可选的。</span><span class="sxs-lookup"><span data-stu-id="6947a-140">Required on the client if no local issuer is specified; optional on the service.</span></span> <span data-ttu-id="6947a-141">创建一个包含安全令牌服务的地址和标识信息的 <xref:System.ServiceModel.EndpointAddress>，然后将 <xref:System.ServiceModel.EndpointAddress> 实例分配给 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="6947a-141">Create an <xref:System.ServiceModel.EndpointAddress> that contains the address and identity information of the security token service and assign the <xref:System.ServiceModel.EndpointAddress> instance to the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerAddress%2A> property.</span></span>  
  
7.  <span data-ttu-id="6947a-142">如果未指定本地颁发者则在客户端上是必需的；不能在服务上使用。</span><span class="sxs-lookup"><span data-stu-id="6947a-142">Required on the client if no local issuer is specified; not used on the service.</span></span> <span data-ttu-id="6947a-143">创建<xref:System.ServiceModel.Channels.Binding>为`SecurityTokenService`并分配<xref:System.ServiceModel.Channels.Binding>到实例<xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="6947a-143">Create a <xref:System.ServiceModel.Channels.Binding> for the `SecurityTokenService` and assign the <xref:System.ServiceModel.Channels.Binding> instance to the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.IssuerBinding%2A> property.</span></span>  
  
8.  <span data-ttu-id="6947a-144">不能在客户端上使用；在服务上可选。</span><span class="sxs-lookup"><span data-stu-id="6947a-144">Not used on the client; optional on the service.</span></span> <span data-ttu-id="6947a-145">为安全令牌服务的元数据创建一个 <xref:System.ServiceModel.EndpointAddress> 实例，然后将其分配给 `IssuerMetadataAddress` 属性。</span><span class="sxs-lookup"><span data-stu-id="6947a-145">Create an <xref:System.ServiceModel.EndpointAddress> instance for the metadata of the security token service and assign it to the `IssuerMetadataAddress` property.</span></span>  
  
9. <span data-ttu-id="6947a-146">在客户端和服务上都是可选的。</span><span class="sxs-lookup"><span data-stu-id="6947a-146">Optional on both the client and the service.</span></span> <span data-ttu-id="6947a-147">创建一个或多个 <xref:System.ServiceModel.Security.Tokens.ClaimTypeRequirement> 实例，并将其添加到 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.ClaimTypeRequirements%2A> 属性返回的集合中。</span><span class="sxs-lookup"><span data-stu-id="6947a-147">Create and add one or more <xref:System.ServiceModel.Security.Tokens.ClaimTypeRequirement> instances to the collection returned by the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.ClaimTypeRequirements%2A> property.</span></span>  
  
10. <span data-ttu-id="6947a-148">在客户端和服务上都是可选的。</span><span class="sxs-lookup"><span data-stu-id="6947a-148">Optional on both the client and the service.</span></span> <span data-ttu-id="6947a-149">创建一个或多个 <xref:System.Xml.XmlElement> 实例，并将其添加到 <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.TokenRequestParameters%2A> 属性返回的集合中。</span><span class="sxs-lookup"><span data-stu-id="6947a-149">Create and add one or more <xref:System.Xml.XmlElement> instances to the collection returned by the <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.TokenRequestParameters%2A> property.</span></span>  
  
### <a name="to-create-a-federated-endpoint-in-configuration"></a><span data-ttu-id="6947a-150">在配置中创建联合终结点</span><span class="sxs-lookup"><span data-stu-id="6947a-150">To create a federated endpoint in configuration</span></span>  
  
1.  <span data-ttu-id="6947a-151">创建[ \<wsFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md)的子级[\<绑定 >](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md)应用程序配置文件中的元素。</span><span class="sxs-lookup"><span data-stu-id="6947a-151">Create a [\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) as a child of the [\<bindings>](../../../../docs/framework/configure-apps/file-schema/wcf/bindings.md) element in the application configuration file.</span></span>  
  
2.  <span data-ttu-id="6947a-152">创建[\<绑定 >](../../../../docs/framework/misc/binding.md)元素的子级作为[ \<wsFederationHttpBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md)并设置`name`属性设为适当的值。</span><span class="sxs-lookup"><span data-stu-id="6947a-152">Create a [\<binding>](../../../../docs/framework/misc/binding.md) element as a child of [\<wsFederationHttpBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/wsfederationhttpbinding.md) and set the `name` attribute to an appropriate value.</span></span>  
  
3.  <span data-ttu-id="6947a-153">创建`<security>`元素的子级作为[\<绑定 >](../../../../docs/framework/misc/binding.md)元素。</span><span class="sxs-lookup"><span data-stu-id="6947a-153">Create a `<security>` element as a child of the [\<binding>](../../../../docs/framework/misc/binding.md) element.</span></span>  
  
4.  <span data-ttu-id="6947a-154">根据需要将 `mode` 元素的 `<security>` 属性设置为 `Message` 或 `TransportWithMessageCredential` 的一个值。</span><span class="sxs-lookup"><span data-stu-id="6947a-154">Set the `mode` attribute on the `<security>` element to a value of `Message` or `TransportWithMessageCredential`, as required.</span></span>  
  
5.  <span data-ttu-id="6947a-155">创建一个 `<message>` 元素，作为 `<security>` 元素的子元素。</span><span class="sxs-lookup"><span data-stu-id="6947a-155">Create a `<message>` element as a child of the `<security>` element.</span></span>  
  
6.  <span data-ttu-id="6947a-156">可选。</span><span class="sxs-lookup"><span data-stu-id="6947a-156">Optional.</span></span> <span data-ttu-id="6947a-157">将 `algorithmSuite` 元素的 `<message>` 属性设置为适当的值。</span><span class="sxs-lookup"><span data-stu-id="6947a-157">Set the `algorithmSuite` attribute on the `<message>` element with an appropriate value.</span></span> <span data-ttu-id="6947a-158">默认值为 `Basic256`。</span><span class="sxs-lookup"><span data-stu-id="6947a-158">The default is `Basic256`.</span></span>  
  
7.  <span data-ttu-id="6947a-159">可选。</span><span class="sxs-lookup"><span data-stu-id="6947a-159">Optional.</span></span> <span data-ttu-id="6947a-160">如果需要非对称校验密钥，请将 `issuedKeyType` 元素的 `<message>` 属性设置为 `AsymmetricKey`。</span><span class="sxs-lookup"><span data-stu-id="6947a-160">If an asymmetric proof key is required, set the `issuedKeyType` attribute of the `<message>` element to `AsymmetricKey`.</span></span> <span data-ttu-id="6947a-161">默认值为 `SymmetricKey`。</span><span class="sxs-lookup"><span data-stu-id="6947a-161">The default is `SymmetricKey`.</span></span>  
  
8.  <span data-ttu-id="6947a-162">可选。</span><span class="sxs-lookup"><span data-stu-id="6947a-162">Optional.</span></span> <span data-ttu-id="6947a-163">设置 `issuedTokenType` 元素的 `<message>` 属性。</span><span class="sxs-lookup"><span data-stu-id="6947a-163">Set the `issuedTokenType` attribute on the `<message>` element.</span></span>  
  
9. <span data-ttu-id="6947a-164">如果未指定本地颁发者则在客户端上是必需的；在服务上是可选的。</span><span class="sxs-lookup"><span data-stu-id="6947a-164">Required on the client if no local issuer is specified; optional on the service.</span></span> <span data-ttu-id="6947a-165">创建一个 `<issuer>` 元素，作为 `<message>` 元素的子元素。</span><span class="sxs-lookup"><span data-stu-id="6947a-165">Create an `<issuer>` element as a child of the `<message>` element.</span></span>  
  
10. <span data-ttu-id="6947a-166">将 `address` 属性设置为 `<issuer>` 元素，并指定安全令牌服务接受令牌请求的地址。</span><span class="sxs-lookup"><span data-stu-id="6947a-166">Set the `address` attribute to the `<issuer>` element and specify the address at which the security token service accepts token requests.</span></span>  
  
11. <span data-ttu-id="6947a-167">可选。</span><span class="sxs-lookup"><span data-stu-id="6947a-167">Optional.</span></span> <span data-ttu-id="6947a-168">添加一个 `<identity>` 子元素，并指定安全令牌服务的标识。</span><span class="sxs-lookup"><span data-stu-id="6947a-168">Add an `<identity>` child element and specify the identity of the security token service</span></span>  
  
12. <span data-ttu-id="6947a-169">有关详细信息，请参阅[服务标识和身份验证](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md)。</span><span class="sxs-lookup"><span data-stu-id="6947a-169">For more information, see [Service Identity and Authentication](../../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md).</span></span>  
  
13. <span data-ttu-id="6947a-170">如果未指定本地颁发者则在客户端上是必需的；不能在服务上使用。</span><span class="sxs-lookup"><span data-stu-id="6947a-170">Required on the client if no local issuer is specified; not used on the service.</span></span> <span data-ttu-id="6947a-171">创建[\<绑定 >](../../../../docs/framework/misc/binding.md)可以用于与安全令牌服务通信的绑定部分中的元素。</span><span class="sxs-lookup"><span data-stu-id="6947a-171">Create a [\<binding>](../../../../docs/framework/misc/binding.md) element in the bindings section that can be used to communicate with the security token service.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="6947a-172"> 创建一个绑定，请参阅[如何： 在配置中指定服务绑定](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md)。</span><span class="sxs-lookup"><span data-stu-id="6947a-172"> creating a binding, see [How to: Specify a Service Binding in Configuration](../../../../docs/framework/wcf/how-to-specify-a-service-binding-in-configuration.md).</span></span>  
  
14. <span data-ttu-id="6947a-173">通过设置 `binding` 元素的 `bindingConfiguration` 和 `<issuer>` 属性，来指定在上一步创建的绑定。</span><span class="sxs-lookup"><span data-stu-id="6947a-173">Specify the binding created in the previous step by setting the `binding` and `bindingConfiguration` attributes of the `<issuer>` element.</span></span>  
  
15. <span data-ttu-id="6947a-174">不能在客户端上使用；在服务上可选。</span><span class="sxs-lookup"><span data-stu-id="6947a-174">Not used on the client; optional on the service.</span></span> <span data-ttu-id="6947a-175">创建一个 `<issuerMetadata>` 元素，作为 <`message`> 元素的子元素。</span><span class="sxs-lookup"><span data-stu-id="6947a-175">Create an `<issuerMetadata>` element as a child of the <`message`> element.</span></span> <span data-ttu-id="6947a-176">然后，在 `address` 元素的 `<issuerMetadata>` 属性中，指定安全令牌服务将要发布其元数据的地址。</span><span class="sxs-lookup"><span data-stu-id="6947a-176">Then, in an `address` attribute on the `<issuerMetadata>` element, specify the address at which the security token service is to publish its metadata.</span></span> <span data-ttu-id="6947a-177">还可以选择添加一个 `<identity>` 子元素，并指定安全令牌服务的标识。</span><span class="sxs-lookup"><span data-stu-id="6947a-177">Optionally, add an `<identity>` child element and specify the identity of the security token service.</span></span>  
  
16. <span data-ttu-id="6947a-178">在客户端和服务上都是可选的。</span><span class="sxs-lookup"><span data-stu-id="6947a-178">Optional on both the client and the service.</span></span> <span data-ttu-id="6947a-179">添加一个 `<claimTypeRequirements>` 元素，将其作为 `<message>` 元素的子元素。</span><span class="sxs-lookup"><span data-stu-id="6947a-179">Add a `<claimTypeRequirements>` element as a child of the `<message>` element.</span></span> <span data-ttu-id="6947a-180">指定必选和可选声明，该服务依赖于通过添加[\<添加 >](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-claimtyperequirements.md)元素与`<claimTypeRequirements>`元素和指定声明类型与`claimType`属性。</span><span class="sxs-lookup"><span data-stu-id="6947a-180">Specify required and optional claims that the service relies on by adding [\<add>](../../../../docs/framework/configure-apps/file-schema/wcf/add-of-claimtyperequirements.md) elements to the `<claimTypeRequirements>` element and specifying the claim type with the `claimType` attribute.</span></span> <span data-ttu-id="6947a-181">通过设置 `isOptional` 属性来指定给定的声明是必选的还是可选的。</span><span class="sxs-lookup"><span data-stu-id="6947a-181">Specify whether a given claim is required or optional by setting the `isOptional` attribute.</span></span>  
  
## <a name="example"></a><span data-ttu-id="6947a-182">示例</span><span class="sxs-lookup"><span data-stu-id="6947a-182">Example</span></span>  
 <span data-ttu-id="6947a-183">下面的代码示例演示强制设置 `WSFederationHttpBinding` 的代码。</span><span class="sxs-lookup"><span data-stu-id="6947a-183">The following code sample shows code for setting up a `WSFederationHttpBinding` imperatively.</span></span>  
  
 [!code-csharp[c_FederationBinding#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_federationbinding/cs/source.cs#2)] 
 [!code-vb[c_FederationBinding#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_federationbinding/vb/source.vb#2)]  
  
## <a name="see-also"></a><span data-ttu-id="6947a-184">请参阅</span><span class="sxs-lookup"><span data-stu-id="6947a-184">See Also</span></span>  
 [<span data-ttu-id="6947a-185">联合</span><span class="sxs-lookup"><span data-stu-id="6947a-185">Federation</span></span>](../../../../docs/framework/wcf/feature-details/federation.md)  
 [<span data-ttu-id="6947a-186">联合示例</span><span class="sxs-lookup"><span data-stu-id="6947a-186">Federation Sample</span></span>](../../../../docs/framework/wcf/samples/federation-sample.md)  
 [<span data-ttu-id="6947a-187">如何：在 WSFederationHttpBinding 上禁用安全会话</span><span class="sxs-lookup"><span data-stu-id="6947a-187">How to: Disable Secure Sessions on a WSFederationHttpBinding</span></span>](../../../../docs/framework/wcf/feature-details/how-to-disable-secure-sessions-on-a-wsfederationhttpbinding.md)
