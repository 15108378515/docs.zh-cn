---
title: "承载服务"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: hosting services [WCF]
ms.assetid: 192be927-6be2-4fda-98f0-e513c4881acc
caps.latest.revision: "31"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: c4cafff46d31ed9a5737dbb74acecab96b1f1a1e
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/02/2017
---
# <a name="hosting-services"></a><span data-ttu-id="95368-102">承载服务</span><span class="sxs-lookup"><span data-stu-id="95368-102">Hosting Services</span></span>
<span data-ttu-id="95368-103">要变为活动状态，服务必须承载于创建它并控制它的上下文和生存期的运行时环境中。</span><span class="sxs-lookup"><span data-stu-id="95368-103">To become active, a service must be hosted within a run-time environment that creates it and controls its context and lifetime.</span></span> [!INCLUDE[indigo1](../../../includes/indigo1-md.md)]<span data-ttu-id="95368-104"> 服务设计为在支持托管代码的任意 Windows 进程中运行。</span><span class="sxs-lookup"><span data-stu-id="95368-104"> services are designed to run in any Windows process that supports managed code.</span></span>  
  
 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]<span data-ttu-id="95368-105"> 提供了统一编程模型，用于生成面向服务的应用程序。</span><span class="sxs-lookup"><span data-stu-id="95368-105"> provides a unified programming model for building service-oriented applications.</span></span> <span data-ttu-id="95368-106">此编程模型保持一致且独立于部署服务的运行时环境。</span><span class="sxs-lookup"><span data-stu-id="95368-106">This programming model remains consistent and is independent of the run-time environment in which the service is deployed.</span></span> <span data-ttu-id="95368-107">实际上，这意味着不管使用什么宿主选项，服务的代码看起来都非常类似。</span><span class="sxs-lookup"><span data-stu-id="95368-107">In practice, this means that the code for your services looks much the same whatever the hosting option.</span></span>  
  
 <span data-ttu-id="95368-108">这些宿主选项的范围是从在控制台应用程序内运行到在服务器环境（如在由 Internet 信息服务 (IIS) 或由 Windows 进程激活服务 (WAS) 管理的工作进程内运行的 Windows 服务）中运行。</span><span class="sxs-lookup"><span data-stu-id="95368-108">These hosting options range from running inside a console application to server environments such as a Windows service running within a worker process managed by Internet Information Services (IIS) or by Windows Process Activation Service (WAS).</span></span> <span data-ttu-id="95368-109">开发人员选择可满足服务的部署要求的宿主环境。</span><span class="sxs-lookup"><span data-stu-id="95368-109">Developers choose the hosting environment that satisfies the service's deployment requirements.</span></span> <span data-ttu-id="95368-110">这些要求可能源自部署应用程序的平台，它必须发送和接收消息的传输，或者进程回收的类型和为确保足够可用性所需的其他进程管理，或者某些其他管理或可靠性要求。</span><span class="sxs-lookup"><span data-stu-id="95368-110">These requirements might derive from the platform on which the application is deployed, the transport on which it must send and receive messages, or on the type of process recycling and other process management required to ensure adequate availability, or on some other management or reliability requirements.</span></span> <span data-ttu-id="95368-111">下一节提供了有关宿主选项的信息和指南。</span><span class="sxs-lookup"><span data-stu-id="95368-111">The next section provides information and guidance on hosting options.</span></span>  
  
## <a name="hosting-options"></a><span data-ttu-id="95368-112">宿主选项</span><span class="sxs-lookup"><span data-stu-id="95368-112">Hosting Options</span></span>  
  
#### <a name="self-hosting-in-a-managed-application"></a><span data-ttu-id="95368-113">托管应用程序中的自承载</span><span class="sxs-lookup"><span data-stu-id="95368-113">Self-Hosting in a Managed Application</span></span>  
 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]<span data-ttu-id="95368-114"> 服务可以承载于任何托管应用程序中。</span><span class="sxs-lookup"><span data-stu-id="95368-114"> services can be hosted in any managed application.</span></span> <span data-ttu-id="95368-115">这是最灵活的选项，因为它需要部署最少的基础结构。</span><span class="sxs-lookup"><span data-stu-id="95368-115">This is the most flexible option because it requires the least infrastructure to deploy.</span></span> <span data-ttu-id="95368-116">在托管应用程序代码内嵌入服务代码，然后创建并打开 <xref:System.ServiceModel.ServiceHost> 的实例以使服务变为可用。</span><span class="sxs-lookup"><span data-stu-id="95368-116">You embed the code for the service inside the managed application code and then create and open an instance of the <xref:System.ServiceModel.ServiceHost> to make the service available.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="95368-117">[如何： 承载于托管应用程序的 WCF 服务](../../../docs/framework/wcf/how-to-host-a-wcf-service-in-a-managed-application.md)。</span><span class="sxs-lookup"><span data-stu-id="95368-117"> [How to: Host a WCF Service in a Managed Application](../../../docs/framework/wcf/how-to-host-a-wcf-service-in-a-managed-application.md).</span></span>  
  
 <span data-ttu-id="95368-118">此选项启用两个常见方案：在控制台应用程序内运行的 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务；以及丰富客户端应用程序，如基于 [!INCLUDE[avalon1](../../../includes/avalon1-md.md)] 或 Windows 窗体 (WinForms) 的应用程序。</span><span class="sxs-lookup"><span data-stu-id="95368-118">This option enables two common scenarios: [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] services running inside console applications and rich client applications such as those based on [!INCLUDE[avalon1](../../../includes/avalon1-md.md)] or Windows Forms (WinForms).</span></span> <span data-ttu-id="95368-119">在应用程序的开发阶段中，将 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务承载于控制台应用程序内通常是很有用的。</span><span class="sxs-lookup"><span data-stu-id="95368-119">Hosting a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service inside a console application is typically useful during the application's development phase.</span></span> <span data-ttu-id="95368-120">这使服务变得容易调试，从中跟踪信息以查明应用程序内发生的情况变得更加方便，以及通过将其复制到新的位置进行来回移动变得更加轻松。</span><span class="sxs-lookup"><span data-stu-id="95368-120">This makes them easy to debug, easy to get trace information from to find out what is happening inside of the application, and easy to move around by copying them to new locations.</span></span> <span data-ttu-id="95368-121">此宿主选项还使丰富客户端应用程序（如 [!INCLUDE[avalon2](../../../includes/avalon2-md.md)] 和 WinForms 应用程序）与外部世界的通信变得很容易。</span><span class="sxs-lookup"><span data-stu-id="95368-121">This hosting option also makes it easy for rich client applications, such as [!INCLUDE[avalon2](../../../includes/avalon2-md.md)] and WinForms applications, to communicate with the outside world.</span></span> <span data-ttu-id="95368-122">例如，一个将 [!INCLUDE[avalon2](../../../includes/avalon2-md.md)] 用于其用户界面并作为 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务主机的对等协作客户端，允许其他客户端连接到它并共享信息。</span><span class="sxs-lookup"><span data-stu-id="95368-122">For example, a peer-to-peer collaboration client that uses [!INCLUDE[avalon2](../../../includes/avalon2-md.md)] for its user interface and also hosts a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service that allows other clients to connect to it and share information.</span></span>  
  
#### <a name="managed-windows-services"></a><span data-ttu-id="95368-123">托管 Windows 服务</span><span class="sxs-lookup"><span data-stu-id="95368-123">Managed Windows Services</span></span>  
 <span data-ttu-id="95368-124">此宿主选项包括注册 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务作为托管 Windows 服务（以前称为 NT 服务）承载于其中的应用程序域 (AppDomain)，以便服务的进程生存期由 Windows 服务的服务控制管理器 (SCM) 控制。</span><span class="sxs-lookup"><span data-stu-id="95368-124">This hosting option consists of registering the application domain (AppDomain) that hosts an [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service as a managed Windows Service (formerly known as NT service) so that the process lifetime of the service is controlled by the service control manager (SCM) for Windows services.</span></span> <span data-ttu-id="95368-125">与自承载选项一样，此类型的宿主环境要求作为应用程序的一部分编写某些宿主代码。</span><span class="sxs-lookup"><span data-stu-id="95368-125">Like the self-hosting option, this type of hosting environment requires that some hosting code is written as part of the application.</span></span> <span data-ttu-id="95368-126">通过使服务从 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 类以及从 <xref:System.ServiceProcess.ServiceBase> 服务协定接口继承，将该服务同时实现为 Windows 服务和 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务。</span><span class="sxs-lookup"><span data-stu-id="95368-126">The service is implemented as both a Windows Service and as an [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service by causing it to inherit from the <xref:System.ServiceProcess.ServiceBase> class as well as from an [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service contract interface.</span></span> <span data-ttu-id="95368-127">然后创建 <xref:System.ServiceModel.ServiceHost> ，在被重写的 <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29> 方法内打开它并在被重写的 <xref:System.ServiceProcess.ServiceBase.OnStop> 方法内关闭它。</span><span class="sxs-lookup"><span data-stu-id="95368-127">The <xref:System.ServiceModel.ServiceHost> is then created and opened within an overridden <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29> method and closed within an overridden <xref:System.ServiceProcess.ServiceBase.OnStop> method.</span></span> <span data-ttu-id="95368-128">还必须实现从 <xref:System.Configuration.Install.Installer> 继承的安装程序类，以允许 Installutil.exe 工具将程序安装为 Windows 服务。</span><span class="sxs-lookup"><span data-stu-id="95368-128">An installer class that inherits from <xref:System.Configuration.Install.Installer> must also be implemented to allow the program to be installed as a Windows Service by the Installutil.exe tool.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="95368-129">[如何： 承载 WCF 服务中托管的 Windows 服务](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-a-managed-windows-service.md)。</span><span class="sxs-lookup"><span data-stu-id="95368-129"> [How to: Host a WCF Service in a Managed Windows Service](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-a-managed-windows-service.md).</span></span> <span data-ttu-id="95368-130">在未激活消息的安全环境中，由托管 Windows 服务宿主选项启用的方案是承载于 IIS 之外、长时间运行的 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务的方案。</span><span class="sxs-lookup"><span data-stu-id="95368-130">The scenario enabled by the managed Windows Service hosting option is that of a long-running [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service hosted outside of IIS in a secure environment that is not message-activated.</span></span> <span data-ttu-id="95368-131">服务的生存期改由操作系统控制。</span><span class="sxs-lookup"><span data-stu-id="95368-131">The lifetime of the service is controlled instead by the operating system.</span></span> <span data-ttu-id="95368-132">此宿主选项在 Windows 的所有版本中都是可用的。</span><span class="sxs-lookup"><span data-stu-id="95368-132">This hosting option is available in all versions of Windows.</span></span>  
  
#### <a name="internet-information-services-iis"></a><span data-ttu-id="95368-133">Internet 信息服务 (IIS)</span><span class="sxs-lookup"><span data-stu-id="95368-133">Internet Information Services (IIS)</span></span>  
 <span data-ttu-id="95368-134">IIS 宿主选项与 [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] 集成在一起，并使用这些技术提供的功能，如进程回收、空闲关闭、进程状况监视和基于消息的激活。</span><span class="sxs-lookup"><span data-stu-id="95368-134">The IIS hosting option is integrated with [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] and uses the features these technologies offer, such as process recycling, idle shutdown, process health monitoring, and message-based activation.</span></span> <span data-ttu-id="95368-135">在 [!INCLUDE[wxp](../../../includes/wxp-md.md)] 和 [!INCLUDE[ws2003](../../../includes/ws2003-md.md)] 操作系统上，这是作为必须高度可用且高度可伸缩的 Web 服务应用程序宿主的首选解决方案。</span><span class="sxs-lookup"><span data-stu-id="95368-135">On the [!INCLUDE[wxp](../../../includes/wxp-md.md)] and [!INCLUDE[ws2003](../../../includes/ws2003-md.md)] operating systems, this is the preferred solution for hosting Web service applications that must be highly available and highly scalable.</span></span> <span data-ttu-id="95368-136">IIS 还提供了客户期望企业级服务器产品具有的集成可管理性。</span><span class="sxs-lookup"><span data-stu-id="95368-136">IIS also offers the integrated manageability that customers expect from an enterprise-class server product.</span></span> <span data-ttu-id="95368-137">此宿主选项要求正确配置 IIS，但不需要编写任何承载代码作为应用程序的一部分。</span><span class="sxs-lookup"><span data-stu-id="95368-137">This hosting option requires that IIS be properly configured, but it does not require that any hosting code be written as part of the application.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="95368-138"> 如何为 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务配置 IIS 托管，请参阅 [How to: Host a WCF Service in IIS](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-iis.md).</span><span class="sxs-lookup"><span data-stu-id="95368-138"> how to configure IIS hosting for a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service, see [How to: Host a WCF Service in IIS](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-iis.md).</span></span>  
  
 <span data-ttu-id="95368-139">请注意，以 IIS 为宿主的服务只能使用 HTTP 传输。</span><span class="sxs-lookup"><span data-stu-id="95368-139">Note that IIS-hosted services can only use the HTTP transport.</span></span> <span data-ttu-id="95368-140">它在 IIS 5.1 中的实现在 [!INCLUDE[wxp](../../../includes/wxp-md.md)]中引入了一些限制。</span><span class="sxs-lookup"><span data-stu-id="95368-140">Its implementation in IIS 5.1 has introduced some limitations in [!INCLUDE[wxp](../../../includes/wxp-md.md)].</span></span> <span data-ttu-id="95368-141">在 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 上由 IIS 5.1 为 [!INCLUDE[wxp](../../../includes/wxp-md.md)] 服务提供的基于消息的激活阻止同一计算机上任何其他自承载的 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务使用端口 80 进行通信。</span><span class="sxs-lookup"><span data-stu-id="95368-141">The message-based activation provided for an [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service by IIS 5.1 on [!INCLUDE[wxp](../../../includes/wxp-md.md)] blocks any other self-hosted [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service on the same computer from using port 80 to communicate.</span></span> <span data-ttu-id="95368-142">在[!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 上由 [!INCLUDE[iis601](../../../includes/iis601-md.md)] 承载时， [!INCLUDE[ws2003](../../../includes/ws2003-md.md)]服务可以在与其他应用程序相同的 AppDomain/应用程序池/工作进程中运行。</span><span class="sxs-lookup"><span data-stu-id="95368-142">[!INCLUDE[indigo2](../../../includes/indigo2-md.md)] services can run in the same AppDomain/Application Pool/Worker Process as other applications when hosted by [!INCLUDE[iis601](../../../includes/iis601-md.md)] on [!INCLUDE[ws2003](../../../includes/ws2003-md.md)].</span></span> <span data-ttu-id="95368-143">但是，由于 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 和 [!INCLUDE[iis601](../../../includes/iis601-md.md)] 都使用内核模式 HTTP 堆栈 (HTTP.sys)，因此 [!INCLUDE[iis601](../../../includes/iis601-md.md)] 可以与在同一计算机上运行的其他自承载 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 服务共享端口 80，这与 IIS 5.1 是不同的。</span><span class="sxs-lookup"><span data-stu-id="95368-143">But because [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] and [!INCLUDE[iis601](../../../includes/iis601-md.md)] both use the kernel-mode HTTP stack (HTTP.sys), [!INCLUDE[iis601](../../../includes/iis601-md.md)] can share port 80 with other self-hosted [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] services running on the same machine, unlike IIS 5.1.</span></span>  
  
#### <a name="windows-process-activation-service-was"></a><span data-ttu-id="95368-144">Windows 进程激活服务 (WAS)</span><span class="sxs-lookup"><span data-stu-id="95368-144">Windows Process Activation Service (WAS)</span></span>  
 <span data-ttu-id="95368-145">Windows 进程激活服务 (WAS) 是在 [!INCLUDE[lserver](../../../includes/lserver-md.md)] 上也可用的 [!INCLUDE[wv](../../../includes/wv-md.md)]的新进程激活机制。</span><span class="sxs-lookup"><span data-stu-id="95368-145">Windows Process Activation Service (WAS) is the new process activation mechanism for the [!INCLUDE[lserver](../../../includes/lserver-md.md)] that is also available on [!INCLUDE[wv](../../../includes/wv-md.md)].</span></span> <span data-ttu-id="95368-146">它保留了熟悉的 [!INCLUDE[iis601](../../../includes/iis601-md.md)] 进程模型（应用程序池和基于消息的进程激活）和承载功能（如快速失败保护、运行状况监视和回收），但是它从激活体系结构中移除了对 HTTP 的依赖。</span><span class="sxs-lookup"><span data-stu-id="95368-146">It retains the familiar [!INCLUDE[iis601](../../../includes/iis601-md.md)] process model (application pools and message-based process activation) and hosting features (such as rapid failure protection, health monitoring, and recycling), but it removes the dependency on HTTP from the activation architecture.</span></span> [!INCLUDE[iisver](../../../includes/iisver-md.md)]<span data-ttu-id="95368-147"> 使用 WAS 通过 HTTP 完成基于消息的激活。</span><span class="sxs-lookup"><span data-stu-id="95368-147"> uses WAS to accomplish message-based activation over HTTP.</span></span> <span data-ttu-id="95368-148">其他 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 组件也插入了 WAS，以通过 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] 支持的其他协议（如 TCP、MSMQ 和命名管道）提供基于消息的激活。</span><span class="sxs-lookup"><span data-stu-id="95368-148">Additional [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] components also plug into WAS to provide message-based activation over the other protocols that [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] supports, such as TCP, MSMQ, and named pipes.</span></span> <span data-ttu-id="95368-149">这样，使用通信协议的应用程序就可以使用 IIS 功能（如进程回收、快速失败保护）和仅对基于 HTTP 的应用程序可用的通用配置系统。</span><span class="sxs-lookup"><span data-stu-id="95368-149">This allows applications that use communication protocols to use the IIS features such as process recycling, rapid fail protection, and the common configuration system that were only available to HTTP-based applications.</span></span>  
  
 <span data-ttu-id="95368-150">此承载选项要求正确配置 WAS，但不需要编写任何承载代码作为应用程序的一部分。</span><span class="sxs-lookup"><span data-stu-id="95368-150">This hosting option requires that WAS be properly configured, but it does not require you to write any hosting code as part of the application.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="95368-151"> 如何配置 WAS 托管，请参阅 [How to: Host a WCF Service in WAS](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-was.md).</span><span class="sxs-lookup"><span data-stu-id="95368-151"> how to configure WAS hosting, see [How to: Host a WCF Service in WAS](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-was.md).</span></span>  
  
## <a name="choosing-a-hosting-environment"></a><span data-ttu-id="95368-152">选择宿主环境</span><span class="sxs-lookup"><span data-stu-id="95368-152">Choosing a Hosting Environment</span></span>  
 <span data-ttu-id="95368-153">下表汇总了与每个宿主选项关联的一些主要优点和方案。</span><span class="sxs-lookup"><span data-stu-id="95368-153">The following table summarizes some of the key benefits and scenarios associated with each of the hosting options.</span></span>  
  
|<span data-ttu-id="95368-154">宿主环境</span><span class="sxs-lookup"><span data-stu-id="95368-154">Hosting Environment</span></span>|<span data-ttu-id="95368-155">常见方案</span><span class="sxs-lookup"><span data-stu-id="95368-155">Common Scenarios</span></span>|<span data-ttu-id="95368-156">主要优点和限制</span><span class="sxs-lookup"><span data-stu-id="95368-156">Key Benefits and Limitations</span></span>|  
|-------------------------|----------------------|----------------------------------|  
|<span data-ttu-id="95368-157">托管应用程序（“自承载”）</span><span class="sxs-lookup"><span data-stu-id="95368-157">Managed Application ("Self-Hosted")</span></span>|<span data-ttu-id="95368-158">的在开发过程中使用控制台应用程序。</span><span class="sxs-lookup"><span data-stu-id="95368-158">-   Console applications used during development.</span></span><br /><span data-ttu-id="95368-159">丰富 WinForm 和[!INCLUDE[avalon2](../../../includes/avalon2-md.md)]访问服务的客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="95368-159">-   Rich WinForm and [!INCLUDE[avalon2](../../../includes/avalon2-md.md)] client applications accessing services.</span></span>|<span data-ttu-id="95368-160">-灵活。</span><span class="sxs-lookup"><span data-stu-id="95368-160">-   Flexible.</span></span><br /><span data-ttu-id="95368-161">-易于部署。</span><span class="sxs-lookup"><span data-stu-id="95368-161">-   Easy to deploy.</span></span><br /><span data-ttu-id="95368-162">-不服务的企业解决方案。</span><span class="sxs-lookup"><span data-stu-id="95368-162">-   Not an enterprise solution for services.</span></span>|  
|<span data-ttu-id="95368-163">Windows 服务（以前称为 NT 服务）</span><span class="sxs-lookup"><span data-stu-id="95368-163">Windows Services (formerly known as NT services)</span></span>|<span data-ttu-id="95368-164">-A 长时间运行[!INCLUDE[indigo2](../../../includes/indigo2-md.md)]承载于 IIS 外部的服务。</span><span class="sxs-lookup"><span data-stu-id="95368-164">-   A long-running [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service hosted outside of IIS.</span></span>|<span data-ttu-id="95368-165">服务进程生存期由操作系统，未激活消息控制。</span><span class="sxs-lookup"><span data-stu-id="95368-165">-   Service process lifetime controlled by the operating system, not message-activated.</span></span><br /><span data-ttu-id="95368-166">-所有版本的都支持的 Windows。</span><span class="sxs-lookup"><span data-stu-id="95368-166">-   Supported by all versions of Windows.</span></span><br /><span data-ttu-id="95368-167">安全环境。</span><span class="sxs-lookup"><span data-stu-id="95368-167">-   Secure environment.</span></span>|  
|<span data-ttu-id="95368-168">IIS 5.1、 [!INCLUDE[iis601](../../../includes/iis601-md.md)]</span><span class="sxs-lookup"><span data-stu-id="95368-168">IIS 5.1, [!INCLUDE[iis601](../../../includes/iis601-md.md)]</span></span>|<span data-ttu-id="95368-169">-运行[!INCLUDE[indigo2](../../../includes/indigo2-md.md)]服务具有并行[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]使用 HTTP 协议在 Internet 上的内容。</span><span class="sxs-lookup"><span data-stu-id="95368-169">-   Running a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service side-by-side with [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] content on the Internet using the HTTP protocol.</span></span>|<span data-ttu-id="95368-170">-进程回收。</span><span class="sxs-lookup"><span data-stu-id="95368-170">-   Process recycling.</span></span><br /><span data-ttu-id="95368-171">-空闲时关闭。</span><span class="sxs-lookup"><span data-stu-id="95368-171">-   Idle shutdown.</span></span><br /><span data-ttu-id="95368-172">-进程状况监视。</span><span class="sxs-lookup"><span data-stu-id="95368-172">-   Process health monitoring.</span></span><br /><span data-ttu-id="95368-173">-基于消息的激活。</span><span class="sxs-lookup"><span data-stu-id="95368-173">-   Message-based activation.</span></span><br /><span data-ttu-id="95368-174">-仅限 HTTP。</span><span class="sxs-lookup"><span data-stu-id="95368-174">-   HTTP only.</span></span>|  
|<span data-ttu-id="95368-175">Windows 进程激活服务 (WAS)</span><span class="sxs-lookup"><span data-stu-id="95368-175">Windows Process Activation Service (WAS)</span></span>|<span data-ttu-id="95368-176">-运行[!INCLUDE[indigo2](../../../includes/indigo2-md.md)]服务，而不使用各种传输协议在 Internet 上安装 IIS。</span><span class="sxs-lookup"><span data-stu-id="95368-176">-   Running a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service without installing IIS on the Internet using various transport protocols.</span></span>|<span data-ttu-id="95368-177">IIS 不是必需的。</span><span class="sxs-lookup"><span data-stu-id="95368-177">-   IIS is not required.</span></span><br /><span data-ttu-id="95368-178">-进程回收。</span><span class="sxs-lookup"><span data-stu-id="95368-178">-   Process recycling.</span></span><br /><span data-ttu-id="95368-179">-空闲时关闭。</span><span class="sxs-lookup"><span data-stu-id="95368-179">-   Idle shutdown.</span></span><br /><span data-ttu-id="95368-180">-进程状况监视。</span><span class="sxs-lookup"><span data-stu-id="95368-180">-   Process health monitoring.</span></span><br /><span data-ttu-id="95368-181">-基于消息的激活。</span><span class="sxs-lookup"><span data-stu-id="95368-181">-   Message-based activation.</span></span><br /><span data-ttu-id="95368-182">-适用于 HTTP、 TCP、 命名的管道和 MSMQ。</span><span class="sxs-lookup"><span data-stu-id="95368-182">-   Works with HTTP, TCP, named pipes, and MSMQ.</span></span>|  
|<span data-ttu-id="95368-183">IIS 7.0</span><span class="sxs-lookup"><span data-stu-id="95368-183">IIS 7.0</span></span>|<span data-ttu-id="95368-184">-运行[!INCLUDE[indigo2](../../../includes/indigo2-md.md)]服务，其中包括[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]内容。</span><span class="sxs-lookup"><span data-stu-id="95368-184">-   Running a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service with [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] content.</span></span><br /><span data-ttu-id="95368-185">-运行[!INCLUDE[indigo2](../../../includes/indigo2-md.md)]服务使用各种传输协议在 Internet 上。</span><span class="sxs-lookup"><span data-stu-id="95368-185">-   Running a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service on the Internet using various transport protocols.</span></span>|<span data-ttu-id="95368-186">-已好处。</span><span class="sxs-lookup"><span data-stu-id="95368-186">-   WAS benefits.</span></span><br /><span data-ttu-id="95368-187">-与集成[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]和 IIS 内容。</span><span class="sxs-lookup"><span data-stu-id="95368-187">-   Integrated with [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] and IIS content.</span></span>|  
  
 <span data-ttu-id="95368-188">宿主环境的选择取决于部署它的 Windows 版本、它要求发送消息的传输以及它要求的进程和应用程序域回收的类型。</span><span class="sxs-lookup"><span data-stu-id="95368-188">The choice of a hosting environment depends on the version of Windows on which it is deployed, the transports it requires to send messages and the type of process and application domain recycling it requires.</span></span> <span data-ttu-id="95368-189">下表汇总了与这些要求相关的数据。</span><span class="sxs-lookup"><span data-stu-id="95368-189">The following table summarizes the data related to these requirements.</span></span>  
  
|<span data-ttu-id="95368-190">宿主环境</span><span class="sxs-lookup"><span data-stu-id="95368-190">Hosting Environment</span></span>|<span data-ttu-id="95368-191">平台可用性</span><span class="sxs-lookup"><span data-stu-id="95368-191">Platform Availability</span></span>|<span data-ttu-id="95368-192">支持的传输</span><span class="sxs-lookup"><span data-stu-id="95368-192">Transports Supported</span></span>|<span data-ttu-id="95368-193">进程和 AppDomain 回收</span><span class="sxs-lookup"><span data-stu-id="95368-193">Process and AppDomain Recycling</span></span>|  
|-------------------------|---------------------------|--------------------------|-------------------------------------|  
|<span data-ttu-id="95368-194">托管应用程序（“自承载”）</span><span class="sxs-lookup"><span data-stu-id="95368-194">Managed Applications ("Self-Hosted")</span></span>|[!INCLUDE[wxp](../../../includes/wxp-md.md)]<span data-ttu-id="95368-195">, [!INCLUDE[ws2003](../../../includes/ws2003-md.md)], [!INCLUDE[wv](../../../includes/wv-md.md)],</span><span class="sxs-lookup"><span data-stu-id="95368-195">, [!INCLUDE[ws2003](../../../includes/ws2003-md.md)], [!INCLUDE[wv](../../../includes/wv-md.md)],</span></span><br /><br /> [!INCLUDE[lserver](../../../includes/lserver-md.md)]|<span data-ttu-id="95368-196">HTTP；</span><span class="sxs-lookup"><span data-stu-id="95368-196">HTTP,</span></span><br /><br /> <span data-ttu-id="95368-197">net.tcp；</span><span class="sxs-lookup"><span data-stu-id="95368-197">net.tcp,</span></span><br /><br /> <span data-ttu-id="95368-198">net.pipe；</span><span class="sxs-lookup"><span data-stu-id="95368-198">net.pipe,</span></span><br /><br /> <span data-ttu-id="95368-199">net.msmq</span><span class="sxs-lookup"><span data-stu-id="95368-199">net.msmq</span></span>|<span data-ttu-id="95368-200">No</span><span class="sxs-lookup"><span data-stu-id="95368-200">No</span></span>|  
|<span data-ttu-id="95368-201">Windows 服务（以前称为 NT 服务）</span><span class="sxs-lookup"><span data-stu-id="95368-201">Windows Services (formerly known as NT services)</span></span>|[!INCLUDE[wxp](../../../includes/wxp-md.md)]<span data-ttu-id="95368-202">, [!INCLUDE[ws2003](../../../includes/ws2003-md.md)], [!INCLUDE[wv](../../../includes/wv-md.md)],</span><span class="sxs-lookup"><span data-stu-id="95368-202">, [!INCLUDE[ws2003](../../../includes/ws2003-md.md)], [!INCLUDE[wv](../../../includes/wv-md.md)],</span></span><br /><br /> [!INCLUDE[lserver](../../../includes/lserver-md.md)]|<span data-ttu-id="95368-203">HTTP；</span><span class="sxs-lookup"><span data-stu-id="95368-203">HTTP,</span></span><br /><br /> <span data-ttu-id="95368-204">net.tcp；</span><span class="sxs-lookup"><span data-stu-id="95368-204">net.tcp,</span></span><br /><br /> <span data-ttu-id="95368-205">net.pipe；</span><span class="sxs-lookup"><span data-stu-id="95368-205">net.pipe,</span></span><br /><br /> <span data-ttu-id="95368-206">net.msmq</span><span class="sxs-lookup"><span data-stu-id="95368-206">net.msmq</span></span>|<span data-ttu-id="95368-207">No</span><span class="sxs-lookup"><span data-stu-id="95368-207">No</span></span>|  
|<span data-ttu-id="95368-208">IIS 5.1</span><span class="sxs-lookup"><span data-stu-id="95368-208">IIS 5.1</span></span>|[!INCLUDE[wxp](../../../includes/wxp-md.md)]|<span data-ttu-id="95368-209">HTTP</span><span class="sxs-lookup"><span data-stu-id="95368-209">HTTP</span></span>|<span data-ttu-id="95368-210">是</span><span class="sxs-lookup"><span data-stu-id="95368-210">Yes</span></span>|  
|[!INCLUDE[iis601](../../../includes/iis601-md.md)]|[!INCLUDE[ws2003](../../../includes/ws2003-md.md)]|<span data-ttu-id="95368-211">HTTP</span><span class="sxs-lookup"><span data-stu-id="95368-211">HTTP</span></span>|<span data-ttu-id="95368-212">是</span><span class="sxs-lookup"><span data-stu-id="95368-212">Yes</span></span>|  
|<span data-ttu-id="95368-213">Windows 进程激活服务 (WAS)</span><span class="sxs-lookup"><span data-stu-id="95368-213">Windows Process Activation Service (WAS)</span></span>|[!INCLUDE[wv](../../../includes/wv-md.md)]<span data-ttu-id="95368-214">, [!INCLUDE[lserver](../../../includes/lserver-md.md)]</span><span class="sxs-lookup"><span data-stu-id="95368-214">, [!INCLUDE[lserver](../../../includes/lserver-md.md)]</span></span>|<span data-ttu-id="95368-215">HTTP；</span><span class="sxs-lookup"><span data-stu-id="95368-215">HTTP,</span></span><br /><br /> <span data-ttu-id="95368-216">net.tcp；</span><span class="sxs-lookup"><span data-stu-id="95368-216">net.tcp,</span></span><br /><br /> <span data-ttu-id="95368-217">net.pipe；</span><span class="sxs-lookup"><span data-stu-id="95368-217">net.pipe,</span></span><br /><br /> <span data-ttu-id="95368-218">net.msmq</span><span class="sxs-lookup"><span data-stu-id="95368-218">net.msmq</span></span>|<span data-ttu-id="95368-219">是</span><span class="sxs-lookup"><span data-stu-id="95368-219">Yes</span></span>|  
  
 <span data-ttu-id="95368-220">值得注意的是，从不受信任的主机运行服务或任何扩展会危害安全。</span><span class="sxs-lookup"><span data-stu-id="95368-220">It is important to note that running a service or any extension from an untrusted host compromises security.</span></span> <span data-ttu-id="95368-221">另请注意，通过模拟打开 <xref:System.ServiceModel.ServiceHost> 时，应用程序必须确保未注销用户，例如通过缓存用户的 <xref:System.Security.Principal.WindowsIdentity> 。</span><span class="sxs-lookup"><span data-stu-id="95368-221">Also, note that when opening a <xref:System.ServiceModel.ServiceHost> under impersonation, an application must ensure that the user is not logged off, for example by caching the <xref:System.Security.Principal.WindowsIdentity> of the user.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="95368-222">另请参阅</span><span class="sxs-lookup"><span data-stu-id="95368-222">See Also</span></span>  
 [<span data-ttu-id="95368-223">系统要求</span><span class="sxs-lookup"><span data-stu-id="95368-223">System Requirements</span></span>](../../../docs/framework/wcf/wcf-system-requirements.md)  
 [<span data-ttu-id="95368-224">基本编程生命周期</span><span class="sxs-lookup"><span data-stu-id="95368-224">Basic Programming Lifecycle</span></span>](../../../docs/framework/wcf/basic-programming-lifecycle.md)  
 [<span data-ttu-id="95368-225">实现服务协定</span><span class="sxs-lookup"><span data-stu-id="95368-225">Implementing Service Contracts</span></span>](../../../docs/framework/wcf/implementing-service-contracts.md)  
 [<span data-ttu-id="95368-226">如何：在 IIS 中承载 WCF 服务</span><span class="sxs-lookup"><span data-stu-id="95368-226">How to: Host a WCF Service in IIS</span></span>](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-iis.md)  
 [<span data-ttu-id="95368-227">如何：在 WAS 中承载 WCF 服务</span><span class="sxs-lookup"><span data-stu-id="95368-227">How to: Host a WCF Service in WAS</span></span>](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-was.md)  
 [<span data-ttu-id="95368-228">如何： 承载 WCF 服务中托管的 Windows 服务</span><span class="sxs-lookup"><span data-stu-id="95368-228">How to: Host a WCF Service in a Managed Windows Service</span></span>](../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-a-managed-windows-service.md)  
 [<span data-ttu-id="95368-229">如何：在托管应用程序中托管 WCF 服务</span><span class="sxs-lookup"><span data-stu-id="95368-229">How to: Host a WCF Service in a Managed Application</span></span>](../../../docs/framework/wcf/how-to-host-a-wcf-service-in-a-managed-application.md)
