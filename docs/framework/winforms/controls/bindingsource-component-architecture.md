---
title: BindingSource 组件体系结构
ms.date: 03/30/2017
helpviewer_keywords:
- BindingSource component [Windows Forms], architecture
- Windows Forms, data binding
- BindingSource component [Windows Forms], about BindingSource component
- data binding [Windows Forms], BindingSource component
ms.assetid: 7bc69c90-8a11-48b1-9336-3adab5b41591
ms.openlocfilehash: b0334bd7a0bc5ff46c43fd7ee549422d98c35efe
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/04/2018
ms.locfileid: "33529255"
---
# <a name="bindingsource-component-architecture"></a><span data-ttu-id="adb6f-102">BindingSource 组件体系结构</span><span class="sxs-lookup"><span data-stu-id="adb6f-102">BindingSource Component Architecture</span></span>
<span data-ttu-id="adb6f-103">与<xref:System.Windows.Forms.BindingSource>组件时，普遍，你可以将所有 Windows 窗体控件都绑定到数据源。</span><span class="sxs-lookup"><span data-stu-id="adb6f-103">With the <xref:System.Windows.Forms.BindingSource> component, you can universally bind  all Windows Forms controls to data sources.</span></span>  
  
 <span data-ttu-id="adb6f-104"><xref:System.Windows.Forms.BindingSource>组件简化将控件绑定到数据源的过程，并通过传统数据绑定有以下优点：</span><span class="sxs-lookup"><span data-stu-id="adb6f-104">The <xref:System.Windows.Forms.BindingSource> component simplifies the process of binding controls to a data source and provides the following advantages over traditional data binding:</span></span>  
  
-   <span data-ttu-id="adb6f-105">使设计时绑定到业务对象。</span><span class="sxs-lookup"><span data-stu-id="adb6f-105">Enables design-time binding to business objects.</span></span>  
  
-   <span data-ttu-id="adb6f-106">封装<xref:System.Windows.Forms.CurrencyManager>功能，并公开<xref:System.Windows.Forms.CurrencyManager>在设计时的事件。</span><span class="sxs-lookup"><span data-stu-id="adb6f-106">Encapsulates <xref:System.Windows.Forms.CurrencyManager> functionality and exposes <xref:System.Windows.Forms.CurrencyManager> events at design time.</span></span>  
  
-   <span data-ttu-id="adb6f-107">简化了创建支持列表<xref:System.ComponentModel.IBindingList>通过提供列表更改通知，本质上不支持列表的数据源更改通知的接口。</span><span class="sxs-lookup"><span data-stu-id="adb6f-107">Simplifies creating a list that supports the <xref:System.ComponentModel.IBindingList> interface by providing list change notification for data sources that do not natively support list change notification.</span></span>  
  
-   <span data-ttu-id="adb6f-108">提供的一个扩展点<xref:System.ComponentModel.IBindingList.AddNew%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="adb6f-108">Provides an extensibility point for the <xref:System.ComponentModel.IBindingList.AddNew%2A?displayProperty=nameWithType> method.</span></span>  
  
-   <span data-ttu-id="adb6f-109">提供数据源和控件之间的间接级别。</span><span class="sxs-lookup"><span data-stu-id="adb6f-109">Provides a level of indirection between the data source and the control.</span></span> <span data-ttu-id="adb6f-110">当在运行时可更改数据源时，这种间接方式很重要。</span><span class="sxs-lookup"><span data-stu-id="adb6f-110">This indirection is important when the data source may change at run time.</span></span>  
  
-   <span data-ttu-id="adb6f-111">专门与其他数据相关的 Windows 窗体控件，互操作<xref:System.Windows.Forms.BindingNavigator>和<xref:System.Windows.Forms.DataGridView>控件。</span><span class="sxs-lookup"><span data-stu-id="adb6f-111">Interoperates with other data-related Windows Forms controls, specifically the <xref:System.Windows.Forms.BindingNavigator> and the <xref:System.Windows.Forms.DataGridView> controls.</span></span>  
  
 <span data-ttu-id="adb6f-112">出于这些原因，<xref:System.Windows.Forms.BindingSource>组件是将 Windows 窗体控件绑定到数据源的首选的方法。</span><span class="sxs-lookup"><span data-stu-id="adb6f-112">For these reasons, the <xref:System.Windows.Forms.BindingSource> component is the preferred way to bind your Windows Forms controls to data sources.</span></span>  
  
## <a name="bindingsource-features"></a><span data-ttu-id="adb6f-113">BindingSource 功能</span><span class="sxs-lookup"><span data-stu-id="adb6f-113">BindingSource Features</span></span>  
 <span data-ttu-id="adb6f-114"><xref:System.Windows.Forms.BindingSource>组件提供了一些功能，为控件绑定到数据。</span><span class="sxs-lookup"><span data-stu-id="adb6f-114">The <xref:System.Windows.Forms.BindingSource> component provides several features for binding controls to data.</span></span> <span data-ttu-id="adb6f-115">通过这些功能，你可以实现与几乎无需进行编码您的大多数数据绑定方案。</span><span class="sxs-lookup"><span data-stu-id="adb6f-115">With these features, you can implement most data-binding scenarios with almost no coding on your part.</span></span>  
  
 <span data-ttu-id="adb6f-116"><xref:System.Windows.Forms.BindingSource>组件完成此操作通过用于访问许多不同类型的数据源提供一致的接口。</span><span class="sxs-lookup"><span data-stu-id="adb6f-116">The <xref:System.Windows.Forms.BindingSource> component accomplishes this by providing a consistent interface for accessing many different kinds of data sources.</span></span> <span data-ttu-id="adb6f-117">这意味着到任何类型的绑定使用相同的过程。</span><span class="sxs-lookup"><span data-stu-id="adb6f-117">This means that you use the same procedure for binding to any type.</span></span> <span data-ttu-id="adb6f-118">例如，你可以附加<xref:System.Windows.Forms.BindingSource.DataSource%2A>属性<xref:System.Data.DataSet>或业务对象与两种情况下使用的相同的一套属性、 方法和事件来操作数据源。</span><span class="sxs-lookup"><span data-stu-id="adb6f-118">For example, you can attach the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property to a <xref:System.Data.DataSet> or to a business object and in both cases you use the same set of properties, methods, and events to manipulate the data source.</span></span>  
  
 <span data-ttu-id="adb6f-119">一致的接口提供<xref:System.Windows.Forms.BindingSource>组件极大地简化了将数据绑定到控件的过程。</span><span class="sxs-lookup"><span data-stu-id="adb6f-119">The consistent interface provided by the <xref:System.Windows.Forms.BindingSource> component greatly simplifies the process of binding data to controls.</span></span> <span data-ttu-id="adb6f-120">为提供的数据源类型的更改通知，<xref:System.Windows.Forms.BindingSource>组件自动通信控件和数据源之间的更改。</span><span class="sxs-lookup"><span data-stu-id="adb6f-120">For data-source types that provide change notification, the <xref:System.Windows.Forms.BindingSource> component automatically communicates changes between the control and the data source.</span></span> <span data-ttu-id="adb6f-121">对于不提供更改通知的数据源类型，事件会提供能够让你引发更改通知。</span><span class="sxs-lookup"><span data-stu-id="adb6f-121">For data-source types that do not provide change notification, events are provided that let you raise change notifications.</span></span> <span data-ttu-id="adb6f-122">以下列表显示了支持的功能<xref:System.Windows.Forms.BindingSource>组件：</span><span class="sxs-lookup"><span data-stu-id="adb6f-122">The following list shows the features supported by the <xref:System.Windows.Forms.BindingSource> component:</span></span>  
  
-   <span data-ttu-id="adb6f-123">间接寻址。</span><span class="sxs-lookup"><span data-stu-id="adb6f-123">Indirection.</span></span>  
  
-   <span data-ttu-id="adb6f-124">货币管理。</span><span class="sxs-lookup"><span data-stu-id="adb6f-124">Currency management.</span></span>  
  
-   <span data-ttu-id="adb6f-125">作为列表的数据源。</span><span class="sxs-lookup"><span data-stu-id="adb6f-125">Data source as a list.</span></span>  
  
-   <span data-ttu-id="adb6f-126"><xref:System.Windows.Forms.BindingSource> 作为<xref:System.ComponentModel.IBindingList>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-126"><xref:System.Windows.Forms.BindingSource> as an <xref:System.ComponentModel.IBindingList>.</span></span>  
  
-   <span data-ttu-id="adb6f-127">创建自定义项。</span><span class="sxs-lookup"><span data-stu-id="adb6f-127">Custom item creation.</span></span>  
  
-   <span data-ttu-id="adb6f-128">创建事务性项。</span><span class="sxs-lookup"><span data-stu-id="adb6f-128">Transactional item creation.</span></span>  
  
-   <span data-ttu-id="adb6f-129"><xref:System.Collections.IEnumerable> 支持。</span><span class="sxs-lookup"><span data-stu-id="adb6f-129"><xref:System.Collections.IEnumerable> support.</span></span>  
  
-   <span data-ttu-id="adb6f-130">设计时支持。</span><span class="sxs-lookup"><span data-stu-id="adb6f-130">Design-time support.</span></span>  
  
-   <span data-ttu-id="adb6f-131">静态<xref:System.Windows.Forms.ListBindingHelper>方法。</span><span class="sxs-lookup"><span data-stu-id="adb6f-131">Static <xref:System.Windows.Forms.ListBindingHelper> methods.</span></span>  
  
-   <span data-ttu-id="adb6f-132">排序和筛选与<xref:System.ComponentModel.IBindingListView>接口。</span><span class="sxs-lookup"><span data-stu-id="adb6f-132">Sorting and filtering with the <xref:System.ComponentModel.IBindingListView> interface.</span></span>  
  
-   <span data-ttu-id="adb6f-133">与集成<xref:System.Windows.Forms.BindingNavigator>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-133">Integration with <xref:System.Windows.Forms.BindingNavigator>.</span></span>  
  
### <a name="indirection"></a><span data-ttu-id="adb6f-134">间接寻址</span><span class="sxs-lookup"><span data-stu-id="adb6f-134">Indirection</span></span>  
 <span data-ttu-id="adb6f-135"><xref:System.Windows.Forms.BindingSource>组件提供一定程度的间接性控件与数据源之间。</span><span class="sxs-lookup"><span data-stu-id="adb6f-135">The <xref:System.Windows.Forms.BindingSource> component provides a level of indirection between a control and a data source.</span></span> <span data-ttu-id="adb6f-136">而不是将控件绑定到数据源的直接，你将控件绑定到<xref:System.Windows.Forms.BindingSource>，并附加到的数据源<xref:System.Windows.Forms.BindingSource>组件的<xref:System.Windows.Forms.BindingSource.DataSource%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="adb6f-136">Instead of binding a control directly to a data source, you bind the control to a <xref:System.Windows.Forms.BindingSource>, and you attach the data source to the <xref:System.Windows.Forms.BindingSource> component's <xref:System.Windows.Forms.BindingSource.DataSource%2A> property.</span></span>  
  
 <span data-ttu-id="adb6f-137">使用此级别的间接寻址，你可以更改数据源，而重置控件绑定。</span><span class="sxs-lookup"><span data-stu-id="adb6f-137">With this level of indirection, you can change the data source without resetting the control binding.</span></span> <span data-ttu-id="adb6f-138">这为你提供以下功能：</span><span class="sxs-lookup"><span data-stu-id="adb6f-138">This gives you the following capabilities:</span></span>  
  
-   <span data-ttu-id="adb6f-139">你可以将附加<xref:System.Windows.Forms.BindingSource>到不同的数据源时保留当前的控件绑定。</span><span class="sxs-lookup"><span data-stu-id="adb6f-139">You can attach the <xref:System.Windows.Forms.BindingSource> to different data sources while retaining the current control bindings.</span></span>  
  
-   <span data-ttu-id="adb6f-140">你可以更改数据源中的项，并通知绑定的控件。</span><span class="sxs-lookup"><span data-stu-id="adb6f-140">You can change items in the data source and notify bound controls.</span></span> <span data-ttu-id="adb6f-141">有关详细信息，请参阅[如何： 使用 BindingSource Windows 窗体控件中反映数据源更新](../../../../docs/framework/winforms/controls/reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md)。</span><span class="sxs-lookup"><span data-stu-id="adb6f-141">For more information, see [How to: Reflect Data Source Updates in a Windows Forms Control with the BindingSource](../../../../docs/framework/winforms/controls/reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md).</span></span>  
  
-   <span data-ttu-id="adb6f-142">可以将绑定到<xref:System.Type>而不是内存中的对象。</span><span class="sxs-lookup"><span data-stu-id="adb6f-142">You can bind to a <xref:System.Type> instead of an object in memory.</span></span> <span data-ttu-id="adb6f-143">有关详细信息，请参阅[如何： 将 Windows 窗体控件绑定到类型](../../../../docs/framework/winforms/controls/how-to-bind-a-windows-forms-control-to-a-type.md)。</span><span class="sxs-lookup"><span data-stu-id="adb6f-143">For more information, see [How to: Bind a Windows Forms Control to a Type](../../../../docs/framework/winforms/controls/how-to-bind-a-windows-forms-control-to-a-type.md).</span></span> <span data-ttu-id="adb6f-144">你可以随后绑定到的对象在运行时。</span><span class="sxs-lookup"><span data-stu-id="adb6f-144">You can then bind to an object at run time.</span></span>  
  
### <a name="currency-management"></a><span data-ttu-id="adb6f-145">当前项管理</span><span class="sxs-lookup"><span data-stu-id="adb6f-145">Currency Management</span></span>  
 <span data-ttu-id="adb6f-146"><xref:System.Windows.Forms.BindingSource>组件实现<xref:System.Windows.Forms.ICurrencyManagerProvider>处理货币管理为你的接口。</span><span class="sxs-lookup"><span data-stu-id="adb6f-146">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface to handle currency management for you.</span></span> <span data-ttu-id="adb6f-147">与<xref:System.Windows.Forms.ICurrencyManagerProvider>接口，你还可以访问的货币管理器<xref:System.Windows.Forms.BindingSource>，另一个的货币管理器除了<xref:System.Windows.Forms.BindingSource>绑定到同一<xref:System.Windows.Forms.BindingSource.DataMember%2A>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-147">With the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface, you can also access to the currency manager for a <xref:System.Windows.Forms.BindingSource>, in addition to the currency manager for another <xref:System.Windows.Forms.BindingSource> bound to the same <xref:System.Windows.Forms.BindingSource.DataMember%2A>.</span></span>  
  
 <span data-ttu-id="adb6f-148"><xref:System.Windows.Forms.BindingSource>组件封装<xref:System.Windows.Forms.CurrencyManager>功能，并公开了最常用<xref:System.Windows.Forms.CurrencyManager>属性和事件。</span><span class="sxs-lookup"><span data-stu-id="adb6f-148">The <xref:System.Windows.Forms.BindingSource> component encapsulates <xref:System.Windows.Forms.CurrencyManager> functionality and exposes the most common <xref:System.Windows.Forms.CurrencyManager> properties and events.</span></span> <span data-ttu-id="adb6f-149">下表介绍一些与货币管理相关的成员。</span><span class="sxs-lookup"><span data-stu-id="adb6f-149">The following table describes some of the members related to currency management.</span></span>  
  
 <span data-ttu-id="adb6f-150"><xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="adb6f-150"><xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> property</span></span>  
 <span data-ttu-id="adb6f-151">获取与关联的货币管理器<xref:System.Windows.Forms.BindingSource>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-151">Gets the currency manager associated with the <xref:System.Windows.Forms.BindingSource>.</span></span>  
  
 <span data-ttu-id="adb6f-152"><xref:System.Windows.Forms.ICurrencyManagerProvider.GetRelatedCurrencyManager%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="adb6f-152"><xref:System.Windows.Forms.ICurrencyManagerProvider.GetRelatedCurrencyManager%2A> method</span></span>  
 <span data-ttu-id="adb6f-153">如果没有另一个<xref:System.Windows.Forms.BindingSource>绑定到指定的数据成员，请获取其流量管理器。</span><span class="sxs-lookup"><span data-stu-id="adb6f-153">If there is another <xref:System.Windows.Forms.BindingSource> bound to the specified data member, gets its currency manager.</span></span>  
  
 <span data-ttu-id="adb6f-154"><xref:System.Windows.Forms.BindingSource.Current%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="adb6f-154"><xref:System.Windows.Forms.BindingSource.Current%2A> property</span></span>  
 <span data-ttu-id="adb6f-155">获取数据源的当前项。</span><span class="sxs-lookup"><span data-stu-id="adb6f-155">Gets the current item of the data source.</span></span>  
  
 <span data-ttu-id="adb6f-156"><xref:System.Windows.Forms.BindingSource.Position%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="adb6f-156"><xref:System.Windows.Forms.BindingSource.Position%2A> property</span></span>  
 <span data-ttu-id="adb6f-157">获取或设置基础列表中的当前位置。</span><span class="sxs-lookup"><span data-stu-id="adb6f-157">Gets or sets the current position in the underlying list.</span></span>  
  
 <span data-ttu-id="adb6f-158"><xref:System.Windows.Forms.BindingSource.EndEdit%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="adb6f-158"><xref:System.Windows.Forms.BindingSource.EndEdit%2A> method</span></span>  
 <span data-ttu-id="adb6f-159">将挂起的更改应用于基础数据源。</span><span class="sxs-lookup"><span data-stu-id="adb6f-159">Applies pending changes to the underlying data source.</span></span>  
  
 <span data-ttu-id="adb6f-160"><xref:System.Windows.Forms.BindingSource.CancelEdit%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="adb6f-160"><xref:System.Windows.Forms.BindingSource.CancelEdit%2A> method</span></span>  
 <span data-ttu-id="adb6f-161">取消当前的编辑操作。</span><span class="sxs-lookup"><span data-stu-id="adb6f-161">Cancels the current edit operation.</span></span>  
  
### <a name="data-source-as-a-list"></a><span data-ttu-id="adb6f-162">作为列表的数据源</span><span class="sxs-lookup"><span data-stu-id="adb6f-162">Data Source as a List</span></span>  
 <span data-ttu-id="adb6f-163"><xref:System.Windows.Forms.BindingSource>组件实现<xref:System.ComponentModel.IBindingListView>和<xref:System.ComponentModel.ITypedList>接口。</span><span class="sxs-lookup"><span data-stu-id="adb6f-163">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.IBindingListView> and <xref:System.ComponentModel.ITypedList> interfaces.</span></span> <span data-ttu-id="adb6f-164">与此实现中，你可以使用<xref:System.Windows.Forms.BindingSource>组件自身作为数据源，而无需任何外部存储。</span><span class="sxs-lookup"><span data-stu-id="adb6f-164">With this implementation, you can use the <xref:System.Windows.Forms.BindingSource> component itself as a data source, without any external storage.</span></span>  
  
 <span data-ttu-id="adb6f-165">当<xref:System.Windows.Forms.BindingSource>组件连接到数据源，它公开作为列表的数据源。</span><span class="sxs-lookup"><span data-stu-id="adb6f-165">When the <xref:System.Windows.Forms.BindingSource> component is attached to a data source, it exposes the data source as a list.</span></span>  
  
 <span data-ttu-id="adb6f-166"><xref:System.Windows.Forms.BindingSource.DataSource%2A>属性可以设置为几个数据源。</span><span class="sxs-lookup"><span data-stu-id="adb6f-166">The <xref:System.Windows.Forms.BindingSource.DataSource%2A> property can be set to several data sources.</span></span> <span data-ttu-id="adb6f-167">其中包括类型、 对象和类型的列表。</span><span class="sxs-lookup"><span data-stu-id="adb6f-167">These include types, objects, and lists of types.</span></span> <span data-ttu-id="adb6f-168">产生的数据源将公开为一个列表。</span><span class="sxs-lookup"><span data-stu-id="adb6f-168">The resulting data source will be exposed as a list.</span></span> <span data-ttu-id="adb6f-169">下表显示了一些常见的数据源和生成的列表计算。</span><span class="sxs-lookup"><span data-stu-id="adb6f-169">The following table shows some of the common data sources and the resulting list evaluation.</span></span>  
  
|<span data-ttu-id="adb6f-170">数据源属性</span><span class="sxs-lookup"><span data-stu-id="adb6f-170">DataSource property</span></span>|<span data-ttu-id="adb6f-171">列表结果</span><span class="sxs-lookup"><span data-stu-id="adb6f-171">List results</span></span>|  
|-------------------------|------------------|  
|<span data-ttu-id="adb6f-172">空引用（在 Visual Basic 中为 `Nothing`）</span><span class="sxs-lookup"><span data-stu-id="adb6f-172">A null reference (`Nothing` in Visual Basic)</span></span>|<span data-ttu-id="adb6f-173">一个空<xref:System.ComponentModel.IBindingList>的对象。</span><span class="sxs-lookup"><span data-stu-id="adb6f-173">An empty <xref:System.ComponentModel.IBindingList> of objects.</span></span> <span data-ttu-id="adb6f-174">将项添加到所添加项的类型设置的列表。</span><span class="sxs-lookup"><span data-stu-id="adb6f-174">Adding an item sets the list to the type of the added item.</span></span>|  
|<span data-ttu-id="adb6f-175">空引用 (`Nothing`在 Visual Basic 中) 与<xref:System.Windows.Forms.BindingSource.DataMember%2A>设置</span><span class="sxs-lookup"><span data-stu-id="adb6f-175">A null reference (`Nothing` in Visual Basic) with <xref:System.Windows.Forms.BindingSource.DataMember%2A> set</span></span>|<span data-ttu-id="adb6f-176">不支持;引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-176">Not supported; raises <xref:System.ArgumentException>.</span></span>|  
|<span data-ttu-id="adb6f-177">非列表类型或者"T"类型的对象</span><span class="sxs-lookup"><span data-stu-id="adb6f-177">Non-list type or object of type "T"</span></span>|<span data-ttu-id="adb6f-178">一个空<xref:System.ComponentModel.IBindingList>的"T"类型。</span><span class="sxs-lookup"><span data-stu-id="adb6f-178">An empty <xref:System.ComponentModel.IBindingList> of type "T".</span></span>|  
|<span data-ttu-id="adb6f-179">数组实例</span><span class="sxs-lookup"><span data-stu-id="adb6f-179">Array instance</span></span>|<span data-ttu-id="adb6f-180"><xref:System.ComponentModel.IBindingList>包含数组元素。</span><span class="sxs-lookup"><span data-stu-id="adb6f-180">An <xref:System.ComponentModel.IBindingList> containing the array elements.</span></span>|  
|<span data-ttu-id="adb6f-181"><xref:System.Collections.IEnumerable> 实例</span><span class="sxs-lookup"><span data-stu-id="adb6f-181"><xref:System.Collections.IEnumerable> instance</span></span>|<span data-ttu-id="adb6f-182"><xref:System.ComponentModel.IBindingList>包含<xref:System.Collections.IEnumerable>项</span><span class="sxs-lookup"><span data-stu-id="adb6f-182">An <xref:System.ComponentModel.IBindingList> containing the <xref:System.Collections.IEnumerable> items</span></span>|  
|<span data-ttu-id="adb6f-183">列出"T"的包含类型的实例</span><span class="sxs-lookup"><span data-stu-id="adb6f-183">List instance containing type "T"</span></span>|<span data-ttu-id="adb6f-184"><xref:System.ComponentModel.IBindingList>包含"T"类型的实例。</span><span class="sxs-lookup"><span data-stu-id="adb6f-184">An <xref:System.ComponentModel.IBindingList> instance containing type "T".</span></span>|  
  
 <span data-ttu-id="adb6f-185">此外，<xref:System.Windows.Forms.BindingSource.DataSource%2A>可以设置为其他列表类型，如<xref:System.ComponentModel.IListSource>和<xref:System.ComponentModel.ITypedList>，和<xref:System.Windows.Forms.BindingSource>将适当地处理。</span><span class="sxs-lookup"><span data-stu-id="adb6f-185">Additionally, <xref:System.Windows.Forms.BindingSource.DataSource%2A> can be set to other list types, such as <xref:System.ComponentModel.IListSource> and <xref:System.ComponentModel.ITypedList>, and the <xref:System.Windows.Forms.BindingSource> will handle them appropriately.</span></span> <span data-ttu-id="adb6f-186">在这种情况下，列表中包含该类型应具有默认构造函数。</span><span class="sxs-lookup"><span data-stu-id="adb6f-186">In this case, the type that is contained in the list should have a default constructor.</span></span>  
  
### <a name="bindingsource-as-an-ibindinglist"></a><span data-ttu-id="adb6f-187">作为 IBindingList BindingSource</span><span class="sxs-lookup"><span data-stu-id="adb6f-187">BindingSource as an IBindingList</span></span>  
 <span data-ttu-id="adb6f-188"><xref:System.Windows.Forms.BindingSource>组件提供用于访问和操作作为基础数据成员<xref:System.ComponentModel.IBindingList>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-188">The <xref:System.Windows.Forms.BindingSource> component provides members for accessing and manipulating the underlying data as an <xref:System.ComponentModel.IBindingList>.</span></span> <span data-ttu-id="adb6f-189">下表描述了其中几个成员。</span><span class="sxs-lookup"><span data-stu-id="adb6f-189">The following table describes some of these members.</span></span>  
  
|<span data-ttu-id="adb6f-190">成员</span><span class="sxs-lookup"><span data-stu-id="adb6f-190">Member</span></span>|<span data-ttu-id="adb6f-191">描述</span><span class="sxs-lookup"><span data-stu-id="adb6f-191">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="adb6f-192"><xref:System.Windows.Forms.BindingSource.List%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="adb6f-192"><xref:System.Windows.Forms.BindingSource.List%2A> property</span></span>|<span data-ttu-id="adb6f-193">获取来自计算的结果的列表<xref:System.Windows.Forms.BindingSource.DataSource%2A>或<xref:System.Windows.Forms.BindingSource.DataMember%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="adb6f-193">Gets the list that results from the evaluation of the <xref:System.Windows.Forms.BindingSource.DataSource%2A> or <xref:System.Windows.Forms.BindingSource.DataMember%2A> properties.</span></span>|  
|<span data-ttu-id="adb6f-194"><xref:System.Windows.Forms.BindingSource.AddNew%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="adb6f-194"><xref:System.Windows.Forms.BindingSource.AddNew%2A> method</span></span>|<span data-ttu-id="adb6f-195">在基础列表中添加一个新项。</span><span class="sxs-lookup"><span data-stu-id="adb6f-195">Adds a new item to the underlying list.</span></span> <span data-ttu-id="adb6f-196">适用于实现的数据源<xref:System.ComponentModel.IBindingList>接口，并允许添加项 (即，<xref:System.Windows.Forms.BindingSource.AllowNew%2A>属性设置为`true`)。</span><span class="sxs-lookup"><span data-stu-id="adb6f-196">Applies to data sources that implement the <xref:System.ComponentModel.IBindingList> interface and allow adding items (that is, the <xref:System.Windows.Forms.BindingSource.AllowNew%2A> property is set to `true`).</span></span>|  
  
### <a name="custom-item-creation"></a><span data-ttu-id="adb6f-197">创建自定义项</span><span class="sxs-lookup"><span data-stu-id="adb6f-197">Custom Item Creation</span></span>  
 <span data-ttu-id="adb6f-198">你可以处理<xref:System.Windows.Forms.BindingSource.AddingNew>事件，以便提供你自己的项创建逻辑。</span><span class="sxs-lookup"><span data-stu-id="adb6f-198">You can handle the <xref:System.Windows.Forms.BindingSource.AddingNew> event to provide your own item-creation logic.</span></span> <span data-ttu-id="adb6f-199"><xref:System.Windows.Forms.BindingSource.AddingNew>事件发生在新对象添加到之前<xref:System.Windows.Forms.BindingSource>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-199">The <xref:System.Windows.Forms.BindingSource.AddingNew> event occurs before a new object is added to the <xref:System.Windows.Forms.BindingSource>.</span></span> <span data-ttu-id="adb6f-200">之后，将引发此事件<xref:System.Windows.Forms.BindingSource.AddNew%2A>调用方法，但之前对基础列表添加新项。</span><span class="sxs-lookup"><span data-stu-id="adb6f-200">This event is raised after the <xref:System.Windows.Forms.BindingSource.AddNew%2A> method is called, but before the new item is added to the underlying list.</span></span> <span data-ttu-id="adb6f-201">通过处理此事件，则可以提供自定义项创建行为，而不必从派生<xref:System.Windows.Forms.BindingSource>类。</span><span class="sxs-lookup"><span data-stu-id="adb6f-201">By handling this event, you can provide custom item creation behavior without deriving from the <xref:System.Windows.Forms.BindingSource> class.</span></span> <span data-ttu-id="adb6f-202">有关详细信息，请参阅[如何： 使用 Windows 窗体 BindingSource 自定义项添加](../../../../docs/framework/winforms/controls/how-to-customize-item-addition-with-the-windows-forms-bindingsource.md)。</span><span class="sxs-lookup"><span data-stu-id="adb6f-202">For more information, see [How to: Customize Item Addition with the Windows Forms BindingSource](../../../../docs/framework/winforms/controls/how-to-customize-item-addition-with-the-windows-forms-bindingsource.md).</span></span>  
  
### <a name="transactional-item-creation"></a><span data-ttu-id="adb6f-203">创建事务性项</span><span class="sxs-lookup"><span data-stu-id="adb6f-203">Transactional Item Creation</span></span>  
 <span data-ttu-id="adb6f-204"><xref:System.Windows.Forms.BindingSource>组件实现<xref:System.ComponentModel.ICancelAddNew>接口，可创建事务的项。</span><span class="sxs-lookup"><span data-stu-id="adb6f-204">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.ICancelAddNew> interface, which enables transactional item creation.</span></span> <span data-ttu-id="adb6f-205">通过使用调用临时创建一个新项后<xref:System.Windows.Forms.BindingSource.AddNew%2A>，可能会提交或回滚通过以下方式添加：</span><span class="sxs-lookup"><span data-stu-id="adb6f-205">After a new item is provisionally created by using a call to <xref:System.Windows.Forms.BindingSource.AddNew%2A>, the addition may be committed or rolled back in the following ways:</span></span>  
  
-   <span data-ttu-id="adb6f-206"><xref:System.ComponentModel.ICancelAddNew.EndNew%2A>方法显式提交挂起的添加。</span><span class="sxs-lookup"><span data-stu-id="adb6f-206">The <xref:System.ComponentModel.ICancelAddNew.EndNew%2A> method will explicitly commit the pending addition.</span></span>  
  
-   <span data-ttu-id="adb6f-207">执行另一个集合操作，如插入、 移除或移动，将隐式提交挂起的添加。</span><span class="sxs-lookup"><span data-stu-id="adb6f-207">Performing another collection operation, such as an insertion, removal, or move, will implicitly commit the pending addition.</span></span>  
  
-   <span data-ttu-id="adb6f-208"><xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>方法将回滚挂起的新如果方法不已提交。</span><span class="sxs-lookup"><span data-stu-id="adb6f-208">The <xref:System.ComponentModel.ICancelAddNew.CancelNew%2A> method will roll back the pending addition if the method has not already been committed.</span></span>  
  
### <a name="ienumerable-support"></a><span data-ttu-id="adb6f-209">IEnumerable 支持</span><span class="sxs-lookup"><span data-stu-id="adb6f-209">IEnumerable Support</span></span>  
 <span data-ttu-id="adb6f-210"><xref:System.Windows.Forms.BindingSource>组件，将控件绑定到<xref:System.Collections.IEnumerable>数据源。</span><span class="sxs-lookup"><span data-stu-id="adb6f-210">The <xref:System.Windows.Forms.BindingSource> component enables binding controls to <xref:System.Collections.IEnumerable> data sources.</span></span> <span data-ttu-id="adb6f-211">与此组件，你可以将绑定到数据源如<xref:System.Data.SqlClient.SqlDataReader?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-211">With this component, you can bind to a data source such as a <xref:System.Data.SqlClient.SqlDataReader?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="adb6f-212">当<xref:System.Collections.IEnumerable>数据源分配给<xref:System.Windows.Forms.BindingSource>组件，<xref:System.Windows.Forms.BindingSource>创建<xref:System.ComponentModel.IBindingList>，并将添加的内容<xref:System.Collections.IEnumerable>到列表的数据源。</span><span class="sxs-lookup"><span data-stu-id="adb6f-212">When an <xref:System.Collections.IEnumerable> data source is assigned to the <xref:System.Windows.Forms.BindingSource> component, the <xref:System.Windows.Forms.BindingSource> creates an <xref:System.ComponentModel.IBindingList> and adds the contents of the <xref:System.Collections.IEnumerable> data source to the list.</span></span>  
  
### <a name="design-time-support"></a><span data-ttu-id="adb6f-213">设计时支持</span><span class="sxs-lookup"><span data-stu-id="adb6f-213">Design-Time Support</span></span>  
 <span data-ttu-id="adb6f-214">某些对象类型不能在设计时，例如从工厂类，创建的对象或 Web 服务返回的对象创建。</span><span class="sxs-lookup"><span data-stu-id="adb6f-214">Some object types cannot be created at design time, such as objects created from a factory class, or objects returned by a Web service.</span></span> <span data-ttu-id="adb6f-215">即使在你的控件可以绑定到的内存中没有任何对象，您有时需要在设计时，将控件绑定到这些类型。</span><span class="sxs-lookup"><span data-stu-id="adb6f-215">You may sometimes have to bind your controls to these types at design time, even though there is no object in memory to which your controls can bind.</span></span> <span data-ttu-id="adb6f-216">例如，可能需要标签的列标题<xref:System.Windows.Forms.DataGridView>控件替换你自定义类型的公共属性的名称。</span><span class="sxs-lookup"><span data-stu-id="adb6f-216">You may, for example, need to label the column headers of a <xref:System.Windows.Forms.DataGridView> control with the names of your custom type's public properties.</span></span>  
  
 <span data-ttu-id="adb6f-217">若要支持此方案中，<xref:System.Windows.Forms.BindingSource>组件支持绑定到<xref:System.Type>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-217">To support this scenario, the <xref:System.Windows.Forms.BindingSource> component supports binding to a <xref:System.Type>.</span></span> <span data-ttu-id="adb6f-218">当分配<xref:System.Type>到<xref:System.Windows.Forms.BindingSource.DataSource%2A>属性，<xref:System.Windows.Forms.BindingSource>组件创建一个空<xref:System.ComponentModel.BindingList%601>的<xref:System.Type>项。</span><span class="sxs-lookup"><span data-stu-id="adb6f-218">When you assign a <xref:System.Type> to the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property, the <xref:System.Windows.Forms.BindingSource> component creates an empty <xref:System.ComponentModel.BindingList%601> of <xref:System.Type> items.</span></span> <span data-ttu-id="adb6f-219">你随后将绑定到任何控件<xref:System.Windows.Forms.BindingSource>在设计时或在运行时，将与属性或类型的架构存在收到警报的组件。</span><span class="sxs-lookup"><span data-stu-id="adb6f-219">Any controls you subsequently bind to the <xref:System.Windows.Forms.BindingSource> component will be alerted to the presence of the properties or schema of your type at design time, or at run time.</span></span> <span data-ttu-id="adb6f-220">有关详细信息，请参阅[如何： 将 Windows 窗体控件绑定到类型](../../../../docs/framework/winforms/controls/how-to-bind-a-windows-forms-control-to-a-type.md)。</span><span class="sxs-lookup"><span data-stu-id="adb6f-220">For more information, see [How to: Bind a Windows Forms Control to a Type](../../../../docs/framework/winforms/controls/how-to-bind-a-windows-forms-control-to-a-type.md).</span></span>  
  
### <a name="static-listbindinghelper-methods"></a><span data-ttu-id="adb6f-221">静态 ListBindingHelper 方法</span><span class="sxs-lookup"><span data-stu-id="adb6f-221">Static ListBindingHelper Methods</span></span>  
 <span data-ttu-id="adb6f-222"><xref:System.Windows.Forms.BindingContext?displayProperty=nameWithType>， <xref:System.Windows.Forms.CurrencyManager?displayProperty=nameWithType>，和<xref:System.Windows.Forms.BindingSource>类型所有的共享通用逻辑，以生成从列表`DataSource` / `DataMember`对。</span><span class="sxs-lookup"><span data-stu-id="adb6f-222">The <xref:System.Windows.Forms.BindingContext?displayProperty=nameWithType>, <xref:System.Windows.Forms.CurrencyManager?displayProperty=nameWithType>, and <xref:System.Windows.Forms.BindingSource> types all share common logic to generate a list from a `DataSource`/`DataMember` pair.</span></span> <span data-ttu-id="adb6f-223">此外，此公共逻辑公开以供控件作者和其他第三方在下列`static`方法：</span><span class="sxs-lookup"><span data-stu-id="adb6f-223">Additionally, this common logic is publicly exposed for use by control authors and other third parties in the following `static` methods:</span></span>  
  
-   <xref:System.Windows.Forms.ListBindingHelper.GetListItemProperties%2A>  
  
-   <span data-ttu-id="adb6f-224"><xref:System.Windows.Forms.ListBindingHelper.GetList%2A>。</span><span class="sxs-lookup"><span data-stu-id="adb6f-224"><xref:System.Windows.Forms.ListBindingHelper.GetList%2A>.</span></span>  
  
-   <xref:System.Windows.Forms.ListBindingHelper.GetListName%2A>  
  
-   <xref:System.Windows.Forms.ListBindingHelper.GetListItemType%2A>  
  
### <a name="sorting-and-filtering-with-the-ibindinglistview-interface"></a><span data-ttu-id="adb6f-225">排序和筛选与 IBindingListView 接口</span><span class="sxs-lookup"><span data-stu-id="adb6f-225">Sorting and Filtering with the IBindingListView Interface</span></span>  
 <span data-ttu-id="adb6f-226"><xref:System.Windows.Forms.BindingSource>组件实现<xref:System.ComponentModel.IBindingListView>接口，该扩展接口<xref:System.ComponentModel.IBindingList>接口。</span><span class="sxs-lookup"><span data-stu-id="adb6f-226">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.IBindingListView> interface, which extends the <xref:System.ComponentModel.IBindingList> interface.</span></span> <span data-ttu-id="adb6f-227"><xref:System.ComponentModel.IBindingList>提供单个列排序和<xref:System.ComponentModel.IBindingListView>提供高级排序和筛选。</span><span class="sxs-lookup"><span data-stu-id="adb6f-227">The <xref:System.ComponentModel.IBindingList> offers single column sorting and the <xref:System.ComponentModel.IBindingListView> offers advanced sorting and filtering.</span></span> <span data-ttu-id="adb6f-228">与<xref:System.ComponentModel.IBindingListView>、 可以进行排序和筛选器项在数据源，如果数据源还实现这些接口之一。</span><span class="sxs-lookup"><span data-stu-id="adb6f-228">With <xref:System.ComponentModel.IBindingListView>, you can sort and filter items in the data source, if the data source also implements one of these interfaces.</span></span> <span data-ttu-id="adb6f-229"><xref:System.Windows.Forms.BindingSource>组件不提供这些成员的引用实现。</span><span class="sxs-lookup"><span data-stu-id="adb6f-229">The <xref:System.Windows.Forms.BindingSource> component does not provide a reference implementation of these members.</span></span> <span data-ttu-id="adb6f-230">相反，将调用转发给基础列表。</span><span class="sxs-lookup"><span data-stu-id="adb6f-230">Instead, calls are forwarded to the underlying list.</span></span>  
  
 <span data-ttu-id="adb6f-231">下表介绍用于排序和筛选的属性。</span><span class="sxs-lookup"><span data-stu-id="adb6f-231">The following table describes the properties you use for sorting and filtering.</span></span>  
  
|<span data-ttu-id="adb6f-232">成员</span><span class="sxs-lookup"><span data-stu-id="adb6f-232">Member</span></span>|<span data-ttu-id="adb6f-233">描述</span><span class="sxs-lookup"><span data-stu-id="adb6f-233">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="adb6f-234"><xref:System.Windows.Forms.BindingSource.Filter%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="adb6f-234"><xref:System.Windows.Forms.BindingSource.Filter%2A> property</span></span>|<span data-ttu-id="adb6f-235">如果数据源是 <xref:System.ComponentModel.IBindingListView>，则获取或设置用于筛选已查看的行的表达式。</span><span class="sxs-lookup"><span data-stu-id="adb6f-235">If the data source is an <xref:System.ComponentModel.IBindingListView>, gets or sets the expression used to filter which rows are viewed.</span></span>|  
|<span data-ttu-id="adb6f-236"><xref:System.Windows.Forms.BindingSource.Sort%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="adb6f-236"><xref:System.Windows.Forms.BindingSource.Sort%2A> property</span></span>|<span data-ttu-id="adb6f-237">如果数据源是 <xref:System.ComponentModel.IBindingList>，则获取或设置用于排序的列名称并对顺序信息进行排序。</span><span class="sxs-lookup"><span data-stu-id="adb6f-237">If the data source is an <xref:System.ComponentModel.IBindingList>, gets or sets a column name used for sorting and sort order information.</span></span><br /><br /> <span data-ttu-id="adb6f-238">-或-</span><span class="sxs-lookup"><span data-stu-id="adb6f-238">-or-</span></span><br /><br /> <span data-ttu-id="adb6f-239">如果数据源是<xref:System.ComponentModel.IBindingListView>并支持高级排序，则获取用于排序和排序顺序的多个列名称</span><span class="sxs-lookup"><span data-stu-id="adb6f-239">If the data source is an <xref:System.ComponentModel.IBindingListView> and supports advanced sorting, gets multiple column names used for sorting and sort order</span></span>|  
  
### <a name="integration-with-bindingnavigator"></a><span data-ttu-id="adb6f-240">与 BindingNavigator 的集成</span><span class="sxs-lookup"><span data-stu-id="adb6f-240">Integration with BindingNavigator</span></span>  
 <span data-ttu-id="adb6f-241">你可以使用<xref:System.Windows.Forms.BindingSource>组件将任何 Windows 窗体控件绑定到数据源，但<xref:System.Windows.Forms.BindingNavigator>控件专门用于处理<xref:System.Windows.Forms.BindingSource>组件。</span><span class="sxs-lookup"><span data-stu-id="adb6f-241">You can use the <xref:System.Windows.Forms.BindingSource> component to bind any Windows Forms control to a data source, but the <xref:System.Windows.Forms.BindingNavigator> control is designed specifically to work with the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="adb6f-242"><xref:System.Windows.Forms.BindingNavigator>控件提供用户界面，用于控制<xref:System.Windows.Forms.BindingSource>组件的当前项。</span><span class="sxs-lookup"><span data-stu-id="adb6f-242">The <xref:System.Windows.Forms.BindingNavigator> control provides a user interface for controlling the <xref:System.Windows.Forms.BindingSource> component's current item.</span></span> <span data-ttu-id="adb6f-243">默认情况下，<xref:System.Windows.Forms.BindingNavigator>控件提供对应的导航方法的按钮<xref:System.Windows.Forms.BindingSource>组件。</span><span class="sxs-lookup"><span data-stu-id="adb6f-243">By default, the <xref:System.Windows.Forms.BindingNavigator> control provides buttons that correspond to the navigation methods on the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="adb6f-244">有关详细信息，请参阅[如何： 使用 Windows 窗体 BindingNavigator 控件导航数据](../../../../docs/framework/winforms/controls/how-to-navigate-data-with-the-windows-forms-bindingnavigator-control.md)。</span><span class="sxs-lookup"><span data-stu-id="adb6f-244">For more information, see [How to: Navigate Data with the Windows Forms BindingNavigator Control](../../../../docs/framework/winforms/controls/how-to-navigate-data-with-the-windows-forms-bindingnavigator-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="adb6f-245">请参阅</span><span class="sxs-lookup"><span data-stu-id="adb6f-245">See Also</span></span>  
 <xref:System.Windows.Forms.BindingSource>  
 <xref:System.Windows.Forms.BindingNavigator>  
 [<span data-ttu-id="adb6f-246">BindingSource 组件概述</span><span class="sxs-lookup"><span data-stu-id="adb6f-246">BindingSource Component Overview</span></span>](../../../../docs/framework/winforms/controls/bindingsource-component-overview.md)  
 [<span data-ttu-id="adb6f-247">BindingNavigator 控件</span><span class="sxs-lookup"><span data-stu-id="adb6f-247">BindingNavigator Control</span></span>](../../../../docs/framework/winforms/controls/bindingnavigator-control-windows-forms.md)  
 [<span data-ttu-id="adb6f-248">Windows 窗体数据绑定</span><span class="sxs-lookup"><span data-stu-id="adb6f-248">Windows Forms Data Binding</span></span>](../../../../docs/framework/winforms/windows-forms-data-binding.md)  
 [<span data-ttu-id="adb6f-249">在 Windows 窗体上使用的控件</span><span class="sxs-lookup"><span data-stu-id="adb6f-249">Controls to Use on Windows Forms</span></span>](../../../../docs/framework/winforms/controls/controls-to-use-on-windows-forms.md)  
 [<span data-ttu-id="adb6f-250">如何：将 Windows 窗体控件绑定到类型</span><span class="sxs-lookup"><span data-stu-id="adb6f-250">How to: Bind a Windows Forms Control to a Type</span></span>](../../../../docs/framework/winforms/controls/how-to-bind-a-windows-forms-control-to-a-type.md)  
 [<span data-ttu-id="adb6f-251">如何：使用 BindingSource 在 Windows 窗体控件中反映数据源更新</span><span class="sxs-lookup"><span data-stu-id="adb6f-251">How to: Reflect Data Source Updates in a Windows Forms Control with the BindingSource</span></span>](../../../../docs/framework/winforms/controls/reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md)
