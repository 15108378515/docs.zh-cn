---
title: 对象生存期事件
ms.date: 03/30/2017
helpviewer_keywords:
- events [WPF], ContentRendered
- events [WPF], Deactivated
- events [WPF], Unloaded
- Activated events [WPF]
- events [WPF], Loaded
- Application objects [WPF], lifetime events
- events [WPF], Activated
- ContentRendered events [WPF]
- Deactivated events [WPF]
- events [WPF], Initialized
- events [WPF], Closing
- Unloaded events [WPF]
- exit events [WPF]
- objects' lifetime events [WPF]
- Loaded events [WPF]
- Closing events [WPF]
- events [WPF], Closed
- Initialized events [WPF]
- Closed events [WPF]
- startup events [WPF]
- lifetime events of objects [WPF]
ms.assetid: face6fc7-465b-4502-bfe5-e88d2e729a78
ms.openlocfilehash: 02a6736fe54be4683044f648e9d5ed5e8a3d95dd
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/04/2018
ms.locfileid: "33547529"
---
# <a name="object-lifetime-events"></a><span data-ttu-id="7e07f-102">对象生存期事件</span><span class="sxs-lookup"><span data-stu-id="7e07f-102">Object Lifetime Events</span></span>
<span data-ttu-id="7e07f-103">本主题介绍表示对象生存期（创建、使用和销毁）中的阶段的特定 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 事件。</span><span class="sxs-lookup"><span data-stu-id="7e07f-103">This topic describes the specific [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events that signify stages in an object lifetime of creation, use, and destruction.</span></span>  
  

  
<a name="prerequisites"></a>   
## <a name="prerequisites"></a><span data-ttu-id="7e07f-104">系统必备</span><span class="sxs-lookup"><span data-stu-id="7e07f-104">Prerequisites</span></span>  
 <span data-ttu-id="7e07f-105">本主题假设你作为 [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 类的现有依赖属性的使用者已经对依赖属性有所了解，并且已经阅读了[依赖属性概述](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md)主题。</span><span class="sxs-lookup"><span data-stu-id="7e07f-105">This topic assumes that you understand dependency properties from the perspective of a consumer of existing dependency properties on [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] classes, and have read the [Dependency Properties Overview](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md) topic.</span></span> <span data-ttu-id="7e07f-106">若要理解本主题中的示例，还应当了解 [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]（请参阅 [XAML 概述 (WPF)](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)）并知道如何编写 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 应用程序。</span><span class="sxs-lookup"><span data-stu-id="7e07f-106">In order to follow the examples in this topic, you should also understand [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] (see [XAML Overview (WPF)](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)) and know how to write [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications.</span></span>  
  
<a name="intro"></a>   
## <a name="object-lifetime-events"></a><span data-ttu-id="7e07f-107">对象生存期事件</span><span class="sxs-lookup"><span data-stu-id="7e07f-107">Object Lifetime Events</span></span>  
 <span data-ttu-id="7e07f-108">Microsoft.NET Framework 托管代码中的所有对象都经过一组类似的生命周期、 创建、 使用和析构的阶段。</span><span class="sxs-lookup"><span data-stu-id="7e07f-108">All objects in Microsoft .NET Framework managed code go through a similar set of stages of life, creation, use, and destruction.</span></span> <span data-ttu-id="7e07f-109">许多对象还包括生命终止阶段，该阶段属于销毁阶段的一部分。</span><span class="sxs-lookup"><span data-stu-id="7e07f-109">Many objects also have a finalization stage of life that occurs as part of the destruction phase.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="7e07f-110"> 对象（更明确的说，[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 标识为元素的视觉对象）还具有对象生命的一系列常见阶段。</span><span class="sxs-lookup"><span data-stu-id="7e07f-110"> objects, more specifically the visual objects that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] identifies as elements, also have a set of common stages of object life.</span></span> <span data-ttu-id="7e07f-111">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 编程和应用程序模型将这些阶段作为一系列事件公开。</span><span class="sxs-lookup"><span data-stu-id="7e07f-111">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming and application models expose these stages as a series of events.</span></span> <span data-ttu-id="7e07f-112">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中有四种与生存期事件有关的主要类型对象 - 即常规元素、窗口元素、导航宿主和应用程序对象。</span><span class="sxs-lookup"><span data-stu-id="7e07f-112">There are four main types of objects in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] with respect to lifetime events; elements in general, window elements, navigation hosts, and application objects.</span></span> <span data-ttu-id="7e07f-113">窗口和导航宿主也都属于视觉对象（元素）这个较大的组。</span><span class="sxs-lookup"><span data-stu-id="7e07f-113">Windows and navigation hosts are also within the larger grouping of visual objects (elements).</span></span> <span data-ttu-id="7e07f-114">本主题首先介绍所有元素的通用生存期事件，然后介绍应用于应用程序定义、窗口或导航宿主的更具针对性的生存期事件。</span><span class="sxs-lookup"><span data-stu-id="7e07f-114">This topic describes the lifetime events that are common to all elements and then introduces the more specific ones that apply to application definitions, windows or navigation hosts.</span></span>  
  
<a name="common_events"></a>   
## <a name="common-lifetime-events-for-elements"></a><span data-ttu-id="7e07f-115">元素通用生存期事件</span><span class="sxs-lookup"><span data-stu-id="7e07f-115">Common Lifetime Events for Elements</span></span>  
 <span data-ttu-id="7e07f-116">任何 WPF 框架级别元素 (从派生的那些对象<xref:System.Windows.FrameworkElement>或<xref:System.Windows.FrameworkContentElement>) 具有三个常见的生存期事件： <xref:System.Windows.FrameworkElement.Initialized>， <xref:System.Windows.FrameworkElement.Loaded>，和<xref:System.Windows.FrameworkElement.Unloaded>。</span><span class="sxs-lookup"><span data-stu-id="7e07f-116">Any WPF framework-level element (those objects deriving from either <xref:System.Windows.FrameworkElement> or <xref:System.Windows.FrameworkContentElement>) has three common lifetime events: <xref:System.Windows.FrameworkElement.Initialized>, <xref:System.Windows.FrameworkElement.Loaded>, and <xref:System.Windows.FrameworkElement.Unloaded>.</span></span>  
  
### <a name="initialized"></a><span data-ttu-id="7e07f-117">Initialized</span><span class="sxs-lookup"><span data-stu-id="7e07f-117">Initialized</span></span>  
 <span data-ttu-id="7e07f-118"><xref:System.Windows.FrameworkElement.Initialized> 首先，会出现，并且大致对应给其构造函数调用的对象的初始化。</span><span class="sxs-lookup"><span data-stu-id="7e07f-118"><xref:System.Windows.FrameworkElement.Initialized> is raised first, and roughly corresponds to the initialization of the object by the call to its constructor.</span></span> <span data-ttu-id="7e07f-119">由于事件为响应初始化而发生，因此可以确保对象的所有属性均已设置。</span><span class="sxs-lookup"><span data-stu-id="7e07f-119">Because the event happens in response to initialization, you are guaranteed that all properties of the object are set.</span></span> <span data-ttu-id="7e07f-120">（动态资源或绑定等表达式用法除外；这些是不进行计算的表达式。）由于所有属性均都设置的序列的要求<xref:System.Windows.FrameworkElement.Initialized>所引起标记中定义的嵌套元素似乎首先，将按顺序的元素树中最深元素发生然后父直至根元素。</span><span class="sxs-lookup"><span data-stu-id="7e07f-120">(An exception is expression usages such as dynamic resources or binding; these will be unevaluated expressions.) As a consequence of the requirement that all properties are set, the sequence of <xref:System.Windows.FrameworkElement.Initialized> being raised by nested elements that are defined in markup appears to occur in order of deepest elements in the element tree first, then parent elements toward the root.</span></span> <span data-ttu-id="7e07f-121">采用此顺序是鉴于父子关系和包容均为属性，因此在填充属性的子元素完全初始化前，父元素无法报告初始化。</span><span class="sxs-lookup"><span data-stu-id="7e07f-121">This order is because the parent-child relationships and containment are properties, and therefore the parent cannot report initialization until the child elements that fill the property are also completely initialized.</span></span>  
  
 <span data-ttu-id="7e07f-122">当你正在编写处理程序以响应<xref:System.Windows.FrameworkElement.Initialized>事件，你必须考虑是否有是否解决附加处理程序元素树 （逻辑树或可视化树） 中的所有其他元素已创建，尤其是不能保证父元素。</span><span class="sxs-lookup"><span data-stu-id="7e07f-122">When you are writing handlers in response to the <xref:System.Windows.FrameworkElement.Initialized> event, you must consider that there is no guarantee that all other elements in the element tree (either logical tree or visual tree) around where the handler is attached have been created, particularly parent elements.</span></span> <span data-ttu-id="7e07f-123">成员变量可能为 null，或者基础绑定还未填充数据源（即使在表达式级别）。</span><span class="sxs-lookup"><span data-stu-id="7e07f-123">Member variables may be null, or data sources might not yet be populated by the underlying binding (even at the expression level).</span></span>  
  
### <a name="loaded"></a><span data-ttu-id="7e07f-124">已加载</span><span class="sxs-lookup"><span data-stu-id="7e07f-124">Loaded</span></span>  
 <span data-ttu-id="7e07f-125"><xref:System.Windows.FrameworkElement.Loaded> 接下来引发。</span><span class="sxs-lookup"><span data-stu-id="7e07f-125"><xref:System.Windows.FrameworkElement.Loaded> is raised next.</span></span> <span data-ttu-id="7e07f-126"><xref:System.Windows.FrameworkElement.Loaded>之前的最终呈现，但在该布局系统具有计算呈现所有所需值之后，将引发事件。</span><span class="sxs-lookup"><span data-stu-id="7e07f-126">The <xref:System.Windows.FrameworkElement.Loaded> event is raised before the final rendering, but after the layout system has calculated all necessary values for rendering.</span></span> <span data-ttu-id="7e07f-127"><xref:System.Windows.FrameworkElement.Loaded> 需要的逻辑树的元素包含在已完成，并且连接到演示文稿源提供 HWND 和呈现图面。</span><span class="sxs-lookup"><span data-stu-id="7e07f-127"><xref:System.Windows.FrameworkElement.Loaded> entails that the logical tree that an element is contained within is complete, and connects to a presentation source that provides the HWND and the rendering surface.</span></span> <span data-ttu-id="7e07f-128">标准数据绑定 （绑定到本地源，例如其他属性或直接定义的数据源） 将发生之前<xref:System.Windows.FrameworkElement.Loaded>。</span><span class="sxs-lookup"><span data-stu-id="7e07f-128">Standard data binding (binding to local sources, such as other properties or directly defined data sources) will have occurred prior to <xref:System.Windows.FrameworkElement.Loaded>.</span></span> <span data-ttu-id="7e07f-129">可能已发生异步数据绑定（外部或动态源），但是根据其异步特性的定义不能保证已发生异步数据绑定。</span><span class="sxs-lookup"><span data-stu-id="7e07f-129">Asynchronous data binding (external or dynamic sources) might have occurred, but by definition of its asynchronous nature cannot be guaranteed to have occurred.</span></span>  
  
 <span data-ttu-id="7e07f-130">所依据的机制<xref:System.Windows.FrameworkElement.Loaded>引发事件不同于<xref:System.Windows.FrameworkElement.Initialized>。</span><span class="sxs-lookup"><span data-stu-id="7e07f-130">The mechanism by which the <xref:System.Windows.FrameworkElement.Loaded> event is raised is different than <xref:System.Windows.FrameworkElement.Initialized>.</span></span> <span data-ttu-id="7e07f-131"><xref:System.Windows.FrameworkElement.Initialized>事件是由元素，而无需完成的元素树直接协调引发的元素。</span><span class="sxs-lookup"><span data-stu-id="7e07f-131">The <xref:System.Windows.FrameworkElement.Initialized> event is raised element by element, without a direct coordination by a completed element tree.</span></span> <span data-ttu-id="7e07f-132">与此相反，<xref:System.Windows.FrameworkElement.Loaded>整个元素树 （具体而言，逻辑树） 协调的结果引发事件。</span><span class="sxs-lookup"><span data-stu-id="7e07f-132">By contrast, the <xref:System.Windows.FrameworkElement.Loaded> event is raised as a coordinated effort throughout the entire element tree (specifically, the logical tree).</span></span> <span data-ttu-id="7e07f-133">当在树中的所有元素都均未处于加载，它们都将被视为的状态<xref:System.Windows.FrameworkElement.Loaded>事件第一次发生在根元素上。</span><span class="sxs-lookup"><span data-stu-id="7e07f-133">When all elements in the tree are in a state where they are considered loaded, the <xref:System.Windows.FrameworkElement.Loaded> event is first raised on the root element.</span></span> <span data-ttu-id="7e07f-134"><xref:System.Windows.FrameworkElement.Loaded>然后每个子元素上连续引发事件。</span><span class="sxs-lookup"><span data-stu-id="7e07f-134">The <xref:System.Windows.FrameworkElement.Loaded> event is then raised successively on each child element.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7e07f-135">这种行为看起来可能类似于路由事件的隧道。</span><span class="sxs-lookup"><span data-stu-id="7e07f-135">This behavior might superficially resemble tunneling for a routed event.</span></span> <span data-ttu-id="7e07f-136">但是，未将任何信息在事件之间传送。</span><span class="sxs-lookup"><span data-stu-id="7e07f-136">However, no information is carried from event to event.</span></span> <span data-ttu-id="7e07f-137">每个元素始终有机会处理其<xref:System.Windows.FrameworkElement.Loaded>事件，并标记为已处理的事件数据不起作用超出该元素。</span><span class="sxs-lookup"><span data-stu-id="7e07f-137">Each element always has the opportunity to handle its <xref:System.Windows.FrameworkElement.Loaded> event, and marking the event data as handled has no effect beyond that element.</span></span>  
  
### <a name="unloaded"></a><span data-ttu-id="7e07f-138">已卸载</span><span class="sxs-lookup"><span data-stu-id="7e07f-138">Unloaded</span></span>  
 <span data-ttu-id="7e07f-139"><xref:System.Windows.FrameworkElement.Unloaded> 上次引发，并可由的演示文稿源或正在删除的可视父级。</span><span class="sxs-lookup"><span data-stu-id="7e07f-139"><xref:System.Windows.FrameworkElement.Unloaded> is raised last and is initiated by either the presentation source or the visual parent being removed.</span></span> <span data-ttu-id="7e07f-140">当<xref:System.Windows.FrameworkElement.Unloaded>将引发并处理，是事件源父元素 (由<xref:System.Windows.FrameworkElement.Parent%2A>属性) 或向上中逻辑或视觉对象树的任何给定的元素可能已经被取消设置，这意味着该数据绑定，资源引用和样式不能设置为其正常或最后一个已知的运行时间值。</span><span class="sxs-lookup"><span data-stu-id="7e07f-140">When <xref:System.Windows.FrameworkElement.Unloaded> is raised and handled, the element that is the event source parent (as determined by <xref:System.Windows.FrameworkElement.Parent%2A> property) or any given element upwards in the logical or visual trees may have already been unset, meaning that data binding, resource references, and styles may not be set to their normal or last known run-time value.</span></span>  
  
<a name="application_model_elements"></a>   
## <a name="lifetime-events-application-model-elements"></a><span data-ttu-id="7e07f-141">生存期事件应用程序模型元素</span><span class="sxs-lookup"><span data-stu-id="7e07f-141">Lifetime Events Application Model Elements</span></span>  
 <span data-ttu-id="7e07f-142">为元素都是以下应用程序模型元素上的常见的生存期事件生成： <xref:System.Windows.Application>， <xref:System.Windows.Window>， <xref:System.Windows.Controls.Page>， <xref:System.Windows.Navigation.NavigationWindow>，和<xref:System.Windows.Controls.Frame>。</span><span class="sxs-lookup"><span data-stu-id="7e07f-142">Building on the common lifetime events for elements are the following application model elements: <xref:System.Windows.Application>, <xref:System.Windows.Window>, <xref:System.Windows.Controls.Page>, <xref:System.Windows.Navigation.NavigationWindow>, and <xref:System.Windows.Controls.Frame>.</span></span> <span data-ttu-id="7e07f-143">这些与特定用途相关的额外事件扩充了常见的生存期事件。</span><span class="sxs-lookup"><span data-stu-id="7e07f-143">These extend the common lifetime events with additional events that are relevant to their specific purpose.</span></span> <span data-ttu-id="7e07f-144">将在以下位置详细介绍这些内容：</span><span class="sxs-lookup"><span data-stu-id="7e07f-144">These are discussed in detail in the following locations:</span></span>  
  
-   <span data-ttu-id="7e07f-145"><xref:System.Windows.Application>:[应用程序管理概述](../../../../docs/framework/wpf/app-development/application-management-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="7e07f-145"><xref:System.Windows.Application>: [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md).</span></span>  
  
-   <span data-ttu-id="7e07f-146"><xref:System.Windows.Window>: [WPF Windows 概述](../../../../docs/framework/wpf/app-development/wpf-windows-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="7e07f-146"><xref:System.Windows.Window>: [WPF Windows Overview](../../../../docs/framework/wpf/app-development/wpf-windows-overview.md).</span></span>  
  
-   <span data-ttu-id="7e07f-147"><xref:System.Windows.Controls.Page><xref:System.Windows.Navigation.NavigationWindow>，和<xref:System.Windows.Controls.Frame>:[导航概述](../../../../docs/framework/wpf/app-development/navigation-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="7e07f-147"><xref:System.Windows.Controls.Page>, <xref:System.Windows.Navigation.NavigationWindow>, and <xref:System.Windows.Controls.Frame>: [Navigation Overview](../../../../docs/framework/wpf/app-development/navigation-overview.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7e07f-148">请参阅</span><span class="sxs-lookup"><span data-stu-id="7e07f-148">See Also</span></span>  
 [<span data-ttu-id="7e07f-149">依赖项属性值优先级</span><span class="sxs-lookup"><span data-stu-id="7e07f-149">Dependency Property Value Precedence</span></span>](../../../../docs/framework/wpf/advanced/dependency-property-value-precedence.md)  
 [<span data-ttu-id="7e07f-150">路由事件概述</span><span class="sxs-lookup"><span data-stu-id="7e07f-150">Routed Events Overview</span></span>](../../../../docs/framework/wpf/advanced/routed-events-overview.md)
