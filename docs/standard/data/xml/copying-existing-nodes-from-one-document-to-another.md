---
title: "将现有节点从一个文档复制到另一个文档"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
caps.latest.revision: "4"
author: mairaw
ms.author: mairaw
manager: wpickett
ms.openlocfilehash: 0f20e5bd595c8eb49360e58f281a8cf6eda89acf
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/18/2017
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a><span data-ttu-id="b64b6-102">将现有节点从一个文档复制到另一个文档</span><span class="sxs-lookup"><span data-stu-id="b64b6-102">Copying Existing Nodes from One Document to Another</span></span>
<span data-ttu-id="b64b6-103">**ImportNode**方法是一种的机制所依据的节点或整个节点子树复制从一个**XmlDocument**到另一个。</span><span class="sxs-lookup"><span data-stu-id="b64b6-103">The **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another.</span></span> <span data-ttu-id="b64b6-104">该调用返回的节点是源文档节点的副本，其中包括属性值、节点名、节点类型以及所有与命名空间相关的属性，如前缀、本地名称和命名空间统一资源标识符 (URI)。</span><span class="sxs-lookup"><span data-stu-id="b64b6-104">The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="b64b6-105">源文档不更改。</span><span class="sxs-lookup"><span data-stu-id="b64b6-105">The source document is not changed.</span></span> <span data-ttu-id="b64b6-106">导入该节点后，仍需使用插入节点的方法之一将该节点添加到树中。</span><span class="sxs-lookup"><span data-stu-id="b64b6-106">After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.</span></span>  
  
 <span data-ttu-id="b64b6-107">节点附加到新文档后，将归此新文档所有。</span><span class="sxs-lookup"><span data-stu-id="b64b6-107">When the node is attached to its new document, the new document owns the node.</span></span> <span data-ttu-id="b64b6-108">原因是每个节点在创建后都具有所属文档，即使节点是在单独的文档片段中创建的。</span><span class="sxs-lookup"><span data-stu-id="b64b6-108">The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments.</span></span> <span data-ttu-id="b64b6-109">这是一项要求的 XML 文档对象模型 (DOM)，在上强制执行的工厂创建设计**XmlDocument**类。</span><span class="sxs-lookup"><span data-stu-id="b64b6-109">This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class.</span></span> <span data-ttu-id="b64b6-110">例如， **CreateElement**，是唯一的方法来创建新节点。</span><span class="sxs-lookup"><span data-stu-id="b64b6-110">For example, **CreateElement**, is the only way to create new nodes.</span></span>  
  
 <span data-ttu-id="b64b6-111">具体取决于导入的节点和值的节点类型*深层*将复制适当的参数，其他信息。</span><span class="sxs-lookup"><span data-stu-id="b64b6-111">Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate.</span></span> <span data-ttu-id="b64b6-112">此方法尝试镜像当 XML 或 HTML 源代码片断从一个文档复制到另一个文档时的预期行为，并且考虑到对于 XML，两个文档可能具有不同的文档类型定义 (DTD)。</span><span class="sxs-lookup"><span data-stu-id="b64b6-112">This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).</span></span>  
  
 <span data-ttu-id="b64b6-113">下表描述了可导入的每种节点类型的特定行为。</span><span class="sxs-lookup"><span data-stu-id="b64b6-113">The following table describes the specific behavior for each type of node that can be imported.</span></span>  
  
|<span data-ttu-id="b64b6-114">节点类型</span><span class="sxs-lookup"><span data-stu-id="b64b6-114">Node Type</span></span>|<span data-ttu-id="b64b6-115">*深层*参数为 true</span><span class="sxs-lookup"><span data-stu-id="b64b6-115">*deep* parameter is true</span></span>|<span data-ttu-id="b64b6-116">*深层*参数为 false</span><span class="sxs-lookup"><span data-stu-id="b64b6-116">*deep* parameter is false</span></span>|  
|---------------|------------------------------|-------------------------------|  
|<span data-ttu-id="b64b6-117">XmlAttribute</span><span class="sxs-lookup"><span data-stu-id="b64b6-117">XmlAttribute</span></span>|<span data-ttu-id="b64b6-118"><xref:System.Xml.XmlAttribute.Specified%2A>设置为**true**在 XmlAttribute 上。</span><span class="sxs-lookup"><span data-stu-id="b64b6-118">The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute.</span></span> <span data-ttu-id="b64b6-119">后代中的源**XmlAttribute**以递归方式导入和生成的节点重新合并以形成相应的子树。</span><span class="sxs-lookup"><span data-stu-id="b64b6-119">The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="b64b6-120">*深层*参数不适用于**XmlAttribute**节点，因为它们始终会包含在导入时及其子节点。</span><span class="sxs-lookup"><span data-stu-id="b64b6-120">The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported.</span></span>|  
|<span data-ttu-id="b64b6-121">XmlCDataSection</span><span class="sxs-lookup"><span data-stu-id="b64b6-121">XmlCDataSection</span></span>|<span data-ttu-id="b64b6-122">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-122">Copies the node, including its data.</span></span>|<span data-ttu-id="b64b6-123">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-123">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="b64b6-124">XmlComment</span><span class="sxs-lookup"><span data-stu-id="b64b6-124">XmlComment</span></span>|<span data-ttu-id="b64b6-125">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-125">Copies the node, including its data.</span></span>|<span data-ttu-id="b64b6-126">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-126">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="b64b6-127">XmlDocumentFragment</span><span class="sxs-lookup"><span data-stu-id="b64b6-127">XmlDocumentFragment</span></span>|<span data-ttu-id="b64b6-128">递归导入源节点的子代，并重组生成的节点，以构成相应的子树。</span><span class="sxs-lookup"><span data-stu-id="b64b6-128">The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="b64b6-129">一个空**XmlDocumentFragment**创建。</span><span class="sxs-lookup"><span data-stu-id="b64b6-129">An empty **XmlDocumentFragment** is created.</span></span>|  
|<span data-ttu-id="b64b6-130">XmlDocumentType</span><span class="sxs-lookup"><span data-stu-id="b64b6-130">XmlDocumentType</span></span>|<span data-ttu-id="b64b6-131">复制该节点，包括复制其数据。*</span><span class="sxs-lookup"><span data-stu-id="b64b6-131">Copies the node, including its data.*</span></span>|<span data-ttu-id="b64b6-132">复制该节点，包括复制其数据。*</span><span class="sxs-lookup"><span data-stu-id="b64b6-132">Copies the node, including its data.*</span></span>|  
|<span data-ttu-id="b64b6-133">XmlElement</span><span class="sxs-lookup"><span data-stu-id="b64b6-133">XmlElement</span></span>|<span data-ttu-id="b64b6-134">递归导入源元素的子代，并重组生成的节点，以构成相应的子树。</span><span class="sxs-lookup"><span data-stu-id="b64b6-134">The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span> <span data-ttu-id="b64b6-135">**注意：**不复制默认属性。</span><span class="sxs-lookup"><span data-stu-id="b64b6-135">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="b64b6-136">如果导入到的文档定义该元素名称的默认属性，则分配这些默认属性。</span><span class="sxs-lookup"><span data-stu-id="b64b6-136">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|<span data-ttu-id="b64b6-137">指定的属性导入源元素的节点，并将生成**XmlAttribute**节点附加到新的元素。</span><span class="sxs-lookup"><span data-stu-id="b64b6-137">Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element.</span></span> <span data-ttu-id="b64b6-138">不复制子代节点。</span><span class="sxs-lookup"><span data-stu-id="b64b6-138">The descendant nodes are not copied.</span></span> <span data-ttu-id="b64b6-139">**注意：**不复制默认属性。</span><span class="sxs-lookup"><span data-stu-id="b64b6-139">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="b64b6-140">如果导入到的文档定义该元素名称的默认属性，则分配这些默认属性。</span><span class="sxs-lookup"><span data-stu-id="b64b6-140">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|  
|<span data-ttu-id="b64b6-141">XmlEntityReference</span><span class="sxs-lookup"><span data-stu-id="b64b6-141">XmlEntityReference</span></span>|<span data-ttu-id="b64b6-142">因为源和目标文档可能以不同方式定义实体，该方法仅复制**XmlEntityReference**节点。</span><span class="sxs-lookup"><span data-stu-id="b64b6-142">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="b64b6-143">不包括替换文本。</span><span class="sxs-lookup"><span data-stu-id="b64b6-143">The replacement text is not included.</span></span> <span data-ttu-id="b64b6-144">如果目标文档定义了实体，则给它赋值。</span><span class="sxs-lookup"><span data-stu-id="b64b6-144">If the destination document has the entity defined, its value is assigned.</span></span>|<span data-ttu-id="b64b6-145">因为源和目标文档可能以不同方式定义实体，该方法仅复制**XmlEntityReference**节点。</span><span class="sxs-lookup"><span data-stu-id="b64b6-145">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="b64b6-146">不包括替换文本。</span><span class="sxs-lookup"><span data-stu-id="b64b6-146">The replacement text is not included.</span></span> <span data-ttu-id="b64b6-147">如果目标文档定义了实体，则给它赋值。</span><span class="sxs-lookup"><span data-stu-id="b64b6-147">If the destination document has the entity defined, its value is assigned.</span></span>|  
|<span data-ttu-id="b64b6-148">XmlProcessingInstruction</span><span class="sxs-lookup"><span data-stu-id="b64b6-148">XmlProcessingInstruction</span></span>|<span data-ttu-id="b64b6-149">从导入的节点复制目标和数据值。</span><span class="sxs-lookup"><span data-stu-id="b64b6-149">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="b64b6-150">从导入的节点复制目标和数据值。</span><span class="sxs-lookup"><span data-stu-id="b64b6-150">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="b64b6-151">XmlText</span><span class="sxs-lookup"><span data-stu-id="b64b6-151">XmlText</span></span>|<span data-ttu-id="b64b6-152">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-152">Copies the node, including its data.</span></span>|<span data-ttu-id="b64b6-153">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-153">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="b64b6-154">XmlSignificantWhitespace</span><span class="sxs-lookup"><span data-stu-id="b64b6-154">XmlSignificantWhitespace</span></span>|<span data-ttu-id="b64b6-155">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-155">Copies the node, including its data.</span></span>|<span data-ttu-id="b64b6-156">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-156">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="b64b6-157">XmlWhitespace</span><span class="sxs-lookup"><span data-stu-id="b64b6-157">XmlWhitespace</span></span>|<span data-ttu-id="b64b6-158">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-158">Copies the node, including its data.</span></span>|<span data-ttu-id="b64b6-159">复制该节点，包括复制其数据。</span><span class="sxs-lookup"><span data-stu-id="b64b6-159">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="b64b6-160">XmlDeclaration</span><span class="sxs-lookup"><span data-stu-id="b64b6-160">XmlDeclaration</span></span>|<span data-ttu-id="b64b6-161">从导入的节点复制目标和数据值。</span><span class="sxs-lookup"><span data-stu-id="b64b6-161">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="b64b6-162">从导入的节点复制目标和数据值。</span><span class="sxs-lookup"><span data-stu-id="b64b6-162">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="b64b6-163">所有其他节点类型</span><span class="sxs-lookup"><span data-stu-id="b64b6-163">All other node types</span></span>|<span data-ttu-id="b64b6-164">不能导入这些节点类型。</span><span class="sxs-lookup"><span data-stu-id="b64b6-164">These node types cannot be imported.</span></span>|<span data-ttu-id="b64b6-165">不能导入这些节点类型。</span><span class="sxs-lookup"><span data-stu-id="b64b6-165">These node types cannot be imported.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="b64b6-166">虽然可以导入 DocumentType 节点，但一个文档只能有一个 DocumentType。</span><span class="sxs-lookup"><span data-stu-id="b64b6-166">Although DocumentType nodes can be imported, a document can only have one DocumentType.</span></span> <span data-ttu-id="b64b6-167">因此，导入该文档类型后，在将其插入到树中之前，必须确保文档中没有任何文档类型。</span><span class="sxs-lookup"><span data-stu-id="b64b6-167">So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document.</span></span> <span data-ttu-id="b64b6-168">有关删除节点的信息，请参阅[中移除节点、 内容和值从 XML 文档](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md)。</span><span class="sxs-lookup"><span data-stu-id="b64b6-168">For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b64b6-169">另请参阅</span><span class="sxs-lookup"><span data-stu-id="b64b6-169">See Also</span></span>  
 [<span data-ttu-id="b64b6-170">XML 文档对象模型 (DOM)</span><span class="sxs-lookup"><span data-stu-id="b64b6-170">XML Document Object Model (DOM)</span></span>](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
