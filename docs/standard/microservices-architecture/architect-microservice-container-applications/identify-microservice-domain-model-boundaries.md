---
title: "标识每个微服务的域模型边界"
description: "为容器化的.NET 应用程序的.NET 微服务体系结构 |标识每个微服务的域模型边界"
keywords: "Docker, 微服务, ASP.NET, 容器"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 6fef11e5718706701abb29149c4c4a23ba39bde0
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/22/2017
---
# <a name="identify-domain-model-boundaries-for-each-microservice"></a>标识每个微服务的域模型边界

在标识模型边界和每个微服务构成的大小的目标是不获取到的最高粒度分离有可能，尽管应尽可能往往向小微服务。 相反，你的目标应是可用于访问由你的域知识指导的最有意义分离。 重点不是于此大小，而是在业务功能。 此外，如果没有清除内聚需要某些区的应用程序基于大量的依赖关系，指示单个 microservice，需过。 聚合是一种方法来确定如何分离或组一起微服务。 从根本上讲，而获得有关域的详细知识，你应以迭代方式调整你 microservice 的大小。 查找适当的大小不是一个单步过程。

[Sam Newman](http://samnewman.io/)的微服务和书籍的作者识别提升程序[构建微服务](http://samnewman.io/books/building_microservices/)，突出显示，你应设计基于绑定上下文 (BC) 模式 （的一部分你微服务域驱动设计），因为引入了更早版本。 有时，可能由业务连续性构成的多个物理服务，但反之则不然。

具有特定域实体的域模型中具体的业务连续性适用或微服务。 业务连续性分隔的域模型适用性和提供开发人员团队成员必须是什么凝聚力和新增功能可以单独开发的清除和共享了解。 这些是微服务的相同目标。

通知设计选择的另一个工具是[Conway 定律](https://en.wikipedia.org/wiki/Conway%27s_law)，所处的状态的应用程序将反映生成它的组织的社交边界。 但有时反过来也成立-公司的组织的正确的软件。 你可能需要反向 Conway 定律和生成边界你想要进行组织的公司的方式向业务流程咨询倾斜。

若要识别界限的上下文，可以使用此一个 DDD 模式是[上下文映射模式](https://www.infoq.com/articles/ddd-contextmapping)。 上下文映射，需要标识中应用程序和其边界的各种上下文。 很常见，例如具有不同的上下文以及对于每个小子系统的边界。 上下文映射是一种方法来定义和明确这些边界域之间。 业务连续性是自治，包括单个域的详细信息-如域实体，并定义与其他 BCs 集成协定。 它类似于微服务构成的定义： 它是自治，它实现某些域功能，它必须提供接口。 这是为什么上下文映射和绑定上下文模式是用于标识你微服务的域模型边界的好方法。

在设计大型应用程序时，你将看到其域模型可能存在碎片-从目录域域专家将命名实体不同域中的资源目录和清单专家，传送域不同的实例。 或者处理 CRM 专家想要存储每个非排序的域专业人员只需要有关客户的部分数据比客户有关的详细信息时，用户域实体可能是不同的大小和属性数目。 它是很难消除所有域条款都歧义与大型应用程序相关的所有域。 但最重要的一点是，你不应尝试统一条款;应改为接受的差异和提供的每个域的丰富功能。 如果你尝试有一个统一的数据库，对整个应用程序，尝试在统一词汇将繁琐，并且不听起来右到多个域专业人员的任何。 因此，BCs （微服务作为实现） 将帮助你以阐明，你可以使用某些域条款，并且你需要进行拆分系统，并使用不同的域中创建其他 BCs。

您将知道你右边界和每个业务连续性的大小，并且域模型如果你有几个强关系之间域模型，并且您没有通常不需要合并来自多个域模型的信息时执行典型的应用程序操作。

每个微服务的域模型应该多大的问题的最佳答案可能是以下： 它应具有自治的业务连续性，作为独立尽可能，可用于工作，而无不断地切换到其他上下文 （其他微服务构成的模型）。 图 4-10 可以看到如何多个微服务 (多个 BCs) 拥有其自己的模型和如何其实体定义，具体取决于每个应用程序中标识的域特定的要求。

![](./media/image10.png)

**图 4-10**。 确定实体和微服务模型边界

图 4-10 演示了与联机会议管理系统的示例方案。 已标识就可以实现为微服务，基于域专家定义为你的域的多个 BCs。 如你所见，有仅在单个微服务模型中，如付款付款微服务中存在的实体。 这些将容易实现。

但是，您还可能具有不同的形状，但在从多个微服务的多个域模型之间共享相同的标识的实体。 例如，在有关参加会议管理微服务中标识的用户实体。 相同的用户，具有相同的标识，是一个在排序微服务，名为购买者或付款微服务，并甚至客户服务微服务中的一个命名的客户中一个名为的纳税人。 这是因为，具体取决于[无处不在语言](https://martinfowler.com/bliki/UbiquitousLanguage.html)使用每个域专家，用户可能会有不同的角度来看，甚至具有不同的属性。 名为有关参加会议管理微服务模型中的用户实体可能已将其个人数据特性的大多数。 但是，在 microservice 付款或中的客户 microservice 客户服务中的形状的纳税人形状中相同的用户可能不需要相同的属性列表。

类似的方法进行了阐释图 4-11。

![](./media/image11.png)

**图 4-11**。 将传统的数据模型分解成多个域模型

你可以看到如何用户存在有关参加会议管理 microservice 模型作为用户实体中，并且也是定价 microservice，具有备用的属性或实际购买者时的用户详细信息中的 Buyer 实体形式存在。 每个微服务或业务连续性可能不需要与用户实体，只是部分，具体取决于要解决的问题或上下文相关的所有数据。 例如，在定价微服务模型中，你不需要的地址或用户，只需 ID (标识） 和状态，这将影响对折扣时定价每 buyer 座位的 ID。

座位实体具有相同名称但不同的属性，每个域模型中。 但是，座位共享标识基于相同的 ID，就像使用用户和购买。

基本上，是用户的共享存在于多个服务 （域），所有的共享该用户的标识的概念。 但每个域模型中可能有其他或不同的详细信息，有关该用户实体。 因此，需要一种方法映射到另一个域 （微服务） 从一个用户实体。

有多个好处不与相同的属性数目跨域共享相同的用户实体。 一个好处是减少重复项，以便 microservice 模型没有他们并不需要任何数据。 另一个好处使拥有某种类型的每个实体的数据，以便更新和查询该类型的数据驱动只能由该 microservice master 微服务。


>[!div class="step-by-step"]
[以前](分布式的数据-management.md) [下一步] (direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md)
