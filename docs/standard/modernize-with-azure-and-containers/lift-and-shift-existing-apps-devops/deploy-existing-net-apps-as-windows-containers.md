---
title: "将现有的.NET 应用程序部署为 Windows 容器"
description: "为容器化的.NET 应用程序的.NET 微服务体系结构 |将现有的.NET 应用程序部署为 Windows 容器"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/26/2017
ms.openlocfilehash: 87aa05895857a425f11820a564f2a249c77f98e2
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/21/2017
---
# <a name="deploy-existing-net-apps-as-windows-containers"></a><span data-ttu-id="31f3f-103">将现有的.NET 应用程序部署为 Windows 容器</span><span class="sxs-lookup"><span data-stu-id="31f3f-103">Deploy existing .NET apps as Windows containers</span></span>

<span data-ttu-id="31f3f-104">基于 Windows 容器的部署都适用于云优化应用程序、 云本机应用程序和云 DevOps 通用应用程序。</span><span class="sxs-lookup"><span data-stu-id="31f3f-104">Deployments that are based on Windows Containers are applicable to Cloud-Optimized applications, cloud-native applications, and Cloud DevOps-Ready applications.</span></span>

<span data-ttu-id="31f3f-105">在本指南中，以及下列部分中，我们着重介绍如何使用 Windows 容器的*云就绪 DevOps*应用程序，当提升和移动现有的.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="31f3f-105">In this guide, and in the following sections, we focus on using Windows Containers for *Cloud DevOps-Ready* applications, when you lift and shift existing .NET applications.</span></span>

## <a name="what-are-containers-linux-or-windows"></a><span data-ttu-id="31f3f-106">什么是容器</span><span class="sxs-lookup"><span data-stu-id="31f3f-106">What are containers?</span></span> <span data-ttu-id="31f3f-107">（Linux 或 Windows）</span><span class="sxs-lookup"><span data-stu-id="31f3f-107">(Linux or Windows)</span></span>

<span data-ttu-id="31f3f-108">容器是一种方法完成其自己的独立包到应用程序。</span><span class="sxs-lookup"><span data-stu-id="31f3f-108">Containers are a way to wrap up an application into its own isolated package.</span></span> <span data-ttu-id="31f3f-109">在其容器中，应用程序不受应用程序或存在于容器之外的进程。</span><span class="sxs-lookup"><span data-stu-id="31f3f-109">In its container, the application is not affected by applications or processes that exist outside of the container.</span></span> <span data-ttu-id="31f3f-110">所有内容应用程序取决于以运行已成功为进程是在容器内。</span><span class="sxs-lookup"><span data-stu-id="31f3f-110">Everything the application depends on to run successfully as a process is inside the container.</span></span> <span data-ttu-id="31f3f-111">容器可能移动任何位置，则应用程序将始终满足要求，根据直接的依赖关系，因为它与它需要运行 （库依赖项、 运行时，等） 的所有内容捆绑在一起。</span><span class="sxs-lookup"><span data-stu-id="31f3f-111">Wherever the container might move, the requirements of the application will always be met, in terms of direct dependencies, because it is bundled with everything that it needs to run (library dependencies, runtimes, and so on).</span></span>

<span data-ttu-id="31f3f-112">容器的主要特征在于，它使得环境相同跨不同部署因为容器本身附带它需要的所有依赖项。</span><span class="sxs-lookup"><span data-stu-id="31f3f-112">The main characteristic of a container is that it makes the environment the same across different deployments because the container itself comes with all the dependencies it needs.</span></span> <span data-ttu-id="31f3f-113">也就是说，你可以在您的计算机上进行调试应用程序，然后将其部署到另一台计算机，与相同的环境保证。</span><span class="sxs-lookup"><span data-stu-id="31f3f-113">This means that you can debug the application on your machine, and then deploy it to another machine, with the same environment guaranteed.</span></span>

<span data-ttu-id="31f3f-114">容器是容器映像的实例。</span><span class="sxs-lookup"><span data-stu-id="31f3f-114">A container is an instance of a container image.</span></span> <span data-ttu-id="31f3f-115">容器映像是一种方法，包的应用或服务 （如快照），然后将它部署可靠且可重现的方式。</span><span class="sxs-lookup"><span data-stu-id="31f3f-115">A container image is a way to package an app or service (like a snapshot), and then deploy it in a reliable and reproducible way.</span></span> <span data-ttu-id="31f3f-116">你可以假定 Docker 不仅技术-it 还的基本原理和进程。</span><span class="sxs-lookup"><span data-stu-id="31f3f-116">You could say that Docker is not only a technology-it's also a philosophy and a process.</span></span>

<span data-ttu-id="31f3f-117">当容器每天变得更加常见，这些访客成为行业范围内"单元的部署。</span><span class="sxs-lookup"><span data-stu-id="31f3f-117">As containers daily become more common, they are becoming an industry-wide "unit of deployment."</span></span>

## <a name="benefits-of-containers-docker-engine-on-linux-or-windows"></a><span data-ttu-id="31f3f-118">容器 （在 Linux 或 Windows 上的 Docker 引擎） 的优点</span><span class="sxs-lookup"><span data-stu-id="31f3f-118">Benefits of containers (Docker Engine on Linux or Windows)</span></span>

<span data-ttu-id="31f3f-119">通过使用容器，以生成应用程序也可能是定义为轻量的构建基块提供显著提高了用于构建、 传送，和运行任何应用程序，在任何基础结构的灵活性。</span><span class="sxs-lookup"><span data-stu-id="31f3f-119">Building applications by using containers-which also might be defined as lightweight building blocks-offers a significant increase in agility for building, shipping, and running any application, across any infrastructure.</span></span>

<span data-ttu-id="31f3f-120">与容器，您可以采取任何应用程序从开发到生产环境进行很少或没有代码更改后，在 Microsoft 开发人员工具、 操作系统和云之间的 Docker 集成感谢。</span><span class="sxs-lookup"><span data-stu-id="31f3f-120">With containers, you can take any app from development to production with little or no code change, thanks to Docker integration across Microsoft developer tools, operating systems, and cloud.</span></span>

<span data-ttu-id="31f3f-121">当你将部署到纯 Vm 时，你可能已在用于将 ASP.NET 应用程序部署到你的 Vm 的位置的一个方法。</span><span class="sxs-lookup"><span data-stu-id="31f3f-121">When you deploy to plain VMs, you probably already have a method in place for deploying ASP.NET apps to your VMs.</span></span> <span data-ttu-id="31f3f-122">很可能，不过，你的方法使用 Puppet，之类的部署工具或类似的工具，包括多个手动步骤或复杂的自动化的进程。</span><span class="sxs-lookup"><span data-stu-id="31f3f-122">It's likely, though, that your method involves multiple manual steps or complex automated processes by using a deployment tool like Puppet, or a similar tool.</span></span> <span data-ttu-id="31f3f-123">你可能需要执行任务，例如修改配置项目、 复制，在服务器之间的应用程序内容和运行基于跟测试的.msi 设置的交互式安装程序。</span><span class="sxs-lookup"><span data-stu-id="31f3f-123">You might need to perform tasks like modifying configuration items, copying application content between servers, and running interactive setup programs based on .msi setups, followed by testing.</span></span> <span data-ttu-id="31f3f-124">在部署中的所有这些步骤将添加到部署的时间和风险。</span><span class="sxs-lookup"><span data-stu-id="31f3f-124">All those steps in the deployment add time and risk to deployments.</span></span> <span data-ttu-id="31f3f-125">每当依赖项不存在于目标环境，则将出现故障。</span><span class="sxs-lookup"><span data-stu-id="31f3f-125">You will get failures whenever a dependency is not present in the target environment.</span></span>

<span data-ttu-id="31f3f-126">在 Windows 容器中的打包应用程序过程是完全自动的。</span><span class="sxs-lookup"><span data-stu-id="31f3f-126">In Windows Containers, the process of packaging applications is fully automated.</span></span> <span data-ttu-id="31f3f-127">Windows 容器基于 Docker 平台，提供自动更新和容器部署的回滚。</span><span class="sxs-lookup"><span data-stu-id="31f3f-127">Windows Containers is based on the Docker platform, which offers automatic updates and rollbacks for container deployments.</span></span> <span data-ttu-id="31f3f-128">获得使用 Docker 引擎的主改进是你创建映像，就像你的应用程序的快照，包括其所有依赖项。</span><span class="sxs-lookup"><span data-stu-id="31f3f-128">The main improvement you get from using the Docker engine is that you create images, which are like snapshots of your application, with all its dependencies.</span></span> <span data-ttu-id="31f3f-129">映像是 Docker 映像 （Windows 容器映像，在此情况下）。</span><span class="sxs-lookup"><span data-stu-id="31f3f-129">The images are Docker images (a Windows container image, in this case).</span></span> <span data-ttu-id="31f3f-130">映像不追溯到源代码的情况下，在容器中，运行的 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="31f3f-130">The images run ASP.NET apps in containers, without going back to source code.</span></span> <span data-ttu-id="31f3f-131">容器快照将成为部署单元。</span><span class="sxs-lookup"><span data-stu-id="31f3f-131">The container snapshot becomes the unit of deployment.</span></span>

<span data-ttu-id="31f3f-132">大量的组织 containerizing 现有的单一应用程序，原因如下：</span><span class="sxs-lookup"><span data-stu-id="31f3f-132">A large number of organizations are containerizing existing monolithic applications for the following reasons:</span></span>

-   <span data-ttu-id="31f3f-133">**释放通过提高部署灵活性**。</span><span class="sxs-lookup"><span data-stu-id="31f3f-133">**Release agility through improved deployment**.</span></span> <span data-ttu-id="31f3f-134">容器提供一致的部署之间开发和操作协定。</span><span class="sxs-lookup"><span data-stu-id="31f3f-134">Containers offer a consistent deployment contract between development and operations.</span></span> <span data-ttu-id="31f3f-135">当使用容器时，您将听到开发人员说，"It works 我在计算机上，不要在生产中？"</span><span class="sxs-lookup"><span data-stu-id="31f3f-135">When you use containers, you won't hear developers say, "It works on my machine, why not in production?"</span></span> <span data-ttu-id="31f3f-136">他们可以简单地说，"它作为运行一个容器，因此它将在生产环境中运行。"</span><span class="sxs-lookup"><span data-stu-id="31f3f-136">They can simply say, "It runs as a container, so it'll run in production."</span></span> <span data-ttu-id="31f3f-137">打包应用程序，包括其所有依赖项，可以在任何支持的基于容器的环境中执行。</span><span class="sxs-lookup"><span data-stu-id="31f3f-137">The packaged application, with all its dependencies, can be executed in any supported container-based environment.</span></span> <span data-ttu-id="31f3f-138">它将运行它本来就在所有的部署目标 （开发、 QA、 过渡或生产） 中运行的方式。</span><span class="sxs-lookup"><span data-stu-id="31f3f-138">It will run the way it was intended to run in all deployment targets (dev, QA, staging, production).</span></span> <span data-ttu-id="31f3f-139">容器消除大多数 frictions，当它们移到下一步，极大地提高了部署，从一个阶段时，你可以将更快地发运。</span><span class="sxs-lookup"><span data-stu-id="31f3f-139">Containers eliminate most frictions when they move from one stage to the next, which greatly improves deployment, and you can ship faster.</span></span>

-   <span data-ttu-id="31f3f-140">**成本降低**。</span><span class="sxs-lookup"><span data-stu-id="31f3f-140">**Cost reductions**.</span></span> <span data-ttu-id="31f3f-141">容器会导致降低成本，通过合并和删除的现有硬件，或者在更高的密度，每个单位硬件运行应用程序。</span><span class="sxs-lookup"><span data-stu-id="31f3f-141">Containers lead to lower costs, either by the consolidation and removal of existing hardware, or from running applications at a higher density per unit of hardware.</span></span>

-   <span data-ttu-id="31f3f-142">**可移植性**。</span><span class="sxs-lookup"><span data-stu-id="31f3f-142">**Portability**.</span></span> <span data-ttu-id="31f3f-143">容器是模块化且可移植。</span><span class="sxs-lookup"><span data-stu-id="31f3f-143">Containers are modular and portable.</span></span> <span data-ttu-id="31f3f-144">Docker 容器支持对任何服务器操作系统 （Linux 和 Windows），请在任何的主要公共云 （Microsoft Azure、 Amazon AWS、 Google、 IBM），在本地和私有或混合云环境。</span><span class="sxs-lookup"><span data-stu-id="31f3f-144">Docker containers are supported on any server operating system (Linux and Windows), in any major public cloud (Microsoft Azure, Amazon AWS, Google, IBM), and in on-premises and private or hybrid cloud environments.</span></span>

-   <span data-ttu-id="31f3f-145">**控件**。</span><span class="sxs-lookup"><span data-stu-id="31f3f-145">**Control**.</span></span> <span data-ttu-id="31f3f-146">容器提供灵活可靠的环境，在容器级别控制。</span><span class="sxs-lookup"><span data-stu-id="31f3f-146">Containers offer a flexible and secure environment that's controlled at the container level.</span></span> <span data-ttu-id="31f3f-147">可以保护、 隔离，并且即使在容器上设置执行约束策略受限制容器。</span><span class="sxs-lookup"><span data-stu-id="31f3f-147">A container can be secured, isolated, and even limited by setting execution constraint policies on the container.</span></span> <span data-ttu-id="31f3f-148">有关 Windows 容器的部分所述，Windows Server 2016 和 HYPER-V 容器提供额外的企业级支持选项。</span><span class="sxs-lookup"><span data-stu-id="31f3f-148">As detailed in the section about Windows Containers, Windows Server 2016 and Hyper-V containers offer additional enterprise support options.</span></span>

<span data-ttu-id="31f3f-149">使用容器来开发和维护应用程序时，灵活性、 可移植性和控件中的重大改进最终导致显著降低成本。</span><span class="sxs-lookup"><span data-stu-id="31f3f-149">Significant improvements in agility, portability, and control ultimately lead to significant cost reductions when you use containers to develop and maintain applications.</span></span>

## <a name="what-is-docker"></a><span data-ttu-id="31f3f-150">什么是 Docker？</span><span class="sxs-lookup"><span data-stu-id="31f3f-150">What is Docker?</span></span>

<span data-ttu-id="31f3f-151">[Docker](https://www.docker.com/)是[开放源代码项目](https://github.com/docker/docker)自动化作为可移植的足可以在云或本地运行的容器应用程序的部署。</span><span class="sxs-lookup"><span data-stu-id="31f3f-151">[Docker](https://www.docker.com/) is an [open-source project](https://github.com/docker/docker) that automates the deployment of applications as portable, self-sufficient containers that can run in the cloud or on-premises.</span></span> <span data-ttu-id="31f3f-152">Docker 也是[公司](https://www.docker.com/)，提升和发展此技术。</span><span class="sxs-lookup"><span data-stu-id="31f3f-152">Docker also is a [company](https://www.docker.com/) that promotes and evolves this technology.</span></span> <span data-ttu-id="31f3f-153">该公司在与云，Linux 和 Windows 供应商，包括 Microsoft 协作工作正常。</span><span class="sxs-lookup"><span data-stu-id="31f3f-153">The company works in collaboration with cloud, Linux, and Windows vendors, including Microsoft.</span></span>

![](./media/image6.png)

> <span data-ttu-id="31f3f-154">**图 4-6。**</span><span class="sxs-lookup"><span data-stu-id="31f3f-154">**Figure 4-6.**</span></span> <span data-ttu-id="31f3f-155">Docker 将部署在混合云中的所有层的容器</span><span class="sxs-lookup"><span data-stu-id="31f3f-155">Docker deploys containers at all layers of the hybrid cloud</span></span>

<span data-ttu-id="31f3f-156">某个人可以使用熟悉的虚拟机，容器可能看起来非常类似。</span><span class="sxs-lookup"><span data-stu-id="31f3f-156">To someone familiar with virtual machines, containers might appear to be remarkably similar.</span></span> <span data-ttu-id="31f3f-157">容器在操作系统上运行，具有文件系统，并且可以访问通过网络，就像物理或虚拟计算机系统一样。</span><span class="sxs-lookup"><span data-stu-id="31f3f-157">A container runs an operating system, has a file system, and can be accessed over a network, just like a physical or virtual computer system.</span></span> <span data-ttu-id="31f3f-158">但是，该技术以及容器背后的概念是大大不同于虚拟机。</span><span class="sxs-lookup"><span data-stu-id="31f3f-158">However, the technology and concepts behind containers are vastly different from virtual machines.</span></span> <span data-ttu-id="31f3f-159">从开发人员的角度来看，容器必须被视为多单个进程。</span><span class="sxs-lookup"><span data-stu-id="31f3f-159">From a developer point of view, a container must be treated more like a single process.</span></span> <span data-ttu-id="31f3f-160">事实上，容器都有一个进程的单入口点。</span><span class="sxs-lookup"><span data-stu-id="31f3f-160">In fact, a container has a single entry point for one process.</span></span>

<span data-ttu-id="31f3f-161">Docker 容器 (为简单起见，*容器*) 可以本机 Linux 和 Windows 上运行。</span><span class="sxs-lookup"><span data-stu-id="31f3f-161">Docker containers (for simplicity, *containers*) can run natively on Linux and Windows.</span></span> <span data-ttu-id="31f3f-162">Windows 容器时正在运行的正则容器，可以仅在 Windows 主机 （主机服务器或 VM） 上运行和 Linux 容器可以仅在 Linux 主机上运行。</span><span class="sxs-lookup"><span data-stu-id="31f3f-162">When running regular containers, Windows containers can run only on Windows hosts (a host server or a VM), and Linux containers can run only on Linux hosts.</span></span> <span data-ttu-id="31f3f-163">但是，在最新版本的 Windows Server 和 HYPER-V 容器，Linux 容器还可以运行本机在 Windows Server 上使用目前仅在 Windows Server 容器中可用的 HYPER-V 隔离技术。</span><span class="sxs-lookup"><span data-stu-id="31f3f-163">However, in recent versions of Windows Server and Hyper-V containers, a Linux container also can run natively on Windows Server by using the Hyper-V isolation technology that currently is available only in Windows Server Containers.</span></span>

<span data-ttu-id="31f3f-164">在不久的将来，具有 Linux 和 Windows 容器的混合的环境将可能并常见。</span><span class="sxs-lookup"><span data-stu-id="31f3f-164">In the near future, mixed environments that have both Linux and Windows containers will be possible and even common.</span></span>

## <a name="benefits-of-windows-containers-for-your-existing-net-applications"></a><span data-ttu-id="31f3f-165">为你现有的.NET 应用程序的 Windows 容器的优点</span><span class="sxs-lookup"><span data-stu-id="31f3f-165">Benefits of Windows Containers for your existing .NET applications</span></span>

<span data-ttu-id="31f3f-166">使用 Windows 容器的好处本质都是相同的好处一般情况下获取来自容器。</span><span class="sxs-lookup"><span data-stu-id="31f3f-166">The benefits of using Windows Containers are fundamentally the same benefits you get from containers in general.</span></span> <span data-ttu-id="31f3f-167">使用 Windows 容器是有关从而大大提高灵活性、 可移植性和控制。</span><span class="sxs-lookup"><span data-stu-id="31f3f-167">Using Windows Containers is about greatly improving agility, portability, and control.</span></span>

<span data-ttu-id="31f3f-168">当我们谈现有的.NET 应用程序时，主要是指的传统应用程序使用.NET Framework 创建的。</span><span class="sxs-lookup"><span data-stu-id="31f3f-168">When we talk about existing .NET applications, we mostly mean traditional applications that were created by using the .NET Framework.</span></span> <span data-ttu-id="31f3f-169">例如，它们可能是传统的 ASP.NET web 应用程序-不使用.NET 核心，后者是较新，并运行跨平台在 Linux、 Windows 和 MacOS 上。</span><span class="sxs-lookup"><span data-stu-id="31f3f-169">For example, they might be traditional ASP.NET web applications-they don't use .NET Core, which is newer and runs cross-platform on Linux, Windows, and MacOS.</span></span>

<span data-ttu-id="31f3f-170">.NET Framework 中的主要依赖关系是 Windows。</span><span class="sxs-lookup"><span data-stu-id="31f3f-170">The main dependency in the .NET Framework is Windows.</span></span> <span data-ttu-id="31f3f-171">它还具有传统 ASP.NET 中的辅助依赖项，如 IIS 和 System.Web。</span><span class="sxs-lookup"><span data-stu-id="31f3f-171">It also has secondary dependencies, like IIS, and System.Web in traditional ASP.NET.</span></span>

<span data-ttu-id="31f3f-172">.NET Framework 应用程序必须运行在 Windows 上，时间段所示。</span><span class="sxs-lookup"><span data-stu-id="31f3f-172">A .NET Framework application must run on Windows, period.</span></span> <span data-ttu-id="31f3f-173">如果你想要化现有.NET Framework 应用程序并且你不能或不希望投资迁移到.NET 核心 （"如果它能正常工作，不将其迁移"），你有针对容器是唯一选择是使用 Windows 容器。</span><span class="sxs-lookup"><span data-stu-id="31f3f-173">If you want to containerize existing .NET Framework applications and you can't or don't want to invest in a migration to .NET Core ("If it works properly, don't migrate it"), the only choice you have for containers is to use Windows Containers.</span></span>

<span data-ttu-id="31f3f-174">因此，Windows 容器的主要好处之一是，它们提供了一种方法来提升你现有的.NET Framework 应用程序在 Windows 通过容器化上运行。</span><span class="sxs-lookup"><span data-stu-id="31f3f-174">So, one of the main benefits of Windows Containers is that they offer you a way to modernize your existing .NET Framework applications that are running on Windows-through containerization.</span></span> <span data-ttu-id="31f3f-175">从根本上讲，Windows 容器，让你通过使用容器灵活性、 可移植性和更好地控制正在寻找的好处。</span><span class="sxs-lookup"><span data-stu-id="31f3f-175">Ultimately, Windows Containers gets you the benefits that you are looking for by using containers-agility, portability, and better control.</span></span>

## <a name="choose-an-os-to-target-with-net-based-containers"></a><span data-ttu-id="31f3f-176">选择为目标的 OS。基于网络的容器</span><span class="sxs-lookup"><span data-stu-id="31f3f-176">Choose an OS to target with .NET-based containers</span></span>

<span data-ttu-id="31f3f-177">给定的操作系统支持 Docker，以及.NET Framework 和.NET 核心之间的差异的多样性，应针对特定操作系统和基于正在使用的 framework 的特定版本。</span><span class="sxs-lookup"><span data-stu-id="31f3f-177">Given the diversity of operating systems that are supported by Docker, as well as the differences between .NET Framework and .NET Core, you should target a specific OS and specific versions based on the framework you are using.</span></span>

<span data-ttu-id="31f3f-178">对于 Windows，你可以使用 Windows Server Core 或 Windows Nano Server。</span><span class="sxs-lookup"><span data-stu-id="31f3f-178">For Windows, you can use Windows Server Core or Windows Nano Server.</span></span> <span data-ttu-id="31f3f-179">这些 Windows 版本提供需要的.NET Framework 或.NET Core 应用程序的不同特征 （如与自承载的 web 服务器 Kestrel 例如 IIS)。</span><span class="sxs-lookup"><span data-stu-id="31f3f-179">These Windows versions provide different characteristics (like IIS versus a self-hosted web server like Kestrel) that might be needed by .NET Framework or .NET Core applications.</span></span>

<span data-ttu-id="31f3f-180">对于 Linux，多个发行版的可用性和支持中 （如 Debian) 的正式.NET Docker 映像。</span><span class="sxs-lookup"><span data-stu-id="31f3f-180">For Linux, multiple distros are available and supported in official .NET Docker images (like Debian).</span></span>

<span data-ttu-id="31f3f-181">图 4-7 显示你可以面向，具体取决于应用的.NET Framework 版本的操作系统版本。</span><span class="sxs-lookup"><span data-stu-id="31f3f-181">Figure 4-7 shows OS versions that you can target, depending on the app's version of the .NET Framework.</span></span>

![](./media/image7.png)

> <span data-ttu-id="31f3f-182">**图 4-7。**</span><span class="sxs-lookup"><span data-stu-id="31f3f-182">**Figure 4-7.**</span></span> <span data-ttu-id="31f3f-183">指向基于.NET Framework 版本的操作系统</span><span class="sxs-lookup"><span data-stu-id="31f3f-183">Operating systems to target based on .NET Framework version</span></span>

<span data-ttu-id="31f3f-184">在基于.NET Framework 应用程序的现有或旧应用程序的迁移方案，主要依赖项是在 Windows 和 IIS 上。</span><span class="sxs-lookup"><span data-stu-id="31f3f-184">In migration scenarios for existing or legacy applications that are based on .NET Framework applications, the main dependencies are on Windows and IIS.</span></span> <span data-ttu-id="31f3f-185">唯一的选项是使用基于 Windows Server Core 和.NET Framework 的 Docker 映像。</span><span class="sxs-lookup"><span data-stu-id="31f3f-185">Your only option is to use Docker images based on Windows Server Core and the .NET Framework.</span></span>

<span data-ttu-id="31f3f-186">当映像名称添加到 Dockerfile 文件时，可以通过使用的标记，如下面的示例基于.NET Framework 的 Windows 容器映像中选择的操作系统和版本：</span><span class="sxs-lookup"><span data-stu-id="31f3f-186">When you add the image name to your Dockerfile file, you can select the operating system and version by using a tag, as in the following examples for .NET Framework-based Windows container images:</span></span>

> | <span data-ttu-id="31f3f-187">**标记**</span><span class="sxs-lookup"><span data-stu-id="31f3f-187">**Tag**</span></span> | <span data-ttu-id="31f3f-188">**系统和版本**</span><span class="sxs-lookup"><span data-stu-id="31f3f-188">**System and version**</span></span> |
> |---|---|
> | <span data-ttu-id="31f3f-189">**microsoft/dotnet-framework:4.x windowsservercore**</span><span class="sxs-lookup"><span data-stu-id="31f3f-189">**microsoft/dotnet-framework:4.x-windowsservercore**</span></span> | <span data-ttu-id="31f3f-190">.NET framework 4.x 在 Windows Server Core 上</span><span class="sxs-lookup"><span data-stu-id="31f3f-190">.NET Framework 4.x on Windows Server Core</span></span> |
> | <span data-ttu-id="31f3f-191">**microsoft/aspnet:4.x windowsservercore**</span><span class="sxs-lookup"><span data-stu-id="31f3f-191">**microsoft/aspnet:4.x-windowsservercore**</span></span> | <span data-ttu-id="31f3f-192">.NET framework 4.x 使用其他 ASP.NET 自定义，在 Windows Server Core 上</span><span class="sxs-lookup"><span data-stu-id="31f3f-192">.NET Framework 4.x with additional ASP.NET customization, on Windows Server Core</span></span> |

<span data-ttu-id="31f3f-193">为.NET 核心 （适用于 Linux 和 Windows 跨平台），标记将如下所示：</span><span class="sxs-lookup"><span data-stu-id="31f3f-193">For .NET Core (cross-platform for Linux and Windows), the tags would look like this:</span></span>

> | <span data-ttu-id="31f3f-194">**标记**</span><span class="sxs-lookup"><span data-stu-id="31f3f-194">**Tag**</span></span> | <span data-ttu-id="31f3f-195">**系统和版本**</span><span class="sxs-lookup"><span data-stu-id="31f3f-195">**System and version**</span></span>
> |---|---|
> | <span data-ttu-id="31f3f-196">**microsoft/dotnet:2.0.0-runtime**</span><span class="sxs-lookup"><span data-stu-id="31f3f-196">**microsoft/dotnet:2.0.0-runtime**</span></span> | <span data-ttu-id="31f3f-197">.NET 核心 2.0 仅运行时在 Linux 上</span><span class="sxs-lookup"><span data-stu-id="31f3f-197">.NET Core 2.0 runtime-only on Linux</span></span> |
> | <span data-ttu-id="31f3f-198">**microsoft/dotnet:2.0.0-runtime-nanoserver**</span><span class="sxs-lookup"><span data-stu-id="31f3f-198">**microsoft/dotnet:2.0.0-runtime-nanoserver**</span></span> | <span data-ttu-id="31f3f-199">.NET 核心 2.0 仅运行时在 Windows Nano Server 上</span><span class="sxs-lookup"><span data-stu-id="31f3f-199">.NET Core 2.0 runtime-only on Windows Nano Server</span></span> |

### <a name="multi-arch-images"></a><span data-ttu-id="31f3f-200">多 arch 映像</span><span class="sxs-lookup"><span data-stu-id="31f3f-200">Multi-arch images</span></span>

<span data-ttu-id="31f3f-201">从 2017 中旬开始，你还可以使用新功能在 Docker 调用中[多体系结构](https://github.com/moby/moby/issues/15866)映像。</span><span class="sxs-lookup"><span data-stu-id="31f3f-201">Beginning in mid-2017, you also can use a new feature in Docker called [multi-arch](https://github.com/moby/moby/issues/15866) images.</span></span> <span data-ttu-id="31f3f-202">.NET 核心 Docker 映像可以使用多 arch 标记。</span><span class="sxs-lookup"><span data-stu-id="31f3f-202">.NET Core Docker images can use multi-arch tags.</span></span> <span data-ttu-id="31f3f-203">Dockerfile 不再文件需定义你面向的操作系统。</span><span class="sxs-lookup"><span data-stu-id="31f3f-203">Your Dockerfile files no longer need to define the operating system that you are targeting.</span></span> <span data-ttu-id="31f3f-204">使用多 arch 功能，用于跨多个计算机配置的单个标记。</span><span class="sxs-lookup"><span data-stu-id="31f3f-204">The multi-arch feature allows a single tag to be used across multiple machine configurations.</span></span> <span data-ttu-id="31f3f-205">例如，多体系结构，您可以使用一个通用的标签： **microsoft/dotnet:2.0.0-runtime**。</span><span class="sxs-lookup"><span data-stu-id="31f3f-205">For instance, with multi-arch, you can use one common tag: **microsoft/dotnet:2.0.0-runtime**.</span></span> <span data-ttu-id="31f3f-206">如果请求 Linux 容器环境中的使用该标记时，获取基于 Debian 的映像。</span><span class="sxs-lookup"><span data-stu-id="31f3f-206">If you pull that tag from a Linux container environment, you get the Debian-based image.</span></span> <span data-ttu-id="31f3f-207">如果请求 Windows 容器环境中使用该标记时，获取基于 Nano Server 的映像。</span><span class="sxs-lookup"><span data-stu-id="31f3f-207">If you pull that tag from a Windows container environment, you get the Nano Server-based image.</span></span>

<span data-ttu-id="31f3f-208">对于.NET Framework 映像，因为传统的.NET Framework 支持仅 Windows 中，不能使用多 arch 功能。</span><span class="sxs-lookup"><span data-stu-id="31f3f-208">For .NET Framework images, because the traditional .NET Framework supports only Windows, you cannot use the multi-arch feature.</span></span>

## <a name="windows-container-types"></a><span data-ttu-id="31f3f-209">Windows 容器类型</span><span class="sxs-lookup"><span data-stu-id="31f3f-209">Windows container types</span></span>

<span data-ttu-id="31f3f-210">Linux 容器，如 Windows Server 容器通过使用 Docker 引擎管理。</span><span class="sxs-lookup"><span data-stu-id="31f3f-210">Like Linux containers, Windows Server containers are managed by using Docker Engine.</span></span> <span data-ttu-id="31f3f-211">与 Linux 容器不同 Windows 容器包括两种不同的容器类型，或运行时间 Windows Server 容器和 HYPER-V 隔离。</span><span class="sxs-lookup"><span data-stu-id="31f3f-211">Unlike Linux containers, Windows containers include two different container types, or run times-Windows Server containers and Hyper-V isolation.</span></span>

<span data-ttu-id="31f3f-212">**Windows Server 容器**： 提供通过进程和命名空间隔离技术的应用程序隔离。</span><span class="sxs-lookup"><span data-stu-id="31f3f-212">**Windows Server containers**: Provides application isolation through process and namespace isolation technology.</span></span> <span data-ttu-id="31f3f-213">Windows Server 容器与容器主机和主机运行的所有容器共享内核。</span><span class="sxs-lookup"><span data-stu-id="31f3f-213">A Windows Server container shares a kernel with the container host and all containers that are running on the host.</span></span> <span data-ttu-id="31f3f-214">这些容器不提供恶意的安全边界，不应该用于隔离不受信任的代码。</span><span class="sxs-lookup"><span data-stu-id="31f3f-214">These containers do not provide a hostile security boundary and should not be used to isolate untrusted code.</span></span> <span data-ttu-id="31f3f-215">由于共享的内核空间，因此这些容器需要相同的内核版本和配置。</span><span class="sxs-lookup"><span data-stu-id="31f3f-215">Because of the shared kernel space, these containers require the same kernel version and configuration.</span></span>

<span data-ttu-id="31f3f-216">**HYPER-V 隔离**： 通过在高度优化的虚拟机上运行每个容器由 Windows Server 容器提供的隔离上扩展。</span><span class="sxs-lookup"><span data-stu-id="31f3f-216">**Hyper-V isolation**: Expands on the isolation provided by Windows Server Containers by running each container on a highly optimized VM.</span></span> <span data-ttu-id="31f3f-217">在此配置中，容器主机的内核不与同一主机上的其他容器共享。</span><span class="sxs-lookup"><span data-stu-id="31f3f-217">In this configuration, the kernel of the container host is not shared with other containers on the same host.</span></span> <span data-ttu-id="31f3f-218">这些容器专门用于恶意多租户托管，与 VM 的相同安全保证。</span><span class="sxs-lookup"><span data-stu-id="31f3f-218">These containers are designed for hostile multitenant hosting, with the same security assurances of a VM.</span></span> <span data-ttu-id="31f3f-219">由于这些容器不与主机或主机上的其他容器共享内核，它们可以使用不同版本和 （具有支持的版本） 的配置运行内核。</span><span class="sxs-lookup"><span data-stu-id="31f3f-219">Because these containers don't share the kernel with the host or other containers on the host, they can run kernels with different versions and configurations (with supported versions).</span></span> <span data-ttu-id="31f3f-220">例如，Windows 10 上的所有 Windows 容器都使用 HYPER-V 隔离以利用 Windows Server 内核版本和配置。</span><span class="sxs-lookup"><span data-stu-id="31f3f-220">For example, all Windows containers on Windows 10 use Hyper-V isolation to utilize the Windows Server kernel version and configuration.</span></span>

<span data-ttu-id="31f3f-221">在 Windows 上运行一个容器，或 HYPER-V 隔离不是运行时决定。</span><span class="sxs-lookup"><span data-stu-id="31f3f-221">Running a container on Windows with or without Hyper-V isolation is a run-time decision.</span></span> <span data-ttu-id="31f3f-222">可能会选择最初，创建具有 HYPER-V 隔离容器，并在运行时，选择为改为运行 Windows Server 容器。</span><span class="sxs-lookup"><span data-stu-id="31f3f-222">You might choose to create the container with Hyper-V isolation initially, and at run time, choose to run it as a Windows Server container instead.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="31f3f-223">其他资源</span><span class="sxs-lookup"><span data-stu-id="31f3f-223">Additional resources</span></span>

-   <span data-ttu-id="31f3f-224">**Windows 容器文档**</span><span class="sxs-lookup"><span data-stu-id="31f3f-224">**Windows Containers documentation**</span></span>

    [<span data-ttu-id="31f3f-225">https://docs.microsoft.com/virtualization/windowscontainers/</span><span class="sxs-lookup"><span data-stu-id="31f3f-225">https://docs.microsoft.com/virtualization/windowscontainers/</span></span>](https://docs.microsoft.com/virtualization/windowscontainers/)

-   <span data-ttu-id="31f3f-226">**Windows 容器基础知识**</span><span class="sxs-lookup"><span data-stu-id="31f3f-226">**Windows Containers fundamentals**</span></span>

    [<span data-ttu-id="31f3f-227">https://docs.microsoft.com/virtualization/windowscontainers/about/</span><span class="sxs-lookup"><span data-stu-id="31f3f-227">https://docs.microsoft.com/virtualization/windowscontainers/about/</span></span>](https://docs.microsoft.com/virtualization/windowscontainers/about/)

-   <span data-ttu-id="31f3f-228">**信息图： Microsoft 和容器**</span><span class="sxs-lookup"><span data-stu-id="31f3f-228">**Infographic: Microsoft and containers**</span></span>

    [<span data-ttu-id="31f3f-229">https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf</span><span class="sxs-lookup"><span data-stu-id="31f3f-229">https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf</span></span>](https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf)

>[!div class="step-by-step"]
<span data-ttu-id="31f3f-230">[上一页](how-to-deploy-existing-net-apps-to-azure-app-service.md)
[下一页](when-not-to-deploy-to-windows-containers.md)</span><span class="sxs-lookup"><span data-stu-id="31f3f-230">[Previous](how-to-deploy-existing-net-apps-to-azure-app-service.md)
[Next](when-not-to-deploy-to-windows-containers.md)</span></span>
