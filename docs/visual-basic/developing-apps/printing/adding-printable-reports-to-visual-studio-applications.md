---
title: 将可打印的报表添加到 Visual Studio 应用程序
ms.date: 07/20/2015
helpviewer_keywords:
- printing [Visual Studio], reports
- reports [Visual Basic], printing in Visual Studio
ms.assetid: 93928405-ef41-495e-bce2-9d43d5a7080a
ms.openlocfilehash: 4a7275a665e0c3290c2b3cd55c1af0c7cf0504f2
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/04/2018
ms.locfileid: "33592049"
---
# <a name="adding-printable-reports-to-visual-studio-applications"></a><span data-ttu-id="b175e-102">将可打印的报表添加到 Visual Studio 应用程序</span><span class="sxs-lookup"><span data-stu-id="b175e-102">Adding Printable Reports to Visual Studio Applications</span></span>
<span data-ttu-id="b175e-103">Visual Studio 支持各种报表的解决方案来帮助你添加到 Visual Basic 应用程序报告的丰富数据。</span><span class="sxs-lookup"><span data-stu-id="b175e-103">Visual Studio supports a variety of reporting solutions to help you add rich data reporting to your Visual Basic applications.</span></span> <span data-ttu-id="b175e-104">你可以创建并添加使用 ReportViewer 控件、 Crystal Reports 或 SQL Server Reporting Services 报表。</span><span class="sxs-lookup"><span data-stu-id="b175e-104">You can create and add reports using ReportViewer controls, Crystal Reports, or SQL Server Reporting Services.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b175e-105">SQL Server Reporting Services 是 SQL Server 2005，而不是 Visual Studio 的一部分。</span><span class="sxs-lookup"><span data-stu-id="b175e-105">SQL Server Reporting Services is part of SQL Server 2005 rather than Visual Studio.</span></span> <span data-ttu-id="b175e-106">在你的系统上未安装，除非你已安装 SQL Server 2005 reporting Services。</span><span class="sxs-lookup"><span data-stu-id="b175e-106">Reporting Services not installed on your system unless you have installed SQL Server 2005.</span></span>  
  
## <a name="overview-of-microsoft-reporting-technology-in-visual-basic-applications"></a><span data-ttu-id="b175e-107">Microsoft 报表中 Visual Basic 应用程序的技术的概述</span><span class="sxs-lookup"><span data-stu-id="b175e-107">Overview of Microsoft Reporting Technology in Visual Basic Applications</span></span>  
 <span data-ttu-id="b175e-108">从以下方法用于使用 Microsoft 报表技术应用程序中的选择：</span><span class="sxs-lookup"><span data-stu-id="b175e-108">Choose from the following approaches to use a Microsoft reporting technology in your application:</span></span>  
  
-   <span data-ttu-id="b175e-109">ReportViewer 控件的一个或多个实例添加到 Visual Basic Windows 应用程序。</span><span class="sxs-lookup"><span data-stu-id="b175e-109">Add one or more instances of a ReportViewer control to a Visual Basic Windows application.</span></span>  
  
-   <span data-ttu-id="b175e-110">通过对报表服务器 Web 服务进行调用的以编程方式将 SQL Server Reporting Services 集成。</span><span class="sxs-lookup"><span data-stu-id="b175e-110">Integrate SQL Server Reporting Services programmatically by making calls to the Report Server Web service.</span></span>  
  
-   <span data-ttu-id="b175e-111">使用 ReportViewer 控件和 Microsoft SQL Server 2005 Reporting Services 一起使用，为一个报表处理器为报表查看器和报表服务器使用的控件。</span><span class="sxs-lookup"><span data-stu-id="b175e-111">Use the ReportViewer control and Microsoft SQL Server 2005 Reporting Services together, using the control as a report viewer and a report server as a report processor.</span></span> <span data-ttu-id="b175e-112">（请注意，是否你想要一起使用的报表服务器和 ReportViewer 控件，你必须使用 Reporting Services 的 SQL Server 2005 版本）。</span><span class="sxs-lookup"><span data-stu-id="b175e-112">(Note that you must use the SQL Server 2005 version of Reporting Services if you want to use a report server and the ReportViewer control together).</span></span>  
  
## <a name="using-reportviewer-controls"></a><span data-ttu-id="b175e-113">使用 ReportViewer 控件</span><span class="sxs-lookup"><span data-stu-id="b175e-113">Using ReportViewer Controls</span></span>  
 <span data-ttu-id="b175e-114">嵌入报表功能集成到 Visual Basic Windows 应用程序的最简单方法是将 ReportViewer 控件添加到你的应用程序中的窗体。</span><span class="sxs-lookup"><span data-stu-id="b175e-114">The easiest way to embed report functionality into a Visual Basic Windows application is to add the ReportViewer control to a form in your application.</span></span> <span data-ttu-id="b175e-115">该控件将添加报表处理直接向你的应用程序的功能，并提供一个集成的报表设计器，从而使您可以生成报表使用从任何 ADO.NET 数据对象的数据。</span><span class="sxs-lookup"><span data-stu-id="b175e-115">The control adds report processing capabilities directly to your application and provides an integrated report designer so that you can build reports using data from any ADO.NET data object.</span></span> <span data-ttu-id="b175e-116">全功能 API 提供以编程方式访问控件，并报告，以便你可以配置运行时功能。</span><span class="sxs-lookup"><span data-stu-id="b175e-116">A full-featured API provides programmatic access to the control and reports so that you can configure run-time functionality.</span></span>  
  
 <span data-ttu-id="b175e-117">ReportViewer 提供内置的报表处理和查看单个、 可自由地分发数据控件中的功能。</span><span class="sxs-lookup"><span data-stu-id="b175e-117">ReportViewer provides built-in report processing and viewing capability in a single, freely distributable data control.</span></span> <span data-ttu-id="b175e-118">选择 ReportViewer 控件，是否你需要以下的报表功能：</span><span class="sxs-lookup"><span data-stu-id="b175e-118">Choose ReportViewer controls if you require the following report functionality:</span></span>  
  
-   <span data-ttu-id="b175e-119">在客户端应用程序中处理的报表。</span><span class="sxs-lookup"><span data-stu-id="b175e-119">Report processing in the client application.</span></span> <span data-ttu-id="b175e-120">处理的报表将出现在该控件提供的视图区域。</span><span class="sxs-lookup"><span data-stu-id="b175e-120">A processed report appears in a view area provided by the control.</span></span>  
  
-   <span data-ttu-id="b175e-121">数据绑定到 ADO.NET 数据表。</span><span class="sxs-lookup"><span data-stu-id="b175e-121">Data binding to ADO.NET data tables.</span></span> <span data-ttu-id="b175e-122">你可以创建使用的报表<xref:System.Data.DataTable>提供给控件的实例。</span><span class="sxs-lookup"><span data-stu-id="b175e-122">You can create reports that consume <xref:System.Data.DataTable> instances supplied to the control.</span></span> <span data-ttu-id="b175e-123">此外可以直接到业务对象绑定。</span><span class="sxs-lookup"><span data-stu-id="b175e-123">You can also bind directly to business objects.</span></span>  
  
-   <span data-ttu-id="b175e-124">你可包括在你的应用程序的可再发行控件。</span><span class="sxs-lookup"><span data-stu-id="b175e-124">Redistributable controls that you can include in your application.</span></span>  
  
-   <span data-ttu-id="b175e-125">运行时功能，例如页面导航、 打印、 搜索和导出格式。</span><span class="sxs-lookup"><span data-stu-id="b175e-125">Runtime functionality such as page navigation, printing, searching, and export formats.</span></span> <span data-ttu-id="b175e-126">ReportViewer 工具栏提供对这些操作的支持。</span><span class="sxs-lookup"><span data-stu-id="b175e-126">A ReportViewer toolbar provides support for these operations.</span></span>  
  
 <span data-ttu-id="b175e-127">若要使用 ReportViewer 控件，可以将其从拖动**数据**的 Visual Studio 工具箱中拖动到在 Visual Basic Windows 应用程序的窗体的部分。</span><span class="sxs-lookup"><span data-stu-id="b175e-127">To use the ReportViewer control, you can drag it from the **Data** section of the Visual Studio Toolbox onto a form in your Visual Basic Windows application.</span></span>  
  
### <a name="creating-reports-in-visual-studio-for-reportviewer-controls"></a><span data-ttu-id="b175e-128">为 ReportViewer 控件在 Visual Studio 中创建报表</span><span class="sxs-lookup"><span data-stu-id="b175e-128">Creating Reports in Visual Studio for ReportViewer Controls</span></span>  
 <span data-ttu-id="b175e-129">若要构建在 ReportViewer 中运行的报表，将添加**报表**到你的项目模板。</span><span class="sxs-lookup"><span data-stu-id="b175e-129">To build a report that runs in ReportViewer, add a **Report** template to your project.</span></span> <span data-ttu-id="b175e-130">Visual Studio 创建的客户端报表定义文件 (.rdlc)，将文件添加到你的项目，并在 Visual Studio 工作区中打开的集成的报表设计器。</span><span class="sxs-lookup"><span data-stu-id="b175e-130">Visual Studio creates a client report definition file (.rdlc), adds the file to your project, and opens an integrated report designer in the Visual Studio workspace.</span></span>  
  
 <span data-ttu-id="b175e-131">Visual Studio 报表设计器与集成**数据源**窗口。</span><span class="sxs-lookup"><span data-stu-id="b175e-131">The Visual Studio Report Designer integrates with the **Data Sources** window.</span></span> <span data-ttu-id="b175e-132">当你将字段从**数据源**到报表中，报表设计器窗口将有关数据源的元数据复制到报表定义文件。</span><span class="sxs-lookup"><span data-stu-id="b175e-132">When you drag a field from the **Data Sources** window to the report, the Report Designer copies metadata about the data source into the report definition file.</span></span> <span data-ttu-id="b175e-133">ReportViewer 控件使用此元数据自动生成数据绑定代码。</span><span class="sxs-lookup"><span data-stu-id="b175e-133">This metadata is used by the ReportViewer control to automatically generate data-binding code.</span></span>  
  
 <span data-ttu-id="b175e-134">Visual Studio 报表设计器不包括报表预览功能。</span><span class="sxs-lookup"><span data-stu-id="b175e-134">The Visual Studio Report Designer does not include report preview functionality.</span></span> <span data-ttu-id="b175e-135">若要预览报表、 运行应用程序和预览报表嵌入在其中。</span><span class="sxs-lookup"><span data-stu-id="b175e-135">To preview your report, run the application and preview the report embedded in it.</span></span>  
  
|<span data-ttu-id="b175e-136">若要将基本报表功能添加到你的应用程序</span><span class="sxs-lookup"><span data-stu-id="b175e-136">To add basic report functionality to your application</span></span>|  
|---|    
|<span data-ttu-id="b175e-137">1.将 ReportViewer 控件从**数据**选项卡**工具箱**拖动到窗体。</span><span class="sxs-lookup"><span data-stu-id="b175e-137">1.  Drag a ReportViewer control from the **Data** tab of the **Toolbox** onto your form.</span></span><br /><span data-ttu-id="b175e-138">2.在 **“项目”** 菜单上选择 **“添加新项”**。</span><span class="sxs-lookup"><span data-stu-id="b175e-138">2.  On the **Project** menu, choose **Add New Item**.</span></span> <span data-ttu-id="b175e-139">在**添加新项**对话框中，选择**报表**图标，然后单击**添加**。</span><span class="sxs-lookup"><span data-stu-id="b175e-139">In the **Add New Item** dialog box, select the **Report** icon and click **Add**.</span></span><br />     <span data-ttu-id="b175e-140">在开发环境中，打开的报表设计器和报表 (.rdlc) 文件添加到项目。</span><span class="sxs-lookup"><span data-stu-id="b175e-140">The Report Designer opens in the development environment, and a report (.rdlc) file is added to the project.</span></span><br /><span data-ttu-id="b175e-141">3.将报表项从**工具箱**报表布局上根据需要对其进行排列。</span><span class="sxs-lookup"><span data-stu-id="b175e-141">3.  Drag report items from the **Toolbox** on the report layout and arrange them as you want.</span></span><br /><span data-ttu-id="b175e-142">4.将字段从**数据源**到报表布局中的报表项的窗口。</span><span class="sxs-lookup"><span data-stu-id="b175e-142">4.  Drag fields from the **Data Sources** window to the report items in the report layout.</span></span>|  
  
## <a name="using-reporting-services-in-visual-basic-applications"></a><span data-ttu-id="b175e-143">在 Visual Basic 应用程序中使用 Reporting Services</span><span class="sxs-lookup"><span data-stu-id="b175e-143">Using Reporting Services in Visual Basic Applications</span></span>  
 <span data-ttu-id="b175e-144">Reporting Services 是一种基于服务器的报告技术所包含的 SQL Server。</span><span class="sxs-lookup"><span data-stu-id="b175e-144">Reporting Services is a server-based reporting technology that is included with SQL Server.</span></span> <span data-ttu-id="b175e-145">Reporting Services 包括 ReportViewer 控件中找不到的其他功能。</span><span class="sxs-lookup"><span data-stu-id="b175e-145">Reporting Services includes additional features that are not found in the ReportViewer controls.</span></span> <span data-ttu-id="b175e-146">如果你需要任何以下功能，请选择 Reporting Services:</span><span class="sxs-lookup"><span data-stu-id="b175e-146">Choose Reporting Services if you require any of the following features:</span></span>  
  
-   <span data-ttu-id="b175e-147">向外扩展部署，并且提供了改进的性能，用于复杂或长时间运行的报表和大量报表活动的服务器端报表处理。</span><span class="sxs-lookup"><span data-stu-id="b175e-147">Scale-out deployment and server-side report processing that provides improved performance for complex or long-running reports and for high-volume report activity.</span></span>  
  
-   <span data-ttu-id="b175e-148">集成的数据和报表处理，并支持自定义报表控件和丰富的呈现输出格式。</span><span class="sxs-lookup"><span data-stu-id="b175e-148">Integrated data and report processing, with support for custom report controls and rich rendering output formats.</span></span>  
  
-   <span data-ttu-id="b175e-149">计划报表处理，以便你可以指定运行报表的确切时间。</span><span class="sxs-lookup"><span data-stu-id="b175e-149">Scheduled report processing so that you can specify exactly when reports are run.</span></span>  
  
-   <span data-ttu-id="b175e-150">通过电子邮件或文件共享位置的基于订阅服务器的报表分发。</span><span class="sxs-lookup"><span data-stu-id="b175e-150">Subscriber-based report distribution through email or to file share locations.</span></span>  
  
-   <span data-ttu-id="b175e-151">特别报告，以便根据需要业务用户可以创建报表。</span><span class="sxs-lookup"><span data-stu-id="b175e-151">Ad hoc reporting so that business users can create reports as needed.</span></span>  
  
-   <span data-ttu-id="b175e-152">将自定义的报表输出路由到收件人动态列表的数据驱动的订阅。</span><span class="sxs-lookup"><span data-stu-id="b175e-152">Data-driven subscriptions that route customized report output to a dynamic list of recipients.</span></span>  
  
-   <span data-ttu-id="b175e-153">数据处理、 报表传递、 自定义身份验证和报表呈现的自定义扩展。</span><span class="sxs-lookup"><span data-stu-id="b175e-153">Custom extensions for data processing, report delivery, custom authentication, and report rendering.</span></span>  
  
 <span data-ttu-id="b175e-154">报表服务器作为 Web 服务实现。</span><span class="sxs-lookup"><span data-stu-id="b175e-154">The report server is implemented as Web service.</span></span> <span data-ttu-id="b175e-155">你的应用程序代码必须包含对 Web 服务调用，以访问报表和其他元数据。</span><span class="sxs-lookup"><span data-stu-id="b175e-155">Your application code must include calls to the Web service to access reports and other metadata.</span></span> <span data-ttu-id="b175e-156">Web 服务提供完整的报表服务器实例以编程方式访问。</span><span class="sxs-lookup"><span data-stu-id="b175e-156">The Web service provides complete programmatic access to a report server instance.</span></span>  
  
 <span data-ttu-id="b175e-157">由于 Reporting Services 是一项基于 Web 的报表技术，默认查看器中的 HTML 格式显示呈现的报表。</span><span class="sxs-lookup"><span data-stu-id="b175e-157">Because Reporting Services is a Web-based reporting technology, the default viewer shows reports that are rendered in HTML format.</span></span> <span data-ttu-id="b175e-158">如果你不想要用作默认报表演示文稿格式的 HTML，你将需要编写一个自定义报表查看器查看你的应用程序。</span><span class="sxs-lookup"><span data-stu-id="b175e-158">If you do not want to use HTML as the default report presentation format, you will have to write a custom report viewer for your application.</span></span>  
  
### <a name="creating-reports-in-visual-studio-for-reporting-services"></a><span data-ttu-id="b175e-159">为 Reporting Services 在 Visual Studio 中创建报表</span><span class="sxs-lookup"><span data-stu-id="b175e-159">Creating Reports in Visual Studio for Reporting Services</span></span>  
 <span data-ttu-id="b175e-160">若要生成的报表服务器运行的报表，你创建报表定义 (.rdl) 文件在 Visual Studio 中通过 Business Intelligence Development Studio 中，包含在 SQL Server 2005。</span><span class="sxs-lookup"><span data-stu-id="b175e-160">To build reports that run on a report server, you create report definition (.rdl) files in Visual Studio through the Business Intelligence Development Studio, which is included with SQL Server 2005.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b175e-161">你必须具有 SQL Server 2005 安装才能使用 SQL Server Reporting Services 和 Business Intelligence Development Studio。</span><span class="sxs-lookup"><span data-stu-id="b175e-161">You must have SQL Server 2005 installed in order to use SQL Server Reporting Services and the Business Intelligence Development Studio.</span></span>  
  
 <span data-ttu-id="b175e-162">Business Intelligence Development Studio 添加特定于 SQL Server 组件的项目模板。</span><span class="sxs-lookup"><span data-stu-id="b175e-162">The Business Intelligence Development Studio adds project templates that are specific to SQL Server components.</span></span> <span data-ttu-id="b175e-163">若要创建的报表，可以选择从**报表服务器项目**或**报表服务器项目向导**模板。</span><span class="sxs-lookup"><span data-stu-id="b175e-163">To create reports, you can choose from the **Report Server Project** or **Report Server Project Wizard** templates.</span></span> <span data-ttu-id="b175e-164">你可以指定数据源连接和查询到各种数据源类型，包括 SQL Server、 Oracle、 Analysis Services、 XML 和 SQL Server Integration Services。</span><span class="sxs-lookup"><span data-stu-id="b175e-164">You can specify data source connections and queries to a variety of data source types, including SQL Server, Oracle, Analysis Services, XML, and SQL Server Integration Services.</span></span> <span data-ttu-id="b175e-165">A**数据**选项卡上，**布局**选项卡上，和**预览**选项卡允许你定义数据、 创建报表布局，以及预览同一工作区中所有的报表。</span><span class="sxs-lookup"><span data-stu-id="b175e-165">A **Data** tab, **Layout** tab, and **Preview** tab allow you to define data, create a report layout, and preview the report all in the same workspace.</span></span>  
  
 <span data-ttu-id="b175e-166">为控件或报表服务器创建的报表定义可以在任一技术中重复使用。</span><span class="sxs-lookup"><span data-stu-id="b175e-166">Report definitions that you build for the control or the report server can be reused in either technology.</span></span>  
  
|<span data-ttu-id="b175e-167">若要创建报表服务器运行的报表</span><span class="sxs-lookup"><span data-stu-id="b175e-167">To create a report that runs on a report server</span></span>|  
|---|    
|<span data-ttu-id="b175e-168">1.上**文件**菜单上，选择**新建**。</span><span class="sxs-lookup"><span data-stu-id="b175e-168">1.  On the **File** menu, choose **New**.</span></span><br />     <span data-ttu-id="b175e-169">**“新建项目”** 对话框随即打开。</span><span class="sxs-lookup"><span data-stu-id="b175e-169">The **New Project** dialog box opens.</span></span><br /><span data-ttu-id="b175e-170">2.在**项目类型**窗格中，单击**商业智能项目**。</span><span class="sxs-lookup"><span data-stu-id="b175e-170">2.  In the **Project types** pane, click **Business Intelligence Projects**.</span></span><br /><span data-ttu-id="b175e-171">3.在模板窗格中，选择**报表服务器项目**或**报表服务器项目向导**。</span><span class="sxs-lookup"><span data-stu-id="b175e-171">3.  In the Templates pane, select **Report Server Project** or **Report Server Project Wizard**.</span></span>|  
  
## <a name="using-reportviewer-controls-and-sql-server-reporting-services-together"></a><span data-ttu-id="b175e-172">使用 ReportViewer 控件和 SQL Server Reporting Services 在一起</span><span class="sxs-lookup"><span data-stu-id="b175e-172">Using ReportViewer Controls and SQL Server Reporting Services Together</span></span>  
 <span data-ttu-id="b175e-173">ReportViewer 控件和 SQL Server 2005 Reporting Services 可一起在同一个应用程序。</span><span class="sxs-lookup"><span data-stu-id="b175e-173">The ReportViewer controls and SQL Server 2005 Reporting Services can be used together in the same application.</span></span>  
  
-   <span data-ttu-id="b175e-174">ReportViewer 控件可提供用于在你的应用程序中显示报表查看器。</span><span class="sxs-lookup"><span data-stu-id="b175e-174">The ReportViewer control provides a viewer that is used to display reports in your application.</span></span>  
  
-   <span data-ttu-id="b175e-175">Reporting Services 提供报表，并在远程服务器上执行所有处理。</span><span class="sxs-lookup"><span data-stu-id="b175e-175">Reporting Services provides the reports and performs all processing on a remote server.</span></span>  
  
 <span data-ttu-id="b175e-176">可以配置 ReportViewer 控件以显示远程的 Reporting Services 报表服务器上的存储和处理的报表。</span><span class="sxs-lookup"><span data-stu-id="b175e-176">The ReportViewer control can be configured to show reports that are stored and processed on a remote Reporting Services report server.</span></span> <span data-ttu-id="b175e-177">此类型的配置称为*远程处理模式*。</span><span class="sxs-lookup"><span data-stu-id="b175e-177">This type of configuration is called *remote processing mode*.</span></span> <span data-ttu-id="b175e-178">在远程处理模式下，该控件将请求存储在远程报表服务器的报表。</span><span class="sxs-lookup"><span data-stu-id="b175e-178">In remote processing mode, the control requests a report that is stored on a remote report server.</span></span> <span data-ttu-id="b175e-179">报表服务器执行所有报表处理、 数据处理和报表呈现。</span><span class="sxs-lookup"><span data-stu-id="b175e-179">The report server performs all report processing, data processing, and report rendering.</span></span> <span data-ttu-id="b175e-180">已完成的呈现的报表是返回到控件，显示在视图区域。</span><span class="sxs-lookup"><span data-stu-id="b175e-180">A finished, rendered report is returned to the control and displayed in the view area.</span></span>  
  
 <span data-ttu-id="b175e-181">在支持其他报表服务器运行的报表导出格式，具有不同的报表参数化实现，使用支持的报表服务器，并通过基于角色的授权模型上访问的数据源类型报表服务器。</span><span class="sxs-lookup"><span data-stu-id="b175e-181">Reports that run on a report server support additional export formats, have a different report parameterization implementation, use the data source types that are supported by the report server, and are accessed through the role-based authorization model on the report server.</span></span>  
  
 <span data-ttu-id="b175e-182">若要使用远程处理模式，请指定的 URL 和服务器报表的路径配置 ReportViewer 控件时。</span><span class="sxs-lookup"><span data-stu-id="b175e-182">To use remote processing mode, specify the URL and path to a server report when configuring the ReportViewer control.</span></span>
