---
title: "在 Visual Basic 中实现 IEnumerable |Microsoft 文档"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
dev_langs:
- VB
helpviewer_keywords:
- control flow [Visual Basic]
- enumerable interfaces
- loop structures, optimizing performance
- control flow
ms.assetid: c60d7589-51f2-4463-a2d5-22506bbc1554
caps.latest.revision: 15
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 9f5b8ebb69c9206ff90b05e748c64d29d82f7a16
ms.openlocfilehash: ab65cf2cdafa5a4fc8761a495a2ae35a078a1d26
ms.contentlocale: zh-cn
ms.lasthandoff: 04/12/2017

---
# <a name="walkthrough-implementing-ienumerableof-t-in-visual-basic"></a><span data-ttu-id="24410-102">演练：在 Visual Basic 中实现 IEnumerable(Of T)</span><span class="sxs-lookup"><span data-stu-id="24410-102">Walkthrough: Implementing IEnumerable(Of T) in Visual Basic</span></span>
<span data-ttu-id="24410-103"><xref:System.Collections.Generic.IEnumerable%601>接口由可以一次返回一系列值的一项的类实现。</xref:System.Collections.Generic.IEnumerable%601></span><span class="sxs-lookup"><span data-stu-id="24410-103">The <xref:System.Collections.Generic.IEnumerable%601> interface is implemented by classes that can return a sequence of values one item at a time.</span></span> <span data-ttu-id="24410-104">返回的数据一次一个项目是不需要将整个数据集加载到内存，无法使用它的优势。</span><span class="sxs-lookup"><span data-stu-id="24410-104">The advantage of returning data one item at a time is that you do not have to load the complete set of data into memory to work with it.</span></span> <span data-ttu-id="24410-105">只需要足够的内存用于从数据中加载的单个项。</span><span class="sxs-lookup"><span data-stu-id="24410-105">You only have to use sufficient memory to load a single item from the data.</span></span> <span data-ttu-id="24410-106">类实现`IEnumerable(T)`接口可与使用`For Each`循环或 LINQ 查询。</span><span class="sxs-lookup"><span data-stu-id="24410-106">Classes that implement the `IEnumerable(T)` interface can be used with `For Each` loops or LINQ queries.</span></span>  
  
 <span data-ttu-id="24410-107">例如，假设一个应用程序必须读取一个大型文本文件并将每一行返回从与特定搜索条件匹配的文件。</span><span class="sxs-lookup"><span data-stu-id="24410-107">For example, consider an application that must read a large text file and return each line from the file that matches particular search criteria.</span></span> <span data-ttu-id="24410-108">应用程序使用 LINQ 查询以从与指定的条件匹配的文件中返回行。</span><span class="sxs-lookup"><span data-stu-id="24410-108">The application uses a LINQ query to return lines from the file that match the specified criteria.</span></span> <span data-ttu-id="24410-109">若要使用 LINQ 查询来查询该文件的内容，应用程序可以加载到一个数组或集合的文件的内容。</span><span class="sxs-lookup"><span data-stu-id="24410-109">To query the contents of the file by using a LINQ query, the application could load the contents of the file into an array or a collection.</span></span> <span data-ttu-id="24410-110">但是，将整个文件加载到数组或集合会占用比所需的内存比以往更多的内存。</span><span class="sxs-lookup"><span data-stu-id="24410-110">However, loading the whole file into an array or collection would consume far more memory than is required.</span></span> <span data-ttu-id="24410-111">LINQ 查询无法使用 enumerable 类，返回与搜索条件匹配的值改为查询该文件的内容。</span><span class="sxs-lookup"><span data-stu-id="24410-111">The LINQ query could instead query the file contents by using an enumerable class, returning only values that match the search criteria.</span></span> <span data-ttu-id="24410-112">返回仅有少数的查询匹配的值会消耗内存更少。</span><span class="sxs-lookup"><span data-stu-id="24410-112">Queries that return only a few matching values would consume far less memory.</span></span>  
  
 <span data-ttu-id="24410-113">您可以创建一个类以实现<xref:System.Collections.Generic.IEnumerable%601>接口，以公开为可枚举数据源数据。</xref:System.Collections.Generic.IEnumerable%601></span><span class="sxs-lookup"><span data-stu-id="24410-113">You can create a class that implements the <xref:System.Collections.Generic.IEnumerable%601> interface to expose source data as enumerable data.</span></span> <span data-ttu-id="24410-114">您实现的类`IEnumerable(T)`接口会需要另一个类，该类实现<xref:System.Collections.Generic.IEnumerator%601>接口以循环访问源数据。</xref:System.Collections.Generic.IEnumerator%601></span><span class="sxs-lookup"><span data-stu-id="24410-114">Your class that implements the `IEnumerable(T)` interface will require another class that implements the <xref:System.Collections.Generic.IEnumerator%601> interface to iterate through the source data.</span></span> <span data-ttu-id="24410-115">这两个类，可以按顺序为特定类型返回的数据的项。</span><span class="sxs-lookup"><span data-stu-id="24410-115">These two classes enable you to return items of data sequentially as a specific type.</span></span>  
  
 <span data-ttu-id="24410-116">在本演练中，将创建一个类以实现`IEnumerable(Of String)`接口和实现类`IEnumerator(Of String)`接口，以一次读取文本文件的一行。</span><span class="sxs-lookup"><span data-stu-id="24410-116">In this walkthrough, you will create a class that implements the `IEnumerable(Of String)` interface and a class that implements the `IEnumerator(Of String)` interface to read a text file one line at a time.</span></span>  
  
[!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  
  
## <a name="creating-the-enumerable-class"></a><span data-ttu-id="24410-117">创建可枚举类</span><span class="sxs-lookup"><span data-stu-id="24410-117">Creating the Enumerable Class</span></span>  
  
|<span data-ttu-id="24410-118">若要创建可枚举类项目</span><span class="sxs-lookup"><span data-stu-id="24410-118">To create the enumerable class project</span></span>|  
|---|  
|<span data-ttu-id="24410-119">1.在[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]，请在**文件**菜单上，指向**新建**，然后单击**项目**。</span><span class="sxs-lookup"><span data-stu-id="24410-119">1.  In [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], on the **File** menu, point to **New** and then click **Project**.</span></span><br /><span data-ttu-id="24410-120">2.在**新项目**对话框中，在**项目类型**窗格中，请确保**Windows**处于选中状态。</span><span class="sxs-lookup"><span data-stu-id="24410-120">2.  In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="24410-121">选择**类库**中**模板**窗格。</span><span class="sxs-lookup"><span data-stu-id="24410-121">Select **Class Library** in the **Templates** pane.</span></span> <span data-ttu-id="24410-122">在**名称**框中，键入`StreamReaderEnumerable`，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="24410-122">In the **Name** box, type `StreamReaderEnumerable`, and then click **OK**.</span></span> <span data-ttu-id="24410-123">将显示新项目。</span><span class="sxs-lookup"><span data-stu-id="24410-123">The new project is displayed.</span></span><br /><span data-ttu-id="24410-124">3.在**解决方案资源管理器**，用鼠标右键单击 Class1.vb 文件，然后单击**重命名**。</span><span class="sxs-lookup"><span data-stu-id="24410-124">3.  In **Solution Explorer**, right-click the Class1.vb file and click **Rename**.</span></span> <span data-ttu-id="24410-125">文件重命名为`StreamReaderEnumerable.vb`，然后按 enter 键。</span><span class="sxs-lookup"><span data-stu-id="24410-125">Rename the file to `StreamReaderEnumerable.vb` and press ENTER.</span></span> <span data-ttu-id="24410-126">重命名该文件也进行重命名为该类`StreamReaderEnumerable`。</span><span class="sxs-lookup"><span data-stu-id="24410-126">Renaming the file will also rename the class to `StreamReaderEnumerable`.</span></span> <span data-ttu-id="24410-127">此类将实现`IEnumerable(Of String)`接口。</span><span class="sxs-lookup"><span data-stu-id="24410-127">This class will implement the `IEnumerable(Of String)` interface.</span></span><br /><span data-ttu-id="24410-128">4.右击 StreamReaderEnumerable 项目，指向**添加**，然后单击**新项**。</span><span class="sxs-lookup"><span data-stu-id="24410-128">4.  Right-click the StreamReaderEnumerable project, point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="24410-129">选择**类**模板。</span><span class="sxs-lookup"><span data-stu-id="24410-129">Select the **Class** template.</span></span> <span data-ttu-id="24410-130">在**名称**框中，键入`StreamReaderEnumerator.vb`，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="24410-130">In the **Name** box, type `StreamReaderEnumerator.vb` and click **OK**.</span></span>|  
  
 <span data-ttu-id="24410-131">此项目中的第一个类是可枚举类，将实现`IEnumerable(Of String)`接口。</span><span class="sxs-lookup"><span data-stu-id="24410-131">The first class in this project is the enumerable class and will implement the `IEnumerable(Of String)` interface.</span></span> <span data-ttu-id="24410-132">此泛型接口实现<xref:System.Collections.IEnumerable>接口，并保证此类的使用者可以访问值类型化为`String`。</xref:System.Collections.IEnumerable></span><span class="sxs-lookup"><span data-stu-id="24410-132">This generic interface implements the <xref:System.Collections.IEnumerable> interface and guarantees that consumers of this class can access values typed as `String`.</span></span>  
  
|<span data-ttu-id="24410-133">若要添加代码以实现 IEnumerable</span><span class="sxs-lookup"><span data-stu-id="24410-133">To add the code to implement IEnumerable</span></span>|  
|---|  
|<span data-ttu-id="24410-134">1.打开 StreamReaderEnumerable.vb 文件。</span><span class="sxs-lookup"><span data-stu-id="24410-134">1.  Open the StreamReaderEnumerable.vb file.</span></span><br /><span data-ttu-id="24410-135">2.在后面的行上`Public Class StreamReaderEnumerable`，键入以下命令并按 ENTER。</span><span class="sxs-lookup"><span data-stu-id="24410-135">2.  On the line after `Public Class StreamReaderEnumerable`, type the following and press ENTER.</span></span><br />     <span data-ttu-id="24410-136">[!code-vb[VbVbalrIteratorWalkthrough #&1;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_1.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-136">[!code-vb[VbVbalrIteratorWalkthrough#1](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_1.vb)]</span></span><br />     [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]<span data-ttu-id="24410-137">具有所需的成员的类将自动填充`IEnumerable(Of String)`接口。</span><span class="sxs-lookup"><span data-stu-id="24410-137"> automatically populates the class with the members that are required by the `IEnumerable(Of String)` interface.</span></span><br /><span data-ttu-id="24410-138">3.一次，此可枚举类将从文本文件的一行读取行。</span><span class="sxs-lookup"><span data-stu-id="24410-138">3.  This enumerable class will read lines from a text file one line at a time.</span></span> <span data-ttu-id="24410-139">将以下代码添加到要公开将文件路径作为输入参数的公共构造函数的类。</span><span class="sxs-lookup"><span data-stu-id="24410-139">Add the following code to the class to expose a public constructor that takes a file path as an input parameter.</span></span><br />     <span data-ttu-id="24410-140">[!code-vb[VbVbalrIteratorWalkthrough #&2;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_2.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-140">[!code-vb[VbVbalrIteratorWalkthrough#2](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_2.vb)]</span></span><br /><span data-ttu-id="24410-141">4.实现<xref:System.Collections.Generic.IEnumerable%601.GetEnumerator%2A>方法`IEnumerable(Of String)`接口将返回的新实例`StreamReaderEnumerator`类</xref:System.Collections.Generic.IEnumerable%601.GetEnumerator%2A></span><span class="sxs-lookup"><span data-stu-id="24410-141">4.  Your implementation of the <xref:System.Collections.Generic.IEnumerable%601.GetEnumerator%2A> method of the `IEnumerable(Of String)` interface will return a new instance of the `StreamReaderEnumerator` class.</span></span> <span data-ttu-id="24410-142">实现`GetEnumerator`方法`IEnumerable`接口可以成为`Private`，这是因为您必须公开只有的成员`IEnumerable(Of String)`接口。</span><span class="sxs-lookup"><span data-stu-id="24410-142">The implementation of the `GetEnumerator` method of the `IEnumerable` interface can be made `Private`, because you have to expose only members of the `IEnumerable(Of String)` interface.</span></span> <span data-ttu-id="24410-143">替换的代码，[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]为生成`GetEnumerator`方法替换为以下代码。</span><span class="sxs-lookup"><span data-stu-id="24410-143">Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `GetEnumerator` methods with the following code.</span></span><br />     <span data-ttu-id="24410-144">[!code-vb[VbVbalrIteratorWalkthrough #&3;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_3.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-144">[!code-vb[VbVbalrIteratorWalkthrough#3](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_3.vb)]</span></span>|  
  
|<span data-ttu-id="24410-145">若要添加代码以实现 IEnumerator</span><span class="sxs-lookup"><span data-stu-id="24410-145">To add the code to implement IEnumerator</span></span>|  
|---|  
|<span data-ttu-id="24410-146">1.打开 StreamReaderEnumerator.vb 文件。</span><span class="sxs-lookup"><span data-stu-id="24410-146">1.  Open the StreamReaderEnumerator.vb file.</span></span><br /><span data-ttu-id="24410-147">2.在后面的行上`Public Class StreamReaderEnumerator`，键入以下命令并按 ENTER。</span><span class="sxs-lookup"><span data-stu-id="24410-147">2.  On the line after `Public Class StreamReaderEnumerator`, type the following and press ENTER.</span></span><br />     <span data-ttu-id="24410-148">[!code-vb[VbVbalrIteratorWalkthrough #&4;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_4.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-148">[!code-vb[VbVbalrIteratorWalkthrough#4](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_4.vb)]</span></span><br />     [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]<span data-ttu-id="24410-149">具有所需的成员的类将自动填充`IEnumerator(Of String)`接口。</span><span class="sxs-lookup"><span data-stu-id="24410-149"> automatically populates the class with the members that are required by the `IEnumerator(Of String)` interface.</span></span><br /><span data-ttu-id="24410-150">3.枚举器类打开文本文件，并执行文件 I/O，以从文件读取的行。</span><span class="sxs-lookup"><span data-stu-id="24410-150">3.  The enumerator class opens the text file and performs the file I/O to read the lines from the file.</span></span> <span data-ttu-id="24410-151">将下面的代码添加到类，以公开公共构造函数作为输入参数的文件路径和打开文本文件进行读取。</span><span class="sxs-lookup"><span data-stu-id="24410-151">Add the following code to the class to expose a public constructor that takes a file path as an input parameter and open the text file for reading.</span></span><br />     <span data-ttu-id="24410-152">[!code-vb[VbVbalrIteratorWalkthrough #&5;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_5.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-152">[!code-vb[VbVbalrIteratorWalkthrough#5](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_5.vb)]</span></span><br /><span data-ttu-id="24410-153">4.`Current`属性都`IEnumerator(Of String)`和`IEnumerator`从文本文件作为接口返回的当前项`String`。</span><span class="sxs-lookup"><span data-stu-id="24410-153">4.  The `Current` properties for both the `IEnumerator(Of String)` and `IEnumerator` interfaces return the current item from the text file as a `String`.</span></span> <span data-ttu-id="24410-154">实现`Current`属性`IEnumerator`接口可以成为`Private`，这是因为您必须公开只有的成员`IEnumerator(Of String)`接口。</span><span class="sxs-lookup"><span data-stu-id="24410-154">The implementation of the `Current` property of the `IEnumerator` interface can be made `Private`, because you have to expose only members of the `IEnumerator(Of String)` interface.</span></span> <span data-ttu-id="24410-155">替换的代码，[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]为生成`Current`属性替换为以下代码。</span><span class="sxs-lookup"><span data-stu-id="24410-155">Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `Current` properties with the following code.</span></span><br />     <span data-ttu-id="24410-156">[!code-vb[VbVbalrIteratorWalkthrough #&6;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_6.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-156">[!code-vb[VbVbalrIteratorWalkthrough#6](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_6.vb)]</span></span><br /><span data-ttu-id="24410-157">5.`MoveNext`方法`IEnumerator`界面导航到文本文件中的下一项并更新所返回的值`Current`属性。</span><span class="sxs-lookup"><span data-stu-id="24410-157">5.  The `MoveNext` method of the `IEnumerator` interface navigates to the next item in the text file and updates the value that is returned by the `Current` property.</span></span> <span data-ttu-id="24410-158">如果没有更多的项，若要读取，`MoveNext`方法将返回`False`; 否则为`MoveNext`方法将返回`True`。</span><span class="sxs-lookup"><span data-stu-id="24410-158">If there are no more items to read, the `MoveNext` method returns `False`; otherwise the `MoveNext` method returns `True`.</span></span> <span data-ttu-id="24410-159">将以下代码添加到 `MoveNext` 方法中。</span><span class="sxs-lookup"><span data-stu-id="24410-159">Add the following code to the `MoveNext` method.</span></span><br />     <span data-ttu-id="24410-160">[!code-vb[VbVbalrIteratorWalkthrough #&7;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_7.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-160">[!code-vb[VbVbalrIteratorWalkthrough#7](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_7.vb)]</span></span><br /><span data-ttu-id="24410-161">6.`Reset`方法`IEnumerator`接口指示迭代器指向该文本文件开始，并清除当前项的值。</span><span class="sxs-lookup"><span data-stu-id="24410-161">6.  The `Reset` method of the `IEnumerator` interface directs the iterator to point to the start of the text file and clears the current item value.</span></span> <span data-ttu-id="24410-162">将以下代码添加到 `Reset` 方法中。</span><span class="sxs-lookup"><span data-stu-id="24410-162">Add the following code to the `Reset` method.</span></span><br />     <span data-ttu-id="24410-163">[!code-vb[VbVbalrIteratorWalkthrough #&8;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_8.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-163">[!code-vb[VbVbalrIteratorWalkthrough#8](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_8.vb)]</span></span><br /><span data-ttu-id="24410-164">7.`Dispose`方法`IEnumerator`接口可保证在销毁迭代器之前，释放所有非托管的资源。</span><span class="sxs-lookup"><span data-stu-id="24410-164">7.  The `Dispose` method of the `IEnumerator` interface guarantees that all unmanaged resources are released before the iterator is destroyed.</span></span> <span data-ttu-id="24410-165">使用的文件句柄`StreamReader`对象是一个非托管的资源，销毁该迭代器实例之前，必须关闭。</span><span class="sxs-lookup"><span data-stu-id="24410-165">The file handle that is used by the `StreamReader` object is an unmanaged resource and must be closed before the iterator instance is destroyed.</span></span> <span data-ttu-id="24410-166">替换的代码，[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]为生成`Dispose`方法替换为以下代码。</span><span class="sxs-lookup"><span data-stu-id="24410-166">Replace the code that [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] generated for the `Dispose` method with the following code.</span></span><br />     <span data-ttu-id="24410-167">[!code-vb[VbVbalrIteratorWalkthrough #&9;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_9.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-167">[!code-vb[VbVbalrIteratorWalkthrough#9](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_9.vb)]</span></span>|  
  
## <a name="using-the-sample-iterator"></a><span data-ttu-id="24410-168">使用示例迭代器</span><span class="sxs-lookup"><span data-stu-id="24410-168">Using the Sample Iterator</span></span>  
 <span data-ttu-id="24410-169">可以在需要实现的对象的控制结构以及代码中使用 enumerable 类`IEnumerable`，如`For Next`循环或 LINQ 查询。</span><span class="sxs-lookup"><span data-stu-id="24410-169">You can use an enumerable class in your code together with control structures that require an object that implements `IEnumerable`, such as a `For Next` loop or a LINQ query.</span></span> <span data-ttu-id="24410-170">下面的示例演示`StreamReaderEnumerable`LINQ 查询中。</span><span class="sxs-lookup"><span data-stu-id="24410-170">The following example shows the `StreamReaderEnumerable` in a LINQ query.</span></span>  
  
 <span data-ttu-id="24410-171">[!code-vb[VbVbalrIteratorWalkthrough #&10;](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_10.vb)]</span><span class="sxs-lookup"><span data-stu-id="24410-171">[!code-vb[VbVbalrIteratorWalkthrough#10](../../../../visual-basic/programming-guide/language-features/control-flow/codesnippet/VisualBasic/walkthrough-implementing-ienumerable-of-t_10.vb)]</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="24410-172">另请参阅</span><span class="sxs-lookup"><span data-stu-id="24410-172">See Also</span></span>  
 <span data-ttu-id="24410-173">[在 Visual Basic 中的 LINQ 简介](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md) </span><span class="sxs-lookup"><span data-stu-id="24410-173">[Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md) </span></span>  
<span data-ttu-id="24410-174"> [控制流](../../../../visual-basic/programming-guide/language-features/control-flow/index.md) </span><span class="sxs-lookup"><span data-stu-id="24410-174"> [Control Flow](../../../../visual-basic/programming-guide/language-features/control-flow/index.md) </span></span>  
<span data-ttu-id="24410-175"> [循环结构](../../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md) </span><span class="sxs-lookup"><span data-stu-id="24410-175"> [Loop Structures](../../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md) </span></span>  
<span data-ttu-id="24410-176"> [For Each...Next 语句](../../../../visual-basic/language-reference/statements/for-each-next-statement.md)</span><span class="sxs-lookup"><span data-stu-id="24410-176"> [For Each...Next Statement](../../../../visual-basic/language-reference/statements/for-each-next-statement.md)</span></span>

