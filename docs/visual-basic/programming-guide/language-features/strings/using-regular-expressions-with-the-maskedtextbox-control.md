---
title: "在 MaskedTextBox 控件中使用正则表达式 (Visual Basic)"
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- strings [Visual Basic], regular expressions
- strings [Visual Basic], masked edit
ms.assetid: 2a048fb0-7053-487d-b2c5-ffa5e22ed6f9
caps.latest.revision: "10"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: 2638ed804593dd52481bd3865e1c67c5fdb2dcf9
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/21/2017
---
# <a name="using-regular-expressions-with-the-maskedtextbox-control-in-visual-basic"></a><span data-ttu-id="35943-102">在 MaskedTextBox 控件中使用正则表达式 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="35943-102">Using Regular Expressions with the MaskedTextBox Control in Visual Basic</span></span>
<span data-ttu-id="35943-103">此示例演示如何将简单的正则表达式，用于转换<xref:System.Windows.Forms.MaskedTextBox>控件。</span><span class="sxs-lookup"><span data-stu-id="35943-103">This example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control.</span></span>  
  
## <a name="description-of-the-masking-language"></a><span data-ttu-id="35943-104">屏蔽语言的说明</span><span class="sxs-lookup"><span data-stu-id="35943-104">Description of the Masking Language</span></span>  
 <span data-ttu-id="35943-105">标准<xref:System.Windows.Forms.MaskedTextBox>屏蔽语言取决于使用的那个`Masked Edit`中控制[!INCLUDE[vbprvb](~/includes/vbprvb-md.md)]6.0，并且应该为从该平台迁移的用户所熟悉。</span><span class="sxs-lookup"><span data-stu-id="35943-105">The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] 6.0 and should be familiar to users migrating from that platform.</span></span>  
  
 <span data-ttu-id="35943-106"><xref:System.Windows.Forms.MaskedTextBox.Mask%2A>属性<xref:System.Windows.Forms.MaskedTextBox>控件指定要使用哪些输入的掩码。</span><span class="sxs-lookup"><span data-stu-id="35943-106">The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use.</span></span> <span data-ttu-id="35943-107">掩码必须是组成一个或多个以下表格中的屏蔽元素的字符串。</span><span class="sxs-lookup"><span data-stu-id="35943-107">The mask must be a string composed of one or more of the masking elements from the following table.</span></span>  
  
|<span data-ttu-id="35943-108">屏蔽元素</span><span class="sxs-lookup"><span data-stu-id="35943-108">Masking element</span></span>|<span data-ttu-id="35943-109">描述</span><span class="sxs-lookup"><span data-stu-id="35943-109">Description</span></span>|<span data-ttu-id="35943-110">正则表达式元素</span><span class="sxs-lookup"><span data-stu-id="35943-110">Regular expression element</span></span>|  
|---------------------|-----------------|--------------------------------|  
|<span data-ttu-id="35943-111">0</span><span class="sxs-lookup"><span data-stu-id="35943-111">0</span></span>|<span data-ttu-id="35943-112">0 到 9 之间的任何单个数字。</span><span class="sxs-lookup"><span data-stu-id="35943-112">Any single digit between 0 and 9.</span></span> <span data-ttu-id="35943-113">所需的项。</span><span class="sxs-lookup"><span data-stu-id="35943-113">Entry required.</span></span>|<span data-ttu-id="35943-114">\d</span><span class="sxs-lookup"><span data-stu-id="35943-114">\d</span></span>|  
|<span data-ttu-id="35943-115">9</span><span class="sxs-lookup"><span data-stu-id="35943-115">9</span></span>|<span data-ttu-id="35943-116">数字或空格。</span><span class="sxs-lookup"><span data-stu-id="35943-116">Digit or space.</span></span> <span data-ttu-id="35943-117">可选的条目。</span><span class="sxs-lookup"><span data-stu-id="35943-117">Entry optional.</span></span>|<span data-ttu-id="35943-118">[\d]？</span><span class="sxs-lookup"><span data-stu-id="35943-118">[ \d]?</span></span>|  
|#|<span data-ttu-id="35943-119">数字或空格。</span><span class="sxs-lookup"><span data-stu-id="35943-119">Digit or space.</span></span> <span data-ttu-id="35943-120">可选的条目。</span><span class="sxs-lookup"><span data-stu-id="35943-120">Entry optional.</span></span> <span data-ttu-id="35943-121">如果此位置为空掩码中，它将呈现为一个空格。</span><span class="sxs-lookup"><span data-stu-id="35943-121">If this position is left blank in the mask, it will be rendered as a space.</span></span> <span data-ttu-id="35943-122">加号 （+） 和减号 （-） 允许符号。</span><span class="sxs-lookup"><span data-stu-id="35943-122">Plus (+) and minus (-) signs are allowed.</span></span>|<span data-ttu-id="35943-123">[\d+-]？</span><span class="sxs-lookup"><span data-stu-id="35943-123">[ \d+-]?</span></span>|  
|<span data-ttu-id="35943-124">L</span><span class="sxs-lookup"><span data-stu-id="35943-124">L</span></span>|<span data-ttu-id="35943-125">ASCII 字母。</span><span class="sxs-lookup"><span data-stu-id="35943-125">ASCII letter.</span></span> <span data-ttu-id="35943-126">所需的项。</span><span class="sxs-lookup"><span data-stu-id="35943-126">Entry required.</span></span>|<span data-ttu-id="35943-127">[-zA-A-z]</span><span class="sxs-lookup"><span data-stu-id="35943-127">[a-zA-Z]</span></span>|  
|<span data-ttu-id="35943-128">?</span><span class="sxs-lookup"><span data-stu-id="35943-128">?</span></span>|<span data-ttu-id="35943-129">ASCII 字母。</span><span class="sxs-lookup"><span data-stu-id="35943-129">ASCII letter.</span></span> <span data-ttu-id="35943-130">可选的条目。</span><span class="sxs-lookup"><span data-stu-id="35943-130">Entry optional.</span></span>|<span data-ttu-id="35943-131">[-zA-A-z]？</span><span class="sxs-lookup"><span data-stu-id="35943-131">[a-zA-Z]?</span></span>|  
|&|<span data-ttu-id="35943-132">字符。</span><span class="sxs-lookup"><span data-stu-id="35943-132">Character.</span></span> <span data-ttu-id="35943-133">所需的项。</span><span class="sxs-lookup"><span data-stu-id="35943-133">Entry required.</span></span>|<span data-ttu-id="35943-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span><span class="sxs-lookup"><span data-stu-id="35943-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span></span>|  
|<span data-ttu-id="35943-135">C</span><span class="sxs-lookup"><span data-stu-id="35943-135">C</span></span>|<span data-ttu-id="35943-136">字符。</span><span class="sxs-lookup"><span data-stu-id="35943-136">Character.</span></span> <span data-ttu-id="35943-137">可选的条目。</span><span class="sxs-lookup"><span data-stu-id="35943-137">Entry optional.</span></span>|<span data-ttu-id="35943-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]？</span><span class="sxs-lookup"><span data-stu-id="35943-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span></span>|  
|<span data-ttu-id="35943-139">包含当前请求的 URL 的</span><span class="sxs-lookup"><span data-stu-id="35943-139">A</span></span>|<span data-ttu-id="35943-140">字母数字。</span><span class="sxs-lookup"><span data-stu-id="35943-140">Alphanumeric.</span></span> <span data-ttu-id="35943-141">可选的条目。</span><span class="sxs-lookup"><span data-stu-id="35943-141">Entry optional.</span></span>|<span data-ttu-id="35943-142">\W</span><span class="sxs-lookup"><span data-stu-id="35943-142">\W</span></span>|  
|<span data-ttu-id="35943-143">。</span><span class="sxs-lookup"><span data-stu-id="35943-143">.</span></span>|<span data-ttu-id="35943-144">相应于区域性的小数点占位符。</span><span class="sxs-lookup"><span data-stu-id="35943-144">Culture-appropriate decimal placeholder.</span></span>|<span data-ttu-id="35943-145">不可用。</span><span class="sxs-lookup"><span data-stu-id="35943-145">Not available.</span></span>|  
|<span data-ttu-id="35943-146">,</span><span class="sxs-lookup"><span data-stu-id="35943-146">,</span></span>|<span data-ttu-id="35943-147">相应数千于区域性的占位符。</span><span class="sxs-lookup"><span data-stu-id="35943-147">Culture-appropriate thousands placeholder.</span></span>|<span data-ttu-id="35943-148">不可用。</span><span class="sxs-lookup"><span data-stu-id="35943-148">Not available.</span></span>|  
|<span data-ttu-id="35943-149">:</span><span class="sxs-lookup"><span data-stu-id="35943-149">:</span></span>|<span data-ttu-id="35943-150">相应于区域性的时间分隔符。</span><span class="sxs-lookup"><span data-stu-id="35943-150">Culture-appropriate time separator.</span></span>|<span data-ttu-id="35943-151">不可用。</span><span class="sxs-lookup"><span data-stu-id="35943-151">Not available.</span></span>|  
|/|<span data-ttu-id="35943-152">相应于区域性的日期分隔符。</span><span class="sxs-lookup"><span data-stu-id="35943-152">Culture-appropriate date separator.</span></span>|<span data-ttu-id="35943-153">不可用。</span><span class="sxs-lookup"><span data-stu-id="35943-153">Not available.</span></span>|  
|$|<span data-ttu-id="35943-154">相应于区域性的货币符号。</span><span class="sxs-lookup"><span data-stu-id="35943-154">Culture-appropriate currency symbol.</span></span>|<span data-ttu-id="35943-155">不可用。</span><span class="sxs-lookup"><span data-stu-id="35943-155">Not available.</span></span>|  
|\<|<span data-ttu-id="35943-156">将转换为小写后面的所有字符。</span><span class="sxs-lookup"><span data-stu-id="35943-156">Converts all characters that follow to lowercase.</span></span>|<span data-ttu-id="35943-157">不可用。</span><span class="sxs-lookup"><span data-stu-id="35943-157">Not available.</span></span>|  
|>|<span data-ttu-id="35943-158">将转换为大写后面的所有字符。</span><span class="sxs-lookup"><span data-stu-id="35943-158">Converts all characters that follow to uppercase.</span></span>|<span data-ttu-id="35943-159">不可用。</span><span class="sxs-lookup"><span data-stu-id="35943-159">Not available.</span></span>|  
|<span data-ttu-id="35943-160">&#124;</span><span class="sxs-lookup"><span data-stu-id="35943-160">&#124;</span></span>|<span data-ttu-id="35943-161">撤消上一个 shift 向上或向下移动。</span><span class="sxs-lookup"><span data-stu-id="35943-161">Undoes a previous shift up or shift down.</span></span>|<span data-ttu-id="35943-162">不可用。</span><span class="sxs-lookup"><span data-stu-id="35943-162">Not available.</span></span>|  
|\|<span data-ttu-id="35943-163">掩码字符，将其转换为原义进行转义。</span><span class="sxs-lookup"><span data-stu-id="35943-163">Escapes a mask character, turning it into a literal.</span></span> <span data-ttu-id="35943-164">"\\\\"是反斜杠的转义序列。</span><span class="sxs-lookup"><span data-stu-id="35943-164">"\\\\" is the escape sequence for a backslash.</span></span>|\|  
|<span data-ttu-id="35943-165">所有其他字符。</span><span class="sxs-lookup"><span data-stu-id="35943-165">All other characters.</span></span>|<span data-ttu-id="35943-166">文本。</span><span class="sxs-lookup"><span data-stu-id="35943-166">Literals.</span></span> <span data-ttu-id="35943-167">所有非掩码元素将显示为本身内<xref:System.Windows.Forms.MaskedTextBox>。</span><span class="sxs-lookup"><span data-stu-id="35943-167">All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>.</span></span>|<span data-ttu-id="35943-168">所有其他字符。</span><span class="sxs-lookup"><span data-stu-id="35943-168">All other characters.</span></span>|  
  
 <span data-ttu-id="35943-169">小数点 （.）、 分之几 （，）、 时间 （:）、 日期 （/），而货币 （$） 符号默认为由应用程序的区域性定义时，显示这些符号中。</span><span class="sxs-lookup"><span data-stu-id="35943-169">The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture.</span></span> <span data-ttu-id="35943-170">你可以强制使用显示的另一个区域性符号<xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="35943-170">You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property.</span></span>  
  
## <a name="regular-expressions-and-masks"></a><span data-ttu-id="35943-171">正则表达式和蒙板</span><span class="sxs-lookup"><span data-stu-id="35943-171">Regular Expressions and Masks</span></span>  
 <span data-ttu-id="35943-172">你可以使用正则表达式和掩码验证用户输入，但它们并不完全相同。</span><span class="sxs-lookup"><span data-stu-id="35943-172">Although you can use regular expressions and masks to validate user input, they are not completely equivalent.</span></span> <span data-ttu-id="35943-173">正则表达式可以表示更复杂的模式，比掩码，但更简洁地采用与区域相关的格式，掩码可以表示相同的信息。</span><span class="sxs-lookup"><span data-stu-id="35943-173">Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.</span></span>  
  
 <span data-ttu-id="35943-174">下表比较了每个四个正则表达式和等效的掩码。</span><span class="sxs-lookup"><span data-stu-id="35943-174">The following table compares four regular expressions and the equivalent mask for each.</span></span>  
  
|<span data-ttu-id="35943-175">正则表达式</span><span class="sxs-lookup"><span data-stu-id="35943-175">Regular Expression</span></span>|<span data-ttu-id="35943-176">掩码</span><span class="sxs-lookup"><span data-stu-id="35943-176">Mask</span></span>|<span data-ttu-id="35943-177">说明</span><span class="sxs-lookup"><span data-stu-id="35943-177">Notes</span></span>|  
|------------------------|----------|-----------|  
|`\d{2}/\d{2}/\d{4}`|`00/00/0000`|<span data-ttu-id="35943-178">`/`掩码中的字符是一个逻辑日期分隔符，和它将向用户显示为适合于应用程序的当前区域性的日期分隔符。</span><span class="sxs-lookup"><span data-stu-id="35943-178">The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.</span></span>|  
|`\d{2}-[A-Z][a-z]{2}-\d{4}`|`00->L<LL-0000`|<span data-ttu-id="35943-179">三个字母月份缩写的显示带有两个小写字母后跟一个初始大写字母的美国格式的日期 （日、 月份缩写和年）。</span><span class="sxs-lookup"><span data-stu-id="35943-179">A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.</span></span>|  
|`(\(\d{3}\)-)?\d{3}-d{4}`|`(999)-000-0000`|<span data-ttu-id="35943-180">美国境内电话号码，可选的区域代码。</span><span class="sxs-lookup"><span data-stu-id="35943-180">United States phone number, area code optional.</span></span> <span data-ttu-id="35943-181">如果用户不希望输入的可选字符，她可以输入空间，或将鼠标指针放在由第一个 0 表示掩码中的位置直接。</span><span class="sxs-lookup"><span data-stu-id="35943-181">If the user does not wish to enter the optional characters, she can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.</span></span>|  
|`$\d{6}.00`|`$999,999.00`|<span data-ttu-id="35943-182">0 到 999999 的范围中的货币值。</span><span class="sxs-lookup"><span data-stu-id="35943-182">A currency value in the range of 0 to 999999.</span></span> <span data-ttu-id="35943-183">货币、 千位和十进制字符将替换为在运行时它们特定于区域性的等效项。</span><span class="sxs-lookup"><span data-stu-id="35943-183">The currency, thousandth, and decimal characters will be replaced at run-time with their culture-specific equivalents.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="35943-184">另请参阅</span><span class="sxs-lookup"><span data-stu-id="35943-184">See Also</span></span>  
 <xref:System.Windows.Forms.MaskedTextBox.Mask%2A>  
 <xref:System.Windows.Forms.MaskedTextBox>  
 [<span data-ttu-id="35943-185">在 Visual Basic 中验证字符串</span><span class="sxs-lookup"><span data-stu-id="35943-185">Validating Strings in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md)  
 [<span data-ttu-id="35943-186">MaskedTextBox 控件</span><span class="sxs-lookup"><span data-stu-id="35943-186">MaskedTextBox Control</span></span>](../../../../framework/winforms/controls/maskedtextbox-control-windows-forms.md)
